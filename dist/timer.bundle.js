(()=>{"use strict";var e={409:(e,t,r)=>{r.d(t,{xN:()=>s,RL:()=>a,RK:()=>i});var n=r(594),o=r(771);function s(){var e=!1;null===i(n.Rd)&&(e=!0),null===i(n.oi)&&(e=!0),null===!localStorage.getItem(o.Do)&&(e=!0),null===!localStorage.getItem(o.mn)&&(e=!0),null===i(o.XB)&&(e=!0),e&&(a(n.Rd,{}),a(n.oi,0),a(o.mn,"complete"),a(o.Do,0),a(o.XB,{}))}function a(e,t){localStorage.setItem(e,JSON.stringify(t))}function i(e){return JSON.parse(localStorage.getItem(e))}},771:(e,t,r)=>{r.d(t,{Do:()=>l,mn:()=>c,XB:()=>d,rA:()=>u,Nt:()=>m,_c:()=>p,E3:()=>f,qc:()=>h,yJ:()=>v,RU:()=>y,hY:()=>k});var n=r(409),o=r(594);function s(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,s=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw s}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l="pomo_session_id",c="latest_pomo_session_status",d="pomo_session_map",u={INACTIVE:"inactive",BREAK:"break",LONG_BREAK:"longbreak",ACTIVE:"active",COMPLETE:"complete"},m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.allTasks=[],this.mode=u.INACTIVE,this.time=0,this.pomosElapsed=0,this.startDate=new Date}var t,r;return t=e,(r=[{key:"currentTask",value:function(){var e=this.allTasks.filter((function(e){return!e.completed}));return e.length>0?e[0]:null}},{key:"addTask",value:function(e){(0,o.rs)(e),this.allTasks.push(e)}},{key:"deleteTask",value:function(e){(0,o.c_)(e.id);for(var t=0;t<this.allTasks.length;t++){var r=this.allTasks[t];if(e.id===r.id)return void this.allTasks.splice(t,1)}}},{key:"completeTask",value:function(e){var t,r=s(this.allTasks);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.id===e)return n.completed=!0,!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"getNextTask",value:function(){var e,t=s(this.allTasks);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(!1===r.completed)return r}}catch(e){t.e(e)}finally{t.f()}return null}},{key:"incrementTaskPomosUsed",value:function(e){var t,r=s(this.allTasks);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.id===e)return n.pomosUsed+=1,void(this.pomosElapsed+=1)}}catch(e){r.e(e)}finally{r.f()}}},{key:"isBreak",value:function(){return this.mode===u.LONG_BREAK||this.mode===u.BREAK}},{key:"reorderTasks",value:function(){}},{key:"getPomosLeftInSession",value:function(){var e=0;return this.allTasks.forEach((function(t){e+=Math.max(t.pomosRequired-t.pomosUsed,0)})),e}},{key:"parseSessionFromObj",value:function(e){return this.id=e.id,this.mode=e.mode,this.time=e.time,this.pomosElapsed=e.pomosElapsed,this.startDate=new Date(e.startDate),this.allTasks=e.allTasks.map((function(e){var t=new o.iQ;return t.parseTaskFromObj(e)})),this}},{key:"serializeIntoObj",value:function(){return{id:this.id,allTasks:this.allTasks.map((function(e){return e.serializeIntoObj()})),mode:this.mode,time:this.time,pomosElapsed:this.pomosElapsed,startDate:this.startDate.getTime()}}}])&&i(t.prototype,r),e}();function p(e){var t=(0,n.RK)(d),r=new m;return t[e]?r.parseSessionFromObj(t[e]):null}function f(e){var t=(0,n.RK)(d);t[e.id]=e.serializeIntoObj(),(0,n.RL)(d,t)}function h(){var e=parseInt(localStorage.getItem(l));return localStorage.setItem(l,e+1),e}function v(e){localStorage.setItem(c,e)}function y(){return"complete"===localStorage.getItem(c)?null:parseInt(localStorage.getItem(l))-1}function k(){var e=y();if(null===e)return!1;var t=p(e);return null!==t&&t.mode!==u.COMPLETE&&t.mode!==u.INACTIVE}},594:(e,t,r)=>{r.d(t,{iQ:()=>a,Rd:()=>i,oi:()=>l,rs:()=>c,c_:()=>d,zT:()=>u});var n=r(409),o=r(771);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionID=t,this.id=-1,this.title=r,this.description=n,this.pomosRequired=o,this.completed=!1,this.pomosUsed=0}var t,r;return t=e,(r=[{key:"parseTaskFromObj",value:function(t){var r=new e(t.sessionID,t.title,t.description,t.pomosRequired);return r.completed=t.completed,r.id=t.id,r.pomosUsed=t.pomosUsed,r}},{key:"serializeIntoObj",value:function(){return{title:this.title,description:this.description,pomosRequired:this.pomosRequired,completed:this.completed,pomosUsed:this.pomosUsed,id:this.id,sessionID:this.sessionID}}}])&&s(t.prototype,r),e}(),i="pomo_task_map",l="pomo_task_index";function c(e){var t=(0,n.RK)(i);if(!t[e.id]){var r=parseInt((0,n.RK)(l));e.id=r,(0,n.RL)(l,r+1)}var o=e.serializeIntoObj();return t[e.id]=o,(0,n.RL)(i,t),e.id}function d(e){var t=(0,n.RK)(i);delete t[e],(0,n.RL)(i,t)}function u(){var e=(0,o.RU)();if(null===e)return!1;var t=(0,o._c)(e);return null!==t&&null!==t.currentTask()}}},t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{function e(e){var t,r=e%60;t=r<10?"0"+r:r;var n=Math.floor(e/60);return(n<10?"0"+n:n)+":"+t}var t=r(409),n=r(771),o=r(594),s="day",a="night";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=s;return e.getHours()<4?t=a:e.getHours()<18?t=s:e.getHours()<24&&(t=a),t}function l(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,i=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){i=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(i)throw s}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}window.addEventListener("DOMContentLoaded",(function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=0,r=6,n=e.getDay(),o=localStorage.getItem("bg-seed");null!==o&&o[0]==n||(o=n+"-"+Math.floor(Math.random()*r),localStorage.setItem("bg-seed",o));var s=i(e);t=parseInt(o[2]),document.getElementById("backdrop").style.backgroundImage='url("./assets/images/backgrounds/'.concat(s,"/bg").concat(t,'.jpg")')}();var r=new URLSearchParams(window.location.search),s=r.get("loadSaved"),a=document.getElementById("taskCreator"),c=document.getElementById("addTaskModal"),d=document.getElementById("taskList"),u=document.getElementById("startTimer"),m=document.getElementById("currentTask"),p=document.getElementById("taskList"),f=document.getElementById("timer-progress"),h=document.getElementById("distractedWrapper"),v=document.getElementById("completeSession"),y=document.getElementById("EndBreakEarlyWrapper");v.onclick=function(){g.mode=n.rA.COMPLETE,(0,n.E3)(g)};var k=1500;if((0,t.xN)(),"false"!=s||!(0,o.zT)()||confirm("By starting a new timer, you will lose any unfinished tasks from your previous session")){var g=null;if("true"==s){var T=(0,n.RU)();if(g=(0,n._c)(T),(0,n.hY)()&&g.mode!=n.rA.INACTIVE)O(),I();else{var E=(0,n.qc)();(0,n.yJ)("in-progress");var b=g.allTasks;b.forEach((function(e){e.sessionID=E,(0,o.rs)(e)})),(g=new n.Nt(E)).time=k,g.allTasks=b,(0,n.E3)(g),O()}}else if("false"==s){var A=(0,n.qc)();(0,n.yJ)("in-progress"),(g=new n.Nt(A)).time=k,(0,n.E3)(g),O()}r.set("loadSaved",!0),f.setDisplayText(e(g.time)),f.setPercentage(g.time/k),g.mode===n.rA.BREAK?(B(),f.setPercentage(g.time/300)):g.mode===n.rA.LONG_BREAK&&(B(),f.setPercentage(g.time/SVGFEColorMatrixElement)),y.onclick=function(){new Audio("assets/audio/breakAlarm.mp3").play(),w(),g.time=k,g.mode=n.rA.ACTIVE,f.setDisplayText(e(g.time)),f.setPercentage(g.time/k),(0,n.E3)(g)},u.onclick=I,c.shadowRoot.getElementById("save-btn").addEventListener("click",(function(){var e,t,r,s=c.elements.values;if(null!=s){var a=(0,n.RU)(),i=new o.iQ(a,s.taskName,s.description,parseInt(s.pomosRequired));R(i),g.addTask(i),(0,n.E3)(g),e=c.shadowRoot.getElementById("task-name").elements.wrapper,t=c.shadowRoot.getElementById("pomos-required").elements.wrapper,r=c.shadowRoot.getElementById("description").elements.wrapper,e.innerText=e.placeholder,e.userTyped=void 0,e.setAttribute("class","pomo-input placeholder"),t.innerText=t.placeholder,t.userTyped=void 0,t.setAttribute("class","pomo-input placeholder"),r.innerText=r.placeholder,r.userTyped=void 0,r.setAttribute("class","pomo-input placeholder"),c.elements.values=void 0}})),a.onclick=function(){c.displayModal()}}else window.location="./index.html";function I(){m.setAttribute("class","currentTaskWorkTime"),f.setSize("1.5rem"),d.setAttribute("class","taskListWorkTime"),document.getElementById("timerWrapper").setAttribute("class","timerWrapperWorkTime"),h.style.display="block",document.getElementById("completeSessionWrapper").setAttribute("class","completeSessionWrapperWorkTime"),document.getElementById("taskCreatorWrapper").style.display="none",document.getElementById("currentTaskWrapper").style.display="block",S(),g.mode===n.rA.INACTIVE&&(g.mode=n.rA.ACTIVE,(0,n.E3)(g)),setInterval((function(){if((g=(0,n._c)(g.id)).time-=1,g.time<0&&(g.time=0),0==g.time)if(g.mode===n.rA.ACTIVE){new Audio("assets/audio/workAlarm.mp3").play(),B(),g.pomosElapsed+=1;var t=m.childNodes[0];t.incrementPomosUsed(),t.task.pomosUsed+=1,g.incrementTaskPomosUsed(t.task.id),(0,n.E3)(g),t.setAttribute("pomosused",1+parseInt(t.getAttribute("pomosused"))),g.pomosElapsed%4==0?(g.time=600,g.mode=n.rA.LONG_BREAK):(g.time=300,g.mode=n.rA.BREAK)}else g.mode!==n.rA.COMPLETE&&(new Audio("assets/audio/breakAlarm.mp3").play(),w(),g.time=k,g.mode=n.rA.ACTIVE);document.title=e(g.time),f.setDisplayText(e(g.time)),g.mode===n.rA.ACTIVE?(f.setPercentage(g.time/k),document.title+=" - Work"):g.mode===n.rA.BREAK?(f.setPercentage(g.time/300),document.title+=" - Break"):g.mode===n.rA.LONG_BREAK&&(f.setPercentage(g.time/600),document.title+=" - Long Break"),(0,n.E3)(g)}),1e3);var t=m.childNodes[0];t.setFinishTaskCallback((function(){N(),S()}));var r=g.currentTask();t.task=r}function w(){document.getElementById("timer-status").innerText="Pomo Time",m.setAttribute("class","currentTaskWorkTime"),p.setAttribute("class","taskListWorkTime"),h.style.display="block",y.style.display="none",timerWrapper.setAttribute("class","timerWrapperWorkTime"),completeSessionWrapper.setAttribute("class","completeSessionWrapperWorkTime")}function B(){m.setAttribute("class","currentTaskBreakTime"),p.setAttribute("class","taskListBreakTime"),document.getElementById("timer-status").innerText="Break Time",y.style.display="block",h.style.display="none",timerWrapper.setAttribute("class","timerWrapperBreakTime"),completeSessionWrapper.setAttribute("class","completeSessionWrapperBreakTime")}function R(e){var t='<pomo-task description ="'.concat(e.description,'" pomosUsed="').concat(e.pomosUsed,'", pomosRequired ="').concat(e.pomosRequired,'">').concat(e.title,"</pomo-task>");d.insertAdjacentHTML("beforeend",t);var r=d.childNodes[d.childNodes.length-1];r.setFinishTaskCallback((function(){N()})),r.setDeleteTaskCallback((function(){C(e.id)})),r.task=e}function S(){p.childNodes[0];var e=g.getNextTask();if(null===e)return g.mode=n.rA.COMPLETE,(0,n.E3)(g),void(window.location="./history.html");var t='<pomo-task description="'.concat(e.description,'" pomosUsed="').concat(e.pomosUsed,'" pomosRequired=').concat(e.pomosRequired,">").concat(e.title,"</pomo-task>");m.insertAdjacentHTML("beforeend",t),p.removeChild(p.childNodes[0]);var r=m.childNodes[m.childNodes.length-1];r.setFinishTaskCallback((function(){N(),S()})),r.setDeleteTaskCallback((function(){C(e.id)})),r.task=e}function N(){var e,t=[],r=l(m.childNodes);try{var o=function(){var r=e.value;r.completed&&(t.push(r.task.id),r.hide(),setTimeout((function(){m.removeChild(r)}),200))};for(r.s();!(e=r.n()).done;)o()}catch(e){r.e(e)}finally{r.f()}var s,a=l(p.childNodes);try{var i=function(){var e=s.value;e.completed&&(t.push(e.task.id),e.hide(),setTimeout((function(){p.removeChild(e)}),200))};for(a.s();!(s=a.n()).done;)i()}catch(e){a.e(e)}finally{a.f()}t.forEach((function(e){g.completeTask(e)})),(0,n.E3)(g)}function C(e){var t=m.childNodes;if(t.length){var r=t[t.length-1].task;if(r.id===e&&confirm("Are you sure you want to delete this task?"))return g.deleteTask(r),m.removeChild(m.childNodes[t.length-1]),S(),void(0,n.E3)(g)}if(p.childNodes.length){var o,s=0,a=l(p.childNodes);try{for(a.s();!(o=a.n()).done;){var i=o.value.task;if(i.id===e&&confirm("Are you sure you want to delete this task?"))return g.deleteTask(i),p.removeChild(p.childNodes[s]),void(0,n.E3)(g);s++}}catch(e){a.e(e)}finally{a.f()}}}function O(){var e=(0,n.RU)(),t=[];if(null!==e){var r=g.allTasks;Object.values(r).forEach((function(r){console.log(r),r.sessionID!==e||r.completed||t.push(r)})),t.forEach((function(e){R(e)}))}var o,s=l(p.childNodes);try{for(s.s();!(o=s.n()).done;)o.value.setFinishTaskCallback((function(){N()}))}catch(e){s.e(e)}finally{s.f()}}}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jc2UxMTAtdzIxLWdyb3VwMjEvLi9zb3VyY2UvYXNzZXRzL3NjcmlwdHMvZGF0YWJhc2UvaW5kZXguanMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxLy4vc291cmNlL2Fzc2V0cy9zY3JpcHRzL2RhdGFiYXNlL3Nlc3Npb24uanMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxLy4vc291cmNlL2Fzc2V0cy9zY3JpcHRzL2RhdGFiYXNlL3Rhc2suanMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2NzZTExMC13MjEtZ3JvdXAyMS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxLy4vc291cmNlL2Fzc2V0cy9zY3JpcHRzL3V0aWxzL2Zvcm1hdC10aW1lLmpzIiwid2VicGFjazovL2NzZTExMC13MjEtZ3JvdXAyMS8uL3NvdXJjZS9hc3NldHMvc2NyaXB0cy91dGlscy90aGVtZS5qcyIsIndlYnBhY2s6Ly9jc2UxMTAtdzIxLWdyb3VwMjEvLi9zb3VyY2UvYXNzZXRzL3NjcmlwdHMvdGltZXIuanMiXSwibmFtZXMiOlsiaW5pdGlhbGl6ZURhdGFiYXNlIiwibmVlZFRvSW5pdGlhbGl6ZSIsImdldE9iamVjdCIsIlBPTU9fVEFTS19NQVAiLCJQT01PX1RBU0tfSU5ERVgiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiUE9NT19TRVNTSU9OX0lEIiwiTEFURVNUX1BPTU9fU0VTU0lPTl9TVEFUVVMiLCJQT01PX1NFU1NJT05fTUFQIiwic3RvcmVPYmplY3QiLCJrZXkiLCJvYmplY3QiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsInBhcnNlIiwiUE9NT19TRVNTSU9OX01PREVTIiwiSU5BQ1RJVkUiLCJCUkVBSyIsIkxPTkdfQlJFQUsiLCJBQ1RJVkUiLCJDT01QTEVURSIsIlBvbW9TZXNzaW9uIiwiaWQiLCJ0aGlzIiwiYWxsVGFza3MiLCJtb2RlIiwidGltZSIsInBvbW9zRWxhcHNlZCIsInN0YXJ0RGF0ZSIsIkRhdGUiLCJhbGxJblByb2dyZXNzVGFza3MiLCJmaWx0ZXIiLCJ0YXNrIiwiY29tcGxldGVkIiwibGVuZ3RoIiwic3RvcmVUYXNrIiwicHVzaCIsImRlbGV0ZVRhc2tCeVRhc2tJRCIsImkiLCJzdG9yZWRUYXNrIiwic3BsaWNlIiwicG9tb3NVc2VkIiwibGVmdCIsImZvckVhY2giLCJNYXRoIiwibWF4IiwicG9tb3NSZXF1aXJlZCIsInNlc3Npb25fb2JqIiwibWFwIiwidGFza09iaiIsInQiLCJUYXNrIiwicGFyc2VUYXNrRnJvbU9iaiIsInNlcmlhbGl6ZUludG9PYmoiLCJnZXRUaW1lIiwiZ2V0UG9tb1Nlc3Npb24iLCJhbGxTZXNzaW9ucyIsInAiLCJwYXJzZVNlc3Npb25Gcm9tT2JqIiwic3RvcmVQb21vU2Vzc2lvbiIsInNlc3Npb24iLCJnZXROZXdTZXNzaW9uSUQiLCJwcmV2SUQiLCJwYXJzZUludCIsInNldEN1cnJlbnRTZXNzaW9uU3RhdHVzIiwic3RhdHVzIiwiZ2V0TGF0ZXN0U2Vzc2lvbklEIiwidGhlcmVJc1VuZmluaXNoZWRTZXNzaW9uIiwic2Vzc2lvbklEIiwiY3VycmVudFBvbW9TZXNzaW9uIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInRhc2tfb2JqIiwidGFza19tYXAiLCJvYmoiLCJhcmVUaGVyZVVuZmluaXNoZWRUYXNrc0Zyb21MYXN0U2Vzc2lvbiIsIm9sZFNlc3Npb25JRCIsImN1cnJlbnRUYXNrIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkIiwiZGVmaW5pdGlvbiIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiZm9ybWF0VGltZSIsInNlY29uZHMiLCJzc3RyIiwicyIsIm0iLCJmbG9vciIsIlRIRU1FX01PREVTIiwiZ2V0VGhlbWVNb2RlIiwidG9kYXkiLCJ0aW1lUGVyaW9kIiwiZ2V0SG91cnMiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwibnVtQkdzIiwiZ2V0RGF5Iiwic2VlZCIsInJhbmRvbSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsInNlbGVjdEFuZFNldFRoZW1lIiwidXJsUGFyYW1zIiwiVVJMU2VhcmNoUGFyYW1zIiwibG9jYXRpb24iLCJzZWFyY2giLCJsb2FkU2F2ZWQiLCJhZGRUYXNrQnV0dG9uIiwibW9kYWwiLCJ0YXNrTGlzdCIsInN0YXJ0VGltZXJCdXR0b24iLCJjdXJyZW50VGFza0hUTUwiLCJ0YXNrTGlzdEhUTUwiLCJ0aW1lclByb2dyZXNzQ2lyY2xlIiwiZGlzdHJhY3RlZEJ1dHRvbiIsImNvbXBsZXRlU2Vzc2lvbkJ1dHRvbiIsIkVuZEJyZWFrRWFybHlCdXR0b24iLCJvbmNsaWNrIiwibWF4UG9tb1RpbWUiLCJjb25maXJtIiwibG9hZFRhc2tzIiwiaW5pdGlhdGVUaW1lciIsIm9sZFRhc2tzIiwic2V0Iiwic2V0RGlzcGxheVRleHQiLCJzZXRQZXJjZW50YWdlIiwicmVuZGVyQnJlYWtNb2RlIiwiU1ZHRkVDb2xvck1hdHJpeEVsZW1lbnQiLCJBdWRpbyIsInBsYXkiLCJyZW5kZXJBY3RpdmVNb2RlIiwic2hhZG93Um9vdCIsInRhc2tOYW1lIiwidGFza1ZhbHVlcyIsImVsZW1lbnRzIiwidmFsdWVzIiwidW5kZWZpbmVkIiwibmV3VGFzayIsInJlbmRlclRhc2tJbnRvVGFza0xpc3QiLCJhZGRUYXNrIiwid3JhcHBlciIsImlubmVyVGV4dCIsInBsYWNlaG9sZGVyIiwidXNlclR5cGVkIiwic2V0QXR0cmlidXRlIiwiZGlzcGxheU1vZGFsIiwic2V0U2l6ZSIsImRpc3BsYXkiLCJzdGFydE5ld1Rhc2siLCJzZXRJbnRlcnZhbCIsImN1cnJlbnRUYXNrRmlyc3RDaGlsZCIsImNoaWxkTm9kZXMiLCJpbmNyZW1lbnRQb21vc1VzZWQiLCJpbmNyZW1lbnRUYXNrUG9tb3NVc2VkIiwiZ2V0QXR0cmlidXRlIiwic2V0RmluaXNoVGFza0NhbGxiYWNrIiwicmVtb3ZlQ29tcGxldGVkVGFza3MiLCJ0aW1lcldyYXBwZXIiLCJjb21wbGV0ZVNlc3Npb25XcmFwcGVyIiwiY3VycmVudFRhc2tFbGVtZW50IiwiaW5zZXJ0QWRqYWNlbnRIVE1MIiwiZWxlbWVudCIsInNldERlbGV0ZVRhc2tDYWxsYmFjayIsImRlbGV0ZVRhc2tCeUlkIiwibmV4dFRhc2siLCJnZXROZXh0VGFzayIsImN1cnJlbnRUYXNrVG9CZUFkZGVkIiwicmVtb3ZlQ2hpbGQiLCJjb21wbGV0ZWRJZHMiLCJub2RlIiwiaGlkZSIsInNldFRpbWVvdXQiLCJjb21wbGV0ZVRhc2siLCJjdXJyZW50VGFza0VsZW1lbnRMaXN0IiwiZGVsZXRlVGFzayIsInRhc2tzIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6ImtHQUdPLFNBQVNBLElBRVosSUFBSUMsR0FBbUIsRUFDVSxPQUE3QkMsRUFBVUMsUUFDVkYsR0FBbUIsR0FFWSxPQUEvQkMsRUFBVUUsUUFDVkgsR0FBbUIsR0FFd0IsUUFBMUNJLGFBQWFDLFFBQVFDLFFBQ3RCTixHQUFtQixHQUVtQyxRQUFyREksYUFBYUMsUUFBUUUsUUFDdEJQLEdBQW1CLEdBRWEsT0FBaENDLEVBQVVPLFFBQ1ZSLEdBQW1CLEdBSW5CQSxJQUNBUyxFQUFZUCxLQUFlLElBQzNCTyxFQUFZTixLQUFpQixHQUM3Qk0sRUFBWUYsS0FBNEIsWUFDeENFLEVBQVlILEtBQWlCLEdBQzdCRyxFQUFZRCxLQUFrQixLQVcvQixTQUFTQyxFQUFZQyxFQUFLQyxH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QyxJQURnQyxFQUM1QkksRUFBSSxFQUR3QixJQUVieUYsRUFBYXVDLFlBRkEsSUFFaEMsMkJBQTRDLEtBQ3BDdEksRUFEb0MsUUFDeEJBLEtBQ2hCLEdBQUlBLEVBQUtWLEtBQU9BLEdBQ1JnSCxRQUFRLDhDQUlSLE9BSEFqRSxFQUFtQndILFdBQVc3SixHQUM5QitGLEVBQWF1RCxZQUFZdkQsRUFBYXVDLFdBQVdoSSxTQUNqRHFCLFFBQWlCVSxHQUl6Qi9CLEtBWjRCLGdDQXFCeEMsU0FBU2lHLElBQ0wsSUFBSWpILEdBQUs0QyxVQUNMMUMsRUFBVyxHQUNmLEdBQVcsT0FBUEYsRUFBYSxDQUNiLElBQUl3SyxFQUFRekgsRUFBbUI3QyxTQUMvQitELE9BQU8rRCxPQUFPd0MsR0FBT25KLFNBQVEsU0FBQ1gsR0FDMUIrSixRQUFRQyxJQUFJaEssR0FDUkEsRUFBS29DLFlBQWM5QyxHQUFPVSxFQUFLQyxXQUMvQlQsRUFBU1ksS0FBS0osTUFHdEJSLEVBQVNtQixTQUFRLFNBQUNYLEdBQ2R5SCxFQUF1QnpILE1BWmQsVUFlQStGLEVBQWF1QyxZQWZiLElBZWpCLDJCQUEwQyxRQUNqQ0ksdUJBQXNCLFdBQ3ZCQyxPQWpCUyxvQyIsImZpbGUiOiJ0aW1lci5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQT01PX1RBU0tfSU5ERVgsIFBPTU9fVEFTS19NQVAgfSBmcm9tIFwiLi90YXNrXCI7XG5pbXBvcnQgeyBQT01PX1NFU1NJT05fSUQsIExBVEVTVF9QT01PX1NFU1NJT05fU1RBVFVTLCBQT01PX1NFU1NJT05fTUFQIH0gZnJvbSBcIi4vc2Vzc2lvblwiO1xuXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZURhdGFiYXNlKCkge1xuICAgIC8vIGNoZWNrIGlmIHdlIG5lZWQgdG8gaW5pdGlhbGl6ZVxuICAgIGxldCBuZWVkVG9Jbml0aWFsaXplID0gZmFsc2U7XG4gICAgaWYgKGdldE9iamVjdChQT01PX1RBU0tfTUFQKSA9PT0gbnVsbCkge1xuICAgICAgICBuZWVkVG9Jbml0aWFsaXplID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGdldE9iamVjdChQT01PX1RBU0tfSU5ERVgpID09PSBudWxsKSB7XG4gICAgICAgIG5lZWRUb0luaXRpYWxpemUgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoIWxvY2FsU3RvcmFnZS5nZXRJdGVtKFBPTU9fU0VTU0lPTl9JRCkgPT09IG51bGwpIHtcbiAgICAgICAgbmVlZFRvSW5pdGlhbGl6ZSA9IHRydWU7XG4gICAgfVxuICAgIGlmICghbG9jYWxTdG9yYWdlLmdldEl0ZW0oTEFURVNUX1BPTU9fU0VTU0lPTl9TVEFUVVMpID09PSBudWxsKSB7XG4gICAgICAgIG5lZWRUb0luaXRpYWxpemUgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoZ2V0T2JqZWN0KFBPTU9fU0VTU0lPTl9NQVApID09PSBudWxsKSB7XG4gICAgICAgIG5lZWRUb0luaXRpYWxpemUgPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIHRoZW4gaW5pdGlhbGl6ZVxuICAgIGlmIChuZWVkVG9Jbml0aWFsaXplKSB7XG4gICAgICAgIHN0b3JlT2JqZWN0KFBPTU9fVEFTS19NQVAsIHt9KTtcbiAgICAgICAgc3RvcmVPYmplY3QoUE9NT19UQVNLX0lOREVYLCAwKTtcbiAgICAgICAgc3RvcmVPYmplY3QoTEFURVNUX1BPTU9fU0VTU0lPTl9TVEFUVVMsIFwiY29tcGxldGVcIik7XG4gICAgICAgIHN0b3JlT2JqZWN0KFBPTU9fU0VTU0lPTl9JRCwgMCk7XG4gICAgICAgIHN0b3JlT2JqZWN0KFBPTU9fU0VTU0lPTl9NQVAsIHt9KTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gcmVzZXREYXRhYmFzZSgpIHtcbiAgICBkZWxldGUgbG9jYWxTdG9yYWdlW1BPTU9fVEFTS19NQVBdO1xuICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2VbUE9NT19UQVNLX0lOREVYXTtcbiAgICBkZWxldGUgbG9jYWxTdG9yYWdlW0xBVEVTVF9QT01PX1NFU1NJT05fU1RBVFVTXTtcbiAgICBkZWxldGUgbG9jYWxTdG9yYWdlW1BPTU9fU0VTU0lPTl9JRF07XG4gICAgZGVsZXRlIGxvY2FsU3RvcmFnZVtQT01PX1NFU1NJT05fTUFQXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0b3JlT2JqZWN0KGtleSwgb2JqZWN0KSB7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeShvYmplY3QpKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRPYmplY3Qoa2V5KSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSk7XG59IiwiLyoqXG4gKiBUaGlzIGZpbGUgaXMgcmVsYXRlZCB0byBmaW5kaW5nIHBvbW8gc2Vzc2lvbnNcbiAqL1xuaW1wb3J0IHsgZ2V0T2JqZWN0LCBzdG9yZU9iamVjdCB9IGZyb20gXCIuL2luZGV4XCI7XG5pbXBvcnQgeyBkZWxldGVUYXNrQnlUYXNrSUQsIHN0b3JlVGFzaywgVGFzayB9IGZyb20gXCIuL3Rhc2tcIjtcblxuXG5leHBvcnQgY29uc3QgUE9NT19TRVNTSU9OX0lEID0gXCJwb21vX3Nlc3Npb25faWRcIjtcbmV4cG9ydCBjb25zdCBMQVRFU1RfUE9NT19TRVNTSU9OX1NUQVRVUyA9IFwibGF0ZXN0X3BvbW9fc2Vzc2lvbl9zdGF0dXNcIjtcbmV4cG9ydCBjb25zdCBQT01PX1NFU1NJT05fTUFQID0gXCJwb21vX3Nlc3Npb25fbWFwXCI7XG5cbi8qKiB0aGUgZGlmZmVyZW50IHBvbW8gc2Vzc2lvbiBtb2RlcyBhcyBjb25zdGFudHMgKi9cbmV4cG9ydCBjb25zdCBQT01PX1NFU1NJT05fTU9ERVMgPSB7XG4gIC8qKiB3aGVuIHRoZSB1c2VyIGlzIGluIHRoZSBpbnRlcmZhY2Ugb2YgY3JlYXRpbmcgYSBuZXcgdGltZXIgYW5kIGhhcyBub3Qgc3RhcnRlZCB0aGVpciBuZXcgc2Vzc2lvbiB5ZXQgKi9cbiAgSU5BQ1RJVkU6IFwiaW5hY3RpdmVcIixcbiAgLyoqIHdoZW4gcnVubmluZyB0aGUgYnJlYWsgdGltZXIgKi9cbiAgQlJFQUs6IFwiYnJlYWtcIixcbiAgLyoqIHdoZW4gcnVubmluZyB0aGUgbG9uZ2VyIGJyZWFrIHRpbWVyICovXG4gIExPTkdfQlJFQUs6IFwibG9uZ2JyZWFrXCIsXG4gIC8qKiB3aGVuIHJ1bm5pbmcgdGhlIGFjdGl2ZSBwb21vIHdvcmsgdGltZSAqL1xuICBBQ1RJVkU6IFwiYWN0aXZlXCIsXG4gIC8qKiB3aGVuIHRoZSB1c2VyIG1hcmtzIHRoaXMgcG9tbyBzZXNzaW9uIGFzIGNvbXBsZXRlLCByZWdhcmRsZXNzIG9mIHdoZXRoZXIgdGFza3MgYXJlIGNvbXBsZXRlZCBvciBub3QgKi9cbiAgQ09NUExFVEU6IFwiY29tcGxldGVcIixcbn07XG5cbmV4cG9ydCBjbGFzcyBQb21vU2Vzc2lvbiB7XG4gIC8qKlxuICAgKiBDcmVhdGUgYSBuZXcgUG9tbyBTZXNzaW9uIG9iamVjdFxuICAgKiBAcGFyYW0ge251bWJlcn0gaWQgLSBpZCBvZiB0aGlzIHNlc3Npb25cbiAgICovXG4gIGNvbnN0cnVjdG9yKGlkKSB7XG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIC8qKiBAdHlwZSB7VGFza1tdfSAtIGEgbGlzdCBvZiBhbGwgdGFza3MgYXNzb2NpYXRlZCB3aXRoIHRoaXMgc2Vzc2lvbiAqL1xuICAgIHRoaXMuYWxsVGFza3MgPSBbXTtcbiAgICAvKiogQHR5cGUge3N0cmluZ30gLSB0aGUgY3VycmVudCBtb2RlIG9mIHRoZSBwb21vIHNlc3Npb24gKi9cbiAgICB0aGlzLm1vZGUgPSBQT01PX1NFU1NJT05fTU9ERVMuSU5BQ1RJVkU7XG4gICAgLyoqIEB0eXBlIHtOdW1iZXJ9IC0gdGhlIGN1cnJlbnQgdGltZSBvZiB0aGUgcG9tbyBzZXNzaW9uICovXG4gICAgdGhpcy50aW1lID0gMDtcblxuICAgIC8qKiBAdHlwZSB7TnVtYmVyfSAtIG51bWJlciBvZiBwb21vcyBlbGFwc2VkIHN1Y2Nlc2Z1bGx5IGZvciB0aGlzIHBvbW8gc2Vzc2lvbiAqL1xuICAgIHRoaXMucG9tb3NFbGFwc2VkID0gMDtcblxuICAgIHRoaXMuc3RhcnREYXRlID0gbmV3IERhdGUoKTtcbiAgfVxuICAvKipcbiAgICogXG4gICAqIEByZXR1cm5zIHtUYXNrIHwgbnVsbCB9IC0gdGhlIGN1cnJlbnQgdGFzayBmb3IgdGhpcyBwb21vIHNlc3Npb24gb3IgbnVsbCBpZiB0aGVyZSBhcmUgbm8gdGFza3MgbGVmdFxuICAgKi9cbiAgY3VycmVudFRhc2soKSB7XG4gICAgbGV0IGFsbEluUHJvZ3Jlc3NUYXNrcyA9IHRoaXMuYWxsVGFza3MuZmlsdGVyKCh0YXNrKSA9PiAhdGFzay5jb21wbGV0ZWQpO1xuICAgIGlmIChhbGxJblByb2dyZXNzVGFza3MubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gYWxsSW5Qcm9ncmVzc1Rhc2tzWzBdO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICAvKipcbiAgICogQWRkcyBhIG5ldyB0YXNrXG4gICAqIEBwYXJhbSB7VGFza30gdGFzayBcbiAgICovXG4gIGFkZFRhc2sodGFzaykge1xuICAgIHN0b3JlVGFzayh0YXNrKTtcbiAgICB0aGlzLmFsbFRhc2tzLnB1c2godGFzayk7XG4gIH1cbiAgLyoqXG4gICAqIERlbGV0ZSBhIHRhc2tcbiAgICogQHBhcmFtIHtUYXNrfSB0YXNrIFxuICAgKi9cbiAgZGVsZXRlVGFzayh0YXNrKSB7XG4gICAgZGVsZXRlVGFza0J5VGFza0lEKHRhc2suaWQpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5hbGxUYXNrcy5sZW5ndGg7IGkrKyl7XG4gICAgICBjb25zdCBzdG9yZWRUYXNrID0gdGhpcy5hbGxUYXNrc1tpXTtcbiAgICAgIGlmICh0YXNrLmlkID09PSBzdG9yZWRUYXNrLmlkKSB7XG4gICAgICAgIHRoaXMuYWxsVGFza3Muc3BsaWNlKGksIDEpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENvbXBsZXRlcyB0aGUgZ2l2ZW4gdGFzayBhc3NvY2lhdGVkIHRvIHRoZSBpZFxuICAgKiBAcGFyYW0ge251bWJlcn0gaWQgXG4gICAqIEByZXR1cm5zIHtib29sZWFufSB0cnVlIGlmIGNvbXBsZXRlZCwgZmFsc2UgaWYgbm8gdGFzayBmb3VuZFxuICAgKi9cbiAgY29tcGxldGVUYXNrKGlkKSB7XG4gICAgZm9yIChsZXQgdGFzayBvZiB0aGlzLmFsbFRhc2tzKSB7XG4gICAgICBpZiAodGFzay5pZCA9PT0gaWQpIHtcbiAgICAgICAgdGFzay5jb21wbGV0ZWQgPSB0cnVlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBuZXh0IGluY29tcGxldGUgdGFzayBpbiB0aGUgb3JkZXIgb3IgbnVsbCBpZiBhbGwgY29tcGxldGVkXG4gICAqIEByZXR1cm5zIHtUYXNrIHwgbnVsbH1cbiAgICovXG4gIGdldE5leHRUYXNrKCkge1xuICAgIGZvciAoY29uc3QgdGFzayBvZiB0aGlzLmFsbFRhc2tzKSB7XG4gICAgICBpZiAodGFzay5jb21wbGV0ZWQgPT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybiB0YXNrO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICAvKipcbiAgICogSW5jcmVtZW50IHRoZSBwb21vcyB1c2VkIGZvciBhIHRhc2sgYW5kIGluY3JlbWVudCBwb21vc0VsYXBzZWRcbiAgICogQHBhcmFtIHtudW1iZXJ9IGlkIFxuICAgKi9cbiAgaW5jcmVtZW50VGFza1BvbW9zVXNlZChpZCkge1xuICAgIGZvciAoY29uc3QgdGFzayBvZiB0aGlzLmFsbFRhc2tzKSB7XG4gICAgICBpZiAodGFzay5pZCA9PT0gaWQpIHtcbiAgICAgICAgdGFzay5wb21vc1VzZWQgKz0gMTtcbiAgICAgICAgdGhpcy5wb21vc0VsYXBzZWQgKz0gMTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBcbiAgICogQHJldHVybnMgdHJ1ZSBpZiBzZXNzaW9uIGlzIGluIGJyZWFrIG1vZGUgcmlnaHQgbm93LCBmYWxzZSBvdGhlcndpc2VcbiAgICovXG4gIGlzQnJlYWsoKSB7XG4gICAgcmV0dXJuIHRoaXMubW9kZSA9PT0gUE9NT19TRVNTSU9OX01PREVTLkxPTkdfQlJFQUsgfHwgdGhpcy5tb2RlID09PSBQT01PX1NFU1NJT05fTU9ERVMuQlJFQUs7XG4gIH1cblxuICAvKipcbiAgICogVE9ET1xuICAgKi9cbiAgcmVvcmRlclRhc2tzKCkge1xuXG4gIH1cblxuICBnZXRQb21vc0xlZnRJblNlc3Npb24oKSB7XG4gICAgbGV0IGxlZnQgPSAwO1xuICAgIHRoaXMuYWxsVGFza3MuZm9yRWFjaCgodGFzaykgPT4ge1xuICAgICAgbGVmdCArPSBNYXRoLm1heCh0YXNrLnBvbW9zUmVxdWlyZWQgLSB0YXNrLnBvbW9zVXNlZCwgMCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGxlZnQ7XG4gIH1cbiAgcGFyc2VTZXNzaW9uRnJvbU9iaihzZXNzaW9uX29iaikge1xuICAgIHRoaXMuaWQgPSBzZXNzaW9uX29iai5pZDtcbiAgICB0aGlzLm1vZGUgPSBzZXNzaW9uX29iai5tb2RlO1xuICAgIHRoaXMudGltZSA9IHNlc3Npb25fb2JqLnRpbWU7XG4gICAgdGhpcy5wb21vc0VsYXBzZWQgPSBzZXNzaW9uX29iai5wb21vc0VsYXBzZWQ7XG4gICAgdGhpcy5zdGFydERhdGUgPSBuZXcgRGF0ZShzZXNzaW9uX29iai5zdGFydERhdGUpO1xuICAgIHRoaXMuYWxsVGFza3MgPSBzZXNzaW9uX29iai5hbGxUYXNrcy5tYXAoKHRhc2tPYmopID0+IHtcbiAgICAgIGxldCB0ID0gbmV3IFRhc2soKTtcbiAgICAgIHQgPSB0LnBhcnNlVGFza0Zyb21PYmoodGFza09iaik7XG4gICAgICByZXR1cm4gdDtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBzZXJpYWxpemVJbnRvT2JqKCkge1xuICAgIHJldHVybiB7XG4gICAgICBpZDogdGhpcy5pZCwgYWxsVGFza3M6IHRoaXMuYWxsVGFza3MubWFwKCh0YXNrKSA9PiB0YXNrLnNlcmlhbGl6ZUludG9PYmooKSksIG1vZGU6IHRoaXMubW9kZSwgdGltZTogdGhpcy50aW1lLCBwb21vc0VsYXBzZWQ6IHRoaXMucG9tb3NFbGFwc2VkLCBzdGFydERhdGU6IHRoaXMuc3RhcnREYXRlLmdldFRpbWUoKVxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgYSBwb21vIHNlc3Npb24gb2JqZWN0XG4gKiBAcGFyYW0ge251bWJlcn0gaWQgXG4gKiBAcmV0dXJucyB7UG9tb1Nlc3Npb24gfCBudWxsfSB0aGUgc2Vzc2lvbiBmb3IgdGhpcyBpZCBvciBudWxsIGlmIHRoZXJlIGlzIG5vIHNlc3Npb24gYXNzb2NpYXRlZCB3aXRoIHRoaXMgaWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFBvbW9TZXNzaW9uKGlkKSB7XG4gIGNvbnN0IGFsbFNlc3Npb25zID0gZ2V0T2JqZWN0KFBPTU9fU0VTU0lPTl9NQVApO1xuICBsZXQgcCA9IG5ldyBQb21vU2Vzc2lvbigpO1xuICBpZiAoIWFsbFNlc3Npb25zW2lkXSkgcmV0dXJuIG51bGw7XG4gIHJldHVybiBwLnBhcnNlU2Vzc2lvbkZyb21PYmooYWxsU2Vzc2lvbnNbaWRdKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0b3JlUG9tb1Nlc3Npb24oc2Vzc2lvbikge1xuICBjb25zdCBhbGxTZXNzaW9ucyA9IGdldE9iamVjdChQT01PX1NFU1NJT05fTUFQKTtcbiAgYWxsU2Vzc2lvbnNbc2Vzc2lvbi5pZF0gPSBzZXNzaW9uLnNlcmlhbGl6ZUludG9PYmooKTtcbiAgc3RvcmVPYmplY3QoUE9NT19TRVNTSU9OX01BUCwgYWxsU2Vzc2lvbnMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmV3U2Vzc2lvbklEKCkge1xuICBsZXQgcHJldklEID0gcGFyc2VJbnQobG9jYWxTdG9yYWdlLmdldEl0ZW0oUE9NT19TRVNTSU9OX0lEKSk7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFBPTU9fU0VTU0lPTl9JRCwgcHJldklEICsgMSk7XG4gIHJldHVybiBwcmV2SUQ7XG59XG5cbi8qKlxuICogU2V0IHRoZSBjdXJyZW50IHNlc3Npb24ncyBzdGF0dXNcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGF0dXMgLSBjYW4gYmUgXCJjb21wbGV0ZVwiIG9yIFwiaW4tcHJvZ3Jlc3NcIlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0Q3VycmVudFNlc3Npb25TdGF0dXMoc3RhdHVzKSB7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKExBVEVTVF9QT01PX1NFU1NJT05fU1RBVFVTLCBzdGF0dXMpO1xufVxuXG4vKipcbiAqIFdpbGwgcmV0dXJuIHRoZSBzZXNzaW9uIElEIG9mIHRoZSBsYXN0IHNlc3Npb24gaWYgaXQgd2FzIG5vdCBlbmRlZC4gT3RoZXJ3aXNlIGlmIHRoZSBsYXN0IHNlc3Npb24gZG9lcyBub3QgZXhpc3QgXG4gKiBvciB3YXMgZW5kZWQgYWxyZWFkeSwgdGhpcyBmdW5jdGlvbiByZXR1cm5zIG51bGxcbiAqIFxuICogQHJldHVybnMge251bWJlciB8IG51bGx9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRMYXRlc3RTZXNzaW9uSUQoKSB7XG4gIGxldCBzdGF0dXMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShMQVRFU1RfUE9NT19TRVNTSU9OX1NUQVRVUyk7XG4gIGlmIChzdGF0dXMgPT09IFwiY29tcGxldGVcIikge1xuICAgIHJldHVybiBudWxsO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBwYXJzZUludChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShQT01PX1NFU1NJT05fSUQpKSAtIDE7XG4gIH1cbn1cblxuLyoqXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSB0cnVlIGlmIHRoZXJlIGlzIGEgdW5maW5pc2hlZCBzZXNzaW9uIHRoYXQgd2FzIG5vdCBjb21wbGV0ZWQgb3IgcXVpdHRlZC4gZmFsc2Ugb3RoZXJ3aXNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0aGVyZUlzVW5maW5pc2hlZFNlc3Npb24oKSB7XG4gIGxldCBzZXNzaW9uSUQgPSBnZXRMYXRlc3RTZXNzaW9uSUQoKTtcbiAgaWYgKHNlc3Npb25JRCA9PT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICBsZXQgY3VycmVudFBvbW9TZXNzaW9uID0gZ2V0UG9tb1Nlc3Npb24oc2Vzc2lvbklEKTtcbiAgaWYgKGN1cnJlbnRQb21vU2Vzc2lvbiAhPT0gbnVsbCAmJiBjdXJyZW50UG9tb1Nlc3Npb24ubW9kZSAhPT0gUE9NT19TRVNTSU9OX01PREVTLkNPTVBMRVRFICYmIGN1cnJlbnRQb21vU2Vzc2lvbi5tb2RlICE9PSBQT01PX1NFU1NJT05fTU9ERVMuSU5BQ1RJVkUpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb250aW51ZUFjdGl2ZVNlc3Npb24oKSB7XG4gIGlmICh0aGVyZUlzVW5maW5pc2hlZFNlc3Npb24oKSkge1xuICAgIHdpbmRvdy5sb2NhdGlvbiA9IFwiL3RpbWVyLmh0bWw/bG9hZFNhdmVkPXRydWVcIjtcbiAgfVxufSIsImltcG9ydCB7IGdldE9iamVjdCwgc3RvcmVPYmplY3QgfSBmcm9tIFwiLlwiO1xuaW1wb3J0IHsgZ2V0TGF0ZXN0U2Vzc2lvbklELCBnZXRQb21vU2Vzc2lvbiB9IGZyb20gXCIuL3Nlc3Npb25cIjtcblxuZXhwb3J0IGNsYXNzIFRhc2sge1xuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzZXNzaW9uSUQgXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRpdGxlIFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkZXNjcmlwdGlvbiBcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcG9tb3NSZXF1aXJlZCBcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzZXNzaW9uSUQsIHRpdGxlLCBkZXNjcmlwdGlvbiwgcG9tb3NSZXF1aXJlZCkge1xuICAgICAgICB0aGlzLnNlc3Npb25JRCA9IHNlc3Npb25JRDtcbiAgICAgICAgdGhpcy5pZCA9IC0xO1xuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgdGhpcy5wb21vc1JlcXVpcmVkID0gcG9tb3NSZXF1aXJlZDtcbiAgICAgICAgdGhpcy5jb21wbGV0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wb21vc1VzZWQgPSAwO1xuICAgIH1cbiAgICBwYXJzZVRhc2tGcm9tT2JqKHRhc2tfb2JqKSB7XG4gICAgICAgIGxldCB0YXNrID0gbmV3IFRhc2sodGFza19vYmouc2Vzc2lvbklELCB0YXNrX29iai50aXRsZSwgdGFza19vYmouZGVzY3JpcHRpb24sIHRhc2tfb2JqLnBvbW9zUmVxdWlyZWQpO1xuICAgICAgICB0YXNrLmNvbXBsZXRlZCA9IHRhc2tfb2JqLmNvbXBsZXRlZDtcbiAgICAgICAgdGFzay5pZCA9IHRhc2tfb2JqLmlkO1xuICAgICAgICB0YXNrLnBvbW9zVXNlZCA9IHRhc2tfb2JqLnBvbW9zVXNlZDtcbiAgICAgICAgcmV0dXJuIHRhc2s7XG4gICAgfVxuICAgIHNlcmlhbGl6ZUludG9PYmooKSB7XG4gICAgICAgIHJldHVybiB7IHRpdGxlOiB0aGlzLnRpdGxlLCBkZXNjcmlwdGlvbjogdGhpcy5kZXNjcmlwdGlvbiwgcG9tb3NSZXF1aXJlZDogdGhpcy5wb21vc1JlcXVpcmVkLCBjb21wbGV0ZWQ6IHRoaXMuY29tcGxldGVkLCBwb21vc1VzZWQ6IHRoaXMucG9tb3NVc2VkLCBpZDogdGhpcy5pZCwgc2Vzc2lvbklEOiB0aGlzLnNlc3Npb25JRCB9O1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IFBPTU9fVEFTS19NQVAgPSBcInBvbW9fdGFza19tYXBcIjtcbmV4cG9ydCBjb25zdCBQT01PX1RBU0tfSU5ERVggPSBcInBvbW9fdGFza19pbmRleFwiO1xuXG4vKipcbiAqIFdpbGwgc3RvcmUgYSBuZXcgb3IgdXBkYXRlZCB0YXNrIGludG8gbG9jYWwgc3RvcmFnZVxuICogXG4gKiBIYXMgYSBzaWRlIGVmZmVjdCBvZiBhZGRpbmcgdGhlIGlkIG9mIHRoZSBuZXcgdGFzayBpZiBpdCB3YXNudCBzdG9yZWQgaW4gc3RvcmFnZSBiZWZvcmVcbiAqIFxuICogQHBhcmFtIHtUYXNrfSB0YXNrXG4gKiBAcmV0dXJucyB7bnVtYmVyfSAtIHRoZSBpZCBvZiB0aGUgdGFza1xuICovXG5leHBvcnQgZnVuY3Rpb24gc3RvcmVUYXNrKHRhc2spIHtcbiAgICBsZXQgdGFza19tYXAgPSBnZXRPYmplY3QoUE9NT19UQVNLX01BUCk7XG4gICAgaWYgKCF0YXNrX21hcFt0YXNrLmlkXSkge1xuICAgICAgICAvLyBpZiB0YXNrIG1hcCBkb2VzIG5vdCBoYXZlIHRoaXMgdGFzaywgY3JlYXRlIGEgbmV3IGluZGV4XG4gICAgICAgIGxldCBpZCA9IHBhcnNlSW50KGdldE9iamVjdChQT01PX1RBU0tfSU5ERVgpKTtcbiAgICAgICAgdGFzay5pZCA9IGlkO1xuICAgICAgICAvLyBpbmNyZW1lbnQgZ2xvYmFsIGlkXG4gICAgICAgIHN0b3JlT2JqZWN0KFBPTU9fVEFTS19JTkRFWCwgaWQgKyAxKTtcbiAgICB9XG4gICAgbGV0IG9iaiA9IHRhc2suc2VyaWFsaXplSW50b09iaigpO1xuICAgIHRhc2tfbWFwW3Rhc2suaWRdID0gb2JqO1xuICAgIHN0b3JlT2JqZWN0KFBPTU9fVEFTS19NQVAsIHRhc2tfbWFwKTtcbiAgICByZXR1cm4gdGFzay5pZDtcbn1cblxuLyoqXG4gKiBHZXQgdGhlIHRhc2sgYXNzb2NpYXRlZCB3aXRoIHRoaXMgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBpZCBcbiAqIEByZXR1cm5zIHtUYXNrfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGFzayhpZCkge1xuICAgIGxldCB0YXNrX21hcCA9IGdldE9iamVjdChQT01PX1RBU0tfTUFQKTtcbiAgICBsZXQgdGFza19vYmogPSB0YXNrX21hcFtpZF07XG4gICAgbGV0IHQgPSBuZXcgVGFzaygpO1xuICAgIHQgPSB0LnBhcnNlVGFza0Zyb21PYmoodGFza19vYmopO1xuICAgIHJldHVybiB0O1xuXG59XG4vKipcbiAqIEdldCBhbGwgdGFza3NcbiAqIFxuICogQHJldHVybnMge01hcDxudW1iZXIsIFRhc2s+fSAtIGEgbWFwIGZyb20gdGFzayBpZCB0byB0YXNrXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBbGxUYXNrcygpIHtcbiAgICBsZXQgdGFza19tYXAgPSBnZXRPYmplY3QoUE9NT19UQVNLX01BUCk7XG4gICAgbGV0IHBhcnNlZF90YXNrX21hcCA9IHt9O1xuICAgIGZvciAobGV0IGlkIGluIHRhc2tfbWFwKSB7XG4gICAgICAgIGxldCB0YXNrX29iaiA9IHRhc2tfbWFwW2lkXTtcbiAgICAgICAgbGV0IHQgPSBuZXcgVGFzaygpO1xuICAgICAgICB0ID0gdC5wYXJzZVRhc2tGcm9tT2JqKHRhc2tfb2JqKTtcbiAgICAgICAgcGFyc2VkX3Rhc2tfbWFwW2lkXSA9IHQ7XG4gICAgfVxuICAgIHJldHVybiBwYXJzZWRfdGFza19tYXA7XG59XG5cbi8qKlxuICogRGVsZXRlIGEgc3BlY2lmaWMgdGFzayBmcm9tIGRhdGFiYXNlIGJ5IHRoZSB1bmlxdWUgdGFzayBJRFxuICogXG4gKiBAcGFyYW0ge251bWJlcn0gaWQgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWxldGVUYXNrQnlUYXNrSUQoaWQpIHtcbiAgICBsZXQgdGFza19tYXAgPSBnZXRPYmplY3QoUE9NT19UQVNLX01BUCk7XG4gICAgZGVsZXRlIHRhc2tfbWFwW2lkXTtcbiAgICBzdG9yZU9iamVjdChQT01PX1RBU0tfTUFQLCB0YXNrX21hcCk7XG59XG5cblxuLyoqXG4gKiBDaGVja3MgaWYgdGhlcmUgYXJlIGFueSB1bmZpbmlzaGVkIHRhc2tzIGZyb20gdGhlIHByZXZpb3VzIHNlc3Npb25cbiAqIEByZXR1cm5zIHtib29sZWFufSAtIHRydWUgaWYgdW5pZmluaXNoZWQgdGFza3MgZXhpc3QsIGZhbHNlIG90aGVyd2lzZVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXJlVGhlcmVVbmZpbmlzaGVkVGFza3NGcm9tTGFzdFNlc3Npb24oKSB7XG4gICAgbGV0IG9sZFNlc3Npb25JRCA9IGdldExhdGVzdFNlc3Npb25JRCgpO1xuICAgIGlmIChvbGRTZXNzaW9uSUQgPT09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgICBsZXQgc2Vzc2lvbiA9IGdldFBvbW9TZXNzaW9uKG9sZFNlc3Npb25JRCk7XG4gICAgaWYgKHNlc3Npb24gPT09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgICBpZiAoc2Vzc2lvbi5jdXJyZW50VGFzaygpID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHRpZihfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdKSB7XG5cdFx0cmV0dXJuIF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0uZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvKipcbiAqIFRha2VzIGEgbnVtYmVyIG9mIHNlY29uZHMgYW5kIGZvcm1hdHMgaXQgaW50byBhIE1NOlNTIGZvcm1hdFxuICogQHBhcmFtIHtudW1iZXJ9IHNlY29uZHMgXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0VGltZShzZWNvbmRzKSB7XG4gIGxldCBzID0gc2Vjb25kcyAlIDYwO1xuICBsZXQgc3N0ciA9IFwiXCI7XG4gIGlmIChzIDwgMTApIHtcbiAgICBzc3RyID0gXCIwXCIgKyBzO1xuICB9IGVsc2Uge1xuICAgIHNzdHIgPSBzO1xuICB9XG4gIGxldCBtID0gTWF0aC5mbG9vcihzZWNvbmRzIC8gNjApO1xuICBsZXQgbXN0ciA9IFwiXCI7XG4gIGlmIChtIDwgMTApIHtcbiAgICBtc3RyID0gXCIwXCIgKyBtO1xuICB9IGVsc2Uge1xuICAgIG1zdHIgPSBtO1xuICB9XG4gIHJldHVybiBtc3RyICsgXCI6XCIgKyBzc3RyO1xufSIsIi8qKlxuICogV2lsbCByYW5kb21seSBwaWNrIGEgdGhlbWUgYW5kIHVuaXF1ZSBiYWNrZ3JvdW5kIGRlcGVuZGluZyBvbiB3aGF0IGRheSBpdCBpcyBhbmQgd2hhdCB0aW1lIGl0IGlzIGFuZCBzZXQgaXQgb24gdGhlIHBhZ2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNlbGVjdEFuZFNldFRoZW1lKHRvZGF5ID0gbmV3IERhdGUoKSkge1xuICBsZXQgaWQgPSAwO1xuICBsZXQgbnVtQkdzID0gNjtcblxuICBsZXQgZCA9IHRvZGF5LmdldERheSgpO1xuXG4gIGxldCBzZWVkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJiZy1zZWVkXCIpO1xuXG4gIGlmIChzZWVkID09PSBudWxsIHx8IHNlZWRbMF0gIT0gZCkge1xuICAgIHNlZWQgPSBkICsgXCItXCIgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBudW1CR3MpO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYmctc2VlZFwiLCBzZWVkKTtcbiAgfVxuICBsZXQgdGltZVBlcmlvZCA9IGdldFRoZW1lTW9kZSh0b2RheSk7XG4gIGlkID0gcGFyc2VJbnQoc2VlZFsyXSk7XG5cbiAgbGV0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJhY2tkcm9wXCIpO1xuICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoXCIuL2Fzc2V0cy9pbWFnZXMvYmFja2dyb3VuZHMvJHt0aW1lUGVyaW9kfS9iZyR7aWR9LmpwZ1wiKWA7XG59O1xuXG5leHBvcnQgY29uc3QgVEhFTUVfTU9ERVMgPSB7XG4gIERBWTogXCJkYXlcIixcbiAgTklHSFQ6IFwibmlnaHRcIixcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUaGVtZU1vZGUodG9kYXkgPSBuZXcgRGF0ZSgpKSB7XG4gIGxldCB0aW1lUGVyaW9kID0gVEhFTUVfTU9ERVMuREFZO1xuICBpZiAodG9kYXkuZ2V0SG91cnMoKSA8IDQpIHtcbiAgICB0aW1lUGVyaW9kID0gVEhFTUVfTU9ERVMuTklHSFQ7XG4gIH1cbiAgZWxzZSBpZiAodG9kYXkuZ2V0SG91cnMoKSA8IDE4KSB7XG4gICAgdGltZVBlcmlvZCA9IFRIRU1FX01PREVTLkRBWTtcbiAgfSBlbHNlIGlmICh0b2RheS5nZXRIb3VycygpIDwgMjQpIHtcbiAgICB0aW1lUGVyaW9kID0gVEhFTUVfTU9ERVMuTklHSFQ7XG4gIH1cbiAgcmV0dXJuIHRpbWVQZXJpb2Q7XG59IiwiaW1wb3J0IHsgZm9ybWF0VGltZSB9IGZyb20gXCIuL3V0aWxzL2Zvcm1hdC10aW1lXCI7XG5pbXBvcnQgeyBpbml0aWFsaXplRGF0YWJhc2UgfSBmcm9tIFwiLi9kYXRhYmFzZVwiO1xuaW1wb3J0IHsgZ2V0TGF0ZXN0U2Vzc2lvbklELCBnZXROZXdTZXNzaW9uSUQsIGdldFBvbW9TZXNzaW9uLCBQb21vU2Vzc2lvbiwgUE9NT19TRVNTSU9OX01PREVTLCBzZXRDdXJyZW50U2Vzc2lvblN0YXR1cywgc3RvcmVQb21vU2Vzc2lvbiwgdGhlcmVJc1VuZmluaXNoZWRTZXNzaW9uIH0gZnJvbSBcIi4vZGF0YWJhc2Uvc2Vzc2lvblwiO1xuaW1wb3J0IHsgYXJlVGhlcmVVbmZpbmlzaGVkVGFza3NGcm9tTGFzdFNlc3Npb24sIHN0b3JlVGFza30gZnJvbSBcIi4vZGF0YWJhc2UvdGFza1wiO1xuaW1wb3J0IHsgVGFzayB9IGZyb20gXCIuL2RhdGFiYXNlL3Rhc2tcIjtcbmltcG9ydCB7IHNlbGVjdEFuZFNldFRoZW1lIH0gZnJvbSBcIi4vdXRpbHMvdGhlbWVcIjtcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XG4gICAgc2VsZWN0QW5kU2V0VGhlbWUoKTtcbiAgICBcbiAgICBjb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuICAgIGNvbnN0IGxvYWRTYXZlZCA9IHVybFBhcmFtcy5nZXQoXCJsb2FkU2F2ZWRcIik7XG5cbiAgICBsZXQgYWRkVGFza0J1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGFza0NyZWF0b3JcIik7XG4gICAgbGV0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGRUYXNrTW9kYWxcIik7XG4gICAgbGV0IHRhc2tMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0YXNrTGlzdFwiKTtcbiAgICBsZXQgc3RhcnRUaW1lckJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RhcnRUaW1lclwiKTtcbiAgICBsZXQgY3VycmVudFRhc2tIVE1MID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjdXJyZW50VGFza1wiKTtcbiAgICBsZXQgdGFza0xpc3RIVE1MID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0YXNrTGlzdFwiKTtcbiAgICBsZXQgdGltZXJQcm9ncmVzc0NpcmNsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGltZXItcHJvZ3Jlc3NcIik7XG4gICAgbGV0IGRpc3RyYWN0ZWRCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRpc3RyYWN0ZWRXcmFwcGVyXCIpO1xuICAgIGxldCBjb21wbGV0ZVNlc3Npb25CdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbXBsZXRlU2Vzc2lvblwiKTtcbiAgICBsZXQgRW5kQnJlYWtFYXJseUJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiRW5kQnJlYWtFYXJseVdyYXBwZXJcIik7XG5cbiAgICBjb21wbGV0ZVNlc3Npb25CdXR0b24ub25jbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgPSBQT01PX1NFU1NJT05fTU9ERVMuQ09NUExFVEU7XG4gICAgICAgIHN0b3JlUG9tb1Nlc3Npb24oY3VycmVudFBvbW9TZXNzaW9uKTtcbiAgICB9O1xuXG4gICAgLy8gVE9ETzogbW92ZSB0aGlzIHRpbWUgdmFyaWFibGUgaW50byB0aGUgcG9tbyBzZXNzaW9uIG9iamVjdCBjbGFzcyB1c2luZyBsb2NhbHN0b3JhZ2VcbiAgICBsZXQgbWF4UG9tb1RpbWUgPSAyNSAqIDYwO1xuICAgIGxldCBtYXhCcmVha1RpbWUgPSA1ICogNjA7XG4gICAgbGV0IG1heExvbmdCcmVha1RpbWUgPSAxMCAqIDYwO1xuXG4gICAgXG4gICAgaW5pdGlhbGl6ZURhdGFiYXNlKCk7XG4gICAgaWYgKGxvYWRTYXZlZCA9PSBcImZhbHNlXCIpIHtcbiAgICAgICAgbGV0IG9sZFRhc2tzTGVmdCA9IGFyZVRoZXJlVW5maW5pc2hlZFRhc2tzRnJvbUxhc3RTZXNzaW9uKCk7XG4gICAgICAgIGlmIChvbGRUYXNrc0xlZnQpIHtcbiAgICAgICAgICAgIGxldCBjb25maXJtZWQgPSBjb25maXJtKFwiQnkgc3RhcnRpbmcgYSBuZXcgdGltZXIsIHlvdSB3aWxsIGxvc2UgYW55IHVuZmluaXNoZWQgdGFza3MgZnJvbSB5b3VyIHByZXZpb3VzIHNlc3Npb25cIik7XG4gICAgICAgICAgICBpZiAoIWNvbmZpcm1lZCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IFwiLi9pbmRleC5odG1sXCI7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgXG5cbiAgICAvKiogQHR5cGUge1BvbW9TZXNzaW9ufSAqL1xuICAgIGxldCBjdXJyZW50UG9tb1Nlc3Npb24gPSBudWxsO1xuXG4gICAgLy8gVXNlIGxlZnRvdmVyIHRhc2tzIGFuZCByZW5kZXIgdGhlbVxuICAgIGlmIChsb2FkU2F2ZWQgPT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgbGV0IHNlc3Npb25JRCA9IGdldExhdGVzdFNlc3Npb25JRCgpO1xuICAgICAgICBjdXJyZW50UG9tb1Nlc3Npb24gPSBnZXRQb21vU2Vzc2lvbihzZXNzaW9uSUQpO1xuXG4gICAgICAgIGlmICh0aGVyZUlzVW5maW5pc2hlZFNlc3Npb24oKSAmJiBjdXJyZW50UG9tb1Nlc3Npb24ubW9kZSAhPSBQT01PX1NFU1NJT05fTU9ERVMuSU5BQ1RJVkUpIHtcbiAgICAgICAgICAgIGxvYWRUYXNrcygpO1xuICAgICAgICAgICAgaW5pdGlhdGVUaW1lcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gY3JlYXRlIG5ldyBzZXNzaW9uIGFuZCB1c2Ugb2xkIHRhc2tzIGZyb20gbGFzdCB0aW1lXG4gICAgICAgICAgICBsZXQgc2Vzc2lvbklEID0gZ2V0TmV3U2Vzc2lvbklEKCk7XG4gICAgICAgICAgICBzZXRDdXJyZW50U2Vzc2lvblN0YXR1cyhcImluLXByb2dyZXNzXCIpO1xuXG4gICAgICAgICAgICAvLyB0YWtlIHRoZSBvbGQgdGFza3MgYW5kIHVwZGF0ZSB0aGUgc2Vzc2lvbiBpZHMgdG8gdGhlIG5ldyBvbmVcbiAgICAgICAgICAgIGxldCBvbGRUYXNrcyA9IGN1cnJlbnRQb21vU2Vzc2lvbi5hbGxUYXNrcztcbiAgICAgICAgICAgIG9sZFRhc2tzLmZvckVhY2goKHRhc2spID0+IHtcbiAgICAgICAgICAgICAgICB0YXNrLnNlc3Npb25JRCA9IHNlc3Npb25JRDtcbiAgICAgICAgICAgICAgICBzdG9yZVRhc2sodGFzayk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uID0gbmV3IFBvbW9TZXNzaW9uKHNlc3Npb25JRCk7XG5cbiAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lID0gbWF4UG9tb1RpbWU7XG4gICAgICAgICAgICBjdXJyZW50UG9tb1Nlc3Npb24uYWxsVGFza3MgPSBvbGRUYXNrcztcbiAgICAgICAgICAgIC8vIHNhdmUgb3VyIG5ldyBwb21vIHNlc3Npb25cbiAgICAgICAgICAgIHN0b3JlUG9tb1Nlc3Npb24oY3VycmVudFBvbW9TZXNzaW9uKTtcbiAgICAgICAgICAgIGxvYWRUYXNrcygpO1xuICAgICAgICB9XG4gICAgXG4gICAgfVxuICAgIGVsc2UgaWYgKGxvYWRTYXZlZCA9PSBcImZhbHNlXCIpIHtcbiAgICAgICAgLy8gbm90ZSwgaWYgeW91IHJlZnJlc2ggZm9yIG5vdywgeW91IHdpbGwgbG9zZSB5b3VyIHNlc3Npb24ncyBjaGFuZ2VzLi4uXG4gICAgICAgIGxldCBzZXNzaW9uSUQgPSBnZXROZXdTZXNzaW9uSUQoKTtcbiAgICAgICAgc2V0Q3VycmVudFNlc3Npb25TdGF0dXMoXCJpbi1wcm9ncmVzc1wiKTtcblxuICAgICAgICBjdXJyZW50UG9tb1Nlc3Npb24gPSBuZXcgUG9tb1Nlc3Npb24oc2Vzc2lvbklEKTtcbiAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLnRpbWUgPSBtYXhQb21vVGltZTtcbiAgICAgICAgLy8gc2F2ZSBvdXIgbmV3IHBvbW8gc2Vzc2lvblxuICAgICAgICBzdG9yZVBvbW9TZXNzaW9uKGN1cnJlbnRQb21vU2Vzc2lvbik7XG4gICAgICAgIGxvYWRUYXNrcygpO1xuXG4gICAgfVxuXG4gICAgdXJsUGFyYW1zLnNldChcImxvYWRTYXZlZFwiLCB0cnVlKTtcblxuICAgIHRpbWVyUHJvZ3Jlc3NDaXJjbGUuc2V0RGlzcGxheVRleHQoZm9ybWF0VGltZShjdXJyZW50UG9tb1Nlc3Npb24udGltZSkpO1xuICAgIHRpbWVyUHJvZ3Jlc3NDaXJjbGUuc2V0UGVyY2VudGFnZShjdXJyZW50UG9tb1Nlc3Npb24udGltZSAvIG1heFBvbW9UaW1lKTtcbiAgICBpZiAoY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgPT09IFBPTU9fU0VTU0lPTl9NT0RFUy5CUkVBSykge1xuICAgICAgICByZW5kZXJCcmVha01vZGUoKTtcbiAgICAgICAgdGltZXJQcm9ncmVzc0NpcmNsZS5zZXRQZXJjZW50YWdlKGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lIC8gbWF4QnJlYWtUaW1lKTtcbiAgICB9IGVsc2UgaWYgKGN1cnJlbnRQb21vU2Vzc2lvbi5tb2RlID09PSBQT01PX1NFU1NJT05fTU9ERVMuTE9OR19CUkVBSykge1xuICAgICAgICByZW5kZXJCcmVha01vZGUoKTtcbiAgICAgICAgdGltZXJQcm9ncmVzc0NpcmNsZS5zZXRQZXJjZW50YWdlKGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lIC8gU1ZHRkVDb2xvck1hdHJpeEVsZW1lbnQpO1xuICAgIH1cblxuICAgIC8vIEltcGxlbWVudHMgdGhlIG9uY2xpY2sgZnVuY3Rpb25hbGl0eSBvZiBFbmQgQnJlYWsgRWFybHkgQnV0dG9uLCB3aGljaCBpbW1lZGlhdGVseSBzdG9wIHRoZSBicmVhayBcbiAgICAvLyBhbmQgZ28gdG8gdGhlIHdvcmsgdGltZVxuICAgIEVuZEJyZWFrRWFybHlCdXR0b24ub25jbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IGJyZWFrQWxhcm0gPSBuZXcgQXVkaW8oXCJhc3NldHMvYXVkaW8vYnJlYWtBbGFybS5tcDNcIik7XG4gICAgICAgIGJyZWFrQWxhcm0ucGxheSgpO1xuICAgICAgICByZW5kZXJBY3RpdmVNb2RlKCk7XG4gICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lID0gbWF4UG9tb1RpbWU7XG4gICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi5tb2RlID0gUE9NT19TRVNTSU9OX01PREVTLkFDVElWRTtcbiAgICAgICAgdGltZXJQcm9ncmVzc0NpcmNsZS5zZXREaXNwbGF5VGV4dChmb3JtYXRUaW1lKGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lKSk7XG4gICAgICAgIHRpbWVyUHJvZ3Jlc3NDaXJjbGUuc2V0UGVyY2VudGFnZShjdXJyZW50UG9tb1Nlc3Npb24udGltZSAvIG1heFBvbW9UaW1lKTtcbiAgICAgICAgc3RvcmVQb21vU2Vzc2lvbihjdXJyZW50UG9tb1Nlc3Npb24pO1xuICAgIH07XG5cbiAgICBzdGFydFRpbWVyQnV0dG9uLm9uY2xpY2sgPSBpbml0aWF0ZVRpbWVyO1xuXG4gICAgbW9kYWwuc2hhZG93Um9vdC5nZXRFbGVtZW50QnlJZChcInNhdmUtYnRuXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjb250ZW50c1NhdmVkKTtcbiAgICBhZGRUYXNrQnV0dG9uLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG1vZGFsLmRpc3BsYXlNb2RhbCgpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBJbXBsZW1lbnRzIHRoZSBvbkNsaWNrIGZ1bmN0aW9uYWxpdHkgb2YgdGhlIFN0YXJ0IFRpbWVyIGJ1dHRvbiwgd2hpY2ggc3RhcnRzIHRoZSBwb21vIHRpbWVyIGFuZCBjeWNsZXNcbiAgICAgKiBwb21vIGFuZCBicmVhayB0aW1lcnMgdW50aWwgYWxsIHBvbW9zIGFyZSBjb21wbGV0ZWQuXG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5pdGlhdGVUaW1lcigpIHtcbiAgICAgICAgY3VycmVudFRhc2tIVE1MLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiY3VycmVudFRhc2tXb3JrVGltZVwiKTtcbiAgICAgICAgdGltZXJQcm9ncmVzc0NpcmNsZS5zZXRTaXplKFwiMS41cmVtXCIpO1xuXG4gICAgICAgIHRhc2tMaXN0LnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwidGFza0xpc3RXb3JrVGltZVwiKTtcblxuICAgICAgICBsZXQgdGltZXJXcmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aW1lcldyYXBwZXJcIik7XG4gICAgICAgIHRpbWVyV3JhcHBlci5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInRpbWVyV3JhcHBlcldvcmtUaW1lXCIpO1xuXG4gICAgICAgIGRpc3RyYWN0ZWRCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcblxuXG4gICAgICAgIGxldCBjb21wbGV0ZVNlc3Npb25XcmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21wbGV0ZVNlc3Npb25XcmFwcGVyXCIpO1xuICAgICAgICBjb21wbGV0ZVNlc3Npb25XcmFwcGVyLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiY29tcGxldGVTZXNzaW9uV3JhcHBlcldvcmtUaW1lXCIpO1xuICAgICAgICBsZXQgdGFza0NyZWF0b3JXcmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0YXNrQ3JlYXRvcldyYXBwZXJcIik7XG4gICAgICAgIHRhc2tDcmVhdG9yV3JhcHBlci5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjdXJyZW50VGFza1dyYXBwZXJcIikuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcblxuICAgICAgICBzdGFydE5ld1Rhc2soKTtcblxuICAgICAgICBpZiAoY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgPT09IFBPTU9fU0VTU0lPTl9NT0RFUy5JTkFDVElWRSkge1xuICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgPSBQT01PX1NFU1NJT05fTU9ERVMuQUNUSVZFO1xuICAgICAgICAgICAgc3RvcmVQb21vU2Vzc2lvbihjdXJyZW50UG9tb1Nlc3Npb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9yZW1vdmVzIGZpcnN0IGNoaWxkIGZyb20gdGFzayBsaXN0IGFuZCBhZGRzIHRvIGN1cnJlbnQgdGFza1xuXG4gICAgICAgIGxldCB0aW1lckxvb3AgPSBzZXRJbnRlcnZhbCh0aW1lQ2hhbmdlciwgMTAwMCk7XG5cbiAgICAgICAgbGV0IGN1cnJlbnRUYXNrRmlyc3RDaGlsZCA9IGN1cnJlbnRUYXNrSFRNTC5jaGlsZE5vZGVzWzBdO1xuICAgICAgICBjdXJyZW50VGFza0ZpcnN0Q2hpbGQuc2V0RmluaXNoVGFza0NhbGxiYWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJlbW92ZUNvbXBsZXRlZFRhc2tzKCk7XG4gICAgICAgICAgICBzdGFydE5ld1Rhc2soKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGxldCBjdXJyZW50VGFzayA9IGN1cnJlbnRQb21vU2Vzc2lvbi5jdXJyZW50VGFzaygpO1xuICAgICAgICBjdXJyZW50VGFza0ZpcnN0Q2hpbGQudGFzayA9IGN1cnJlbnRUYXNrO1xuICAgICAgICBmdW5jdGlvbiB0aW1lQ2hhbmdlcigpIHtcbiAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbiA9IGdldFBvbW9TZXNzaW9uKGN1cnJlbnRQb21vU2Vzc2lvbi5pZCk7XG4gICAgICAgICAgICBjdXJyZW50UG9tb1Nlc3Npb24udGltZSAtPSAxO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lIDwgMCkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgc2Vzc2lvbiBpcyBpbmNvbXBsZXRlLiBpZiBpbmNvbXBsZXRlLCBcbiAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAvLyBJZiB0aW1lciBoaXRzIDAsIHRvZ2dsZSB0byBuZXh0IGJyZWFrIG9yIHBvbW8gdGltZXJcbiAgICAgICAgICAgIGlmIChjdXJyZW50UG9tb1Nlc3Npb24udGltZSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRQb21vU2Vzc2lvbi5tb2RlID09PSBQT01PX1NFU1NJT05fTU9ERVMuQUNUSVZFKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB3b3JrQWxhcm0gPSBuZXcgQXVkaW8oXCJhc3NldHMvYXVkaW8vd29ya0FsYXJtLm1wM1wiKTtcbiAgICAgICAgICAgICAgICAgICAgd29ya0FsYXJtLnBsYXkoKTtcblxuICAgICAgICAgICAgICAgICAgICAvL2JyZWFrIFxuICAgICAgICAgICAgICAgICAgICByZW5kZXJCcmVha01vZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLnBvbW9zRWxhcHNlZCArPSAxO1xuXG4gICAgICAgICAgICAgICAgICAgIGxldCBjdXJyZW50VGFza0ZpcnN0Q2hpbGQgPSBjdXJyZW50VGFza0hUTUwuY2hpbGROb2Rlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFRhc2tGaXJzdENoaWxkLmluY3JlbWVudFBvbW9zVXNlZCgpO1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGFza0ZpcnN0Q2hpbGQudGFzay5wb21vc1VzZWQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLmluY3JlbWVudFRhc2tQb21vc1VzZWQoY3VycmVudFRhc2tGaXJzdENoaWxkLnRhc2suaWQpO1xuICAgICAgICAgICAgICAgICAgICBzdG9yZVBvbW9TZXNzaW9uKGN1cnJlbnRQb21vU2Vzc2lvbik7XG5cbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFRhc2tGaXJzdENoaWxkLnNldEF0dHJpYnV0ZShcInBvbW9zdXNlZFwiLCAxICsgcGFyc2VJbnQoY3VycmVudFRhc2tGaXJzdENoaWxkLmdldEF0dHJpYnV0ZShcInBvbW9zdXNlZFwiKSkpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIExvbmcgYnJlYWssIGN1cnJlbnRseSBoYXJkY29kZWQgYWZ0ZXIgZXZlcnkgNCBwb21vc1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFBvbW9TZXNzaW9uLnBvbW9zRWxhcHNlZCAlIDQgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLnRpbWUgPSBtYXhMb25nQnJlYWtUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgPSBQT01PX1NFU1NJT05fTU9ERVMuTE9OR19CUkVBSztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBTaG9ydCBicmVha1xuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lID0gbWF4QnJlYWtUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgPSBQT01PX1NFU1NJT05fTU9ERVMuQlJFQUs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gTmV4dCB0aW1lciBzaG91bGQgYmUgYSBwb21vIHRpbWVyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgIT09IFBPTU9fU0VTU0lPTl9NT0RFUy5DT01QTEVURSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgYnJlYWtBbGFybSA9IG5ldyBBdWRpbyhcImFzc2V0cy9hdWRpby9icmVha0FsYXJtLm1wM1wiKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtBbGFybS5wbGF5KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyQWN0aXZlTW9kZSgpO1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50UG9tb1Nlc3Npb24udGltZSA9IG1heFBvbW9UaW1lO1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50UG9tb1Nlc3Npb24ubW9kZSA9IFBPTU9fU0VTU0lPTl9NT0RFUy5BQ1RJVkU7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogQWRkIGZ1bmN0aW9uYWxpdHkgZm9yIG1vdmluZyBvbnRvIG5leHQgdGFzaywgdXBkYXRpbmcgcG9tb3MgdXNlZCBvbiBjdXJyZW50IHRhc2ssIGV0Yy5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBQdXNoIHVwZGF0ZWQgdGltZSB0byB0aGUgcGFnZVxuICAgICAgICAgICAgZG9jdW1lbnQudGl0bGUgPSBmb3JtYXRUaW1lKGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lKTtcbiAgICAgICAgICAgIHRpbWVyUHJvZ3Jlc3NDaXJjbGUuc2V0RGlzcGxheVRleHQoZm9ybWF0VGltZShjdXJyZW50UG9tb1Nlc3Npb24udGltZSkpO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRQb21vU2Vzc2lvbi5tb2RlID09PSBQT01PX1NFU1NJT05fTU9ERVMuQUNUSVZFKSB7XG4gICAgICAgICAgICAgICAgdGltZXJQcm9ncmVzc0NpcmNsZS5zZXRQZXJjZW50YWdlKGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lIC8gbWF4UG9tb1RpbWUpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlICs9IFwiIC0gV29ya1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgPT09IFBPTU9fU0VTU0lPTl9NT0RFUy5CUkVBSykge1xuICAgICAgICAgICAgICAgIHRpbWVyUHJvZ3Jlc3NDaXJjbGUuc2V0UGVyY2VudGFnZShjdXJyZW50UG9tb1Nlc3Npb24udGltZSAvIG1heEJyZWFrVGltZSk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQudGl0bGUgKz0gXCIgLSBCcmVha1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgPT09IFBPTU9fU0VTU0lPTl9NT0RFUy5MT05HX0JSRUFLKSB7XG4gICAgICAgICAgICAgICAgdGltZXJQcm9ncmVzc0NpcmNsZS5zZXRQZXJjZW50YWdlKGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lIC8gbWF4TG9uZ0JyZWFrVGltZSk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQudGl0bGUgKz0gXCIgLSBMb25nIEJyZWFrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzdG9yZVBvbW9TZXNzaW9uKGN1cnJlbnRQb21vU2Vzc2lvbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW5kZXJBY3RpdmVNb2RlKCkge1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRpbWVyLXN0YXR1c1wiKS5pbm5lclRleHQgPSBcIlBvbW8gVGltZVwiO1xuICAgICAgICBjdXJyZW50VGFza0hUTUwuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjdXJyZW50VGFza1dvcmtUaW1lXCIpO1xuICAgICAgICB0YXNrTGlzdEhUTUwuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJ0YXNrTGlzdFdvcmtUaW1lXCIpO1xuICAgICAgICBkaXN0cmFjdGVkQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgIEVuZEJyZWFrRWFybHlCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXG4gICAgICAgIHRpbWVyV3JhcHBlci5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInRpbWVyV3JhcHBlcldvcmtUaW1lXCIpO1xuICAgICAgICBjb21wbGV0ZVNlc3Npb25XcmFwcGVyLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiY29tcGxldGVTZXNzaW9uV3JhcHBlcldvcmtUaW1lXCIpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbmRlckJyZWFrTW9kZSgpIHtcbiAgICAgICAgY3VycmVudFRhc2tIVE1MLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiY3VycmVudFRhc2tCcmVha1RpbWVcIik7XG4gICAgICAgIHRhc2tMaXN0SFRNTC5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInRhc2tMaXN0QnJlYWtUaW1lXCIpO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRpbWVyLXN0YXR1c1wiKS5pbm5lclRleHQgPSBcIkJyZWFrIFRpbWVcIjtcbiAgICAgICAgRW5kQnJlYWtFYXJseUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgICBkaXN0cmFjdGVkQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuICAgICAgICB0aW1lcldyYXBwZXIuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJ0aW1lcldyYXBwZXJCcmVha1RpbWVcIik7XG4gICAgICAgIGNvbXBsZXRlU2Vzc2lvbldyYXBwZXIuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjb21wbGV0ZVNlc3Npb25XcmFwcGVyQnJlYWtUaW1lXCIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICogUmVuZGVyIGEgdGFzayBvbnRvIHRoZSBcbiAgICAqIEBwYXJhbSB7VGFza30gdGFzayBcbiAgICAqL1xuICAgIGZ1bmN0aW9uIHJlbmRlclRhc2tJbnRvVGFza0xpc3QodGFzaykge1xuICAgICAgICBjb25zdCBjdXJyZW50VGFza0VsZW1lbnQgPSBgPHBvbW8tdGFzayBkZXNjcmlwdGlvbiA9XCIke3Rhc2suZGVzY3JpcHRpb259XCIgcG9tb3NVc2VkPVwiJHt0YXNrLnBvbW9zVXNlZH1cIiwgcG9tb3NSZXF1aXJlZCA9XCIke3Rhc2sucG9tb3NSZXF1aXJlZH1cIj4ke3Rhc2sudGl0bGV9PC9wb21vLXRhc2s+YDtcbiAgICAgICAgdGFza0xpc3QuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIGN1cnJlbnRUYXNrRWxlbWVudCk7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0YXNrTGlzdC5jaGlsZE5vZGVzW3Rhc2tMaXN0LmNoaWxkTm9kZXMubGVuZ3RoIC0gMV07XG4gICAgICAgIGVsZW1lbnQuc2V0RmluaXNoVGFza0NhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgICAgIHJlbW92ZUNvbXBsZXRlZFRhc2tzKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBlbGVtZW50LnNldERlbGV0ZVRhc2tDYWxsYmFjaygoKSA9PiB7XG4gICAgICAgICAgICBkZWxldGVUYXNrQnlJZCh0YXNrLmlkKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGVsZW1lbnQudGFzayA9IHRhc2s7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdGhhdCBnZXRzIGNhbGxlZCB3aGVuIHdlIHNhdmUgYSBuZXcgdGFzay5cbiAgICAgKiBBZGRzIG5ldyB0YXNrIHRvIHRoZSBjdXJyZW50IHRhc2tzIGxpc3QuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29udGVudHNTYXZlZCgpIHtcbiAgICAgICAgbGV0IHRhc2tWYWx1ZXMgPSBtb2RhbC5lbGVtZW50cy52YWx1ZXM7XG4gICAgICAgIGlmKHRhc2tWYWx1ZXMgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBsZXQgc2Vzc2lvbklEID0gZ2V0TGF0ZXN0U2Vzc2lvbklEKCk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0YXNrVmFsdWVzKTtcbiAgICAgICAgICAgIGxldCBuZXdUYXNrID0gbmV3IFRhc2soc2Vzc2lvbklELCB0YXNrVmFsdWVzLnRhc2tOYW1lLCB0YXNrVmFsdWVzLmRlc2NyaXB0aW9uLCBwYXJzZUludCh0YXNrVmFsdWVzLnBvbW9zUmVxdWlyZWQpKTtcbiAgICAgICAgICAgIHJlbmRlclRhc2tJbnRvVGFza0xpc3QobmV3VGFzayk7XG4gICAgICAgICAgICBjdXJyZW50UG9tb1Nlc3Npb24uYWRkVGFzayhuZXdUYXNrKTtcbiAgICAgICAgICAgIHN0b3JlUG9tb1Nlc3Npb24oY3VycmVudFBvbW9TZXNzaW9uKTtcblxuICAgICAgICAgICAgcmVzZXRJbnB1dHMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFycyBpbnB1dHMgYW5kIHJlc2V0cyBzdHlsZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlc2V0SW5wdXRzKCkge1xuICAgICAgICBjb25zdCB0YXNrTmFtZSA9IG1vZGFsLnNoYWRvd1Jvb3QuZ2V0RWxlbWVudEJ5SWQoXCJ0YXNrLW5hbWVcIikuZWxlbWVudHMud3JhcHBlcjtcbiAgICAgICAgY29uc3QgcG9tb3NSZXF1aXJlZCA9IG1vZGFsLnNoYWRvd1Jvb3QuZ2V0RWxlbWVudEJ5SWQoXCJwb21vcy1yZXF1aXJlZFwiKS5lbGVtZW50cy53cmFwcGVyO1xuICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IG1vZGFsLnNoYWRvd1Jvb3QuZ2V0RWxlbWVudEJ5SWQoXCJkZXNjcmlwdGlvblwiKS5lbGVtZW50cy53cmFwcGVyO1xuXG4gICAgICAgIHRhc2tOYW1lLmlubmVyVGV4dCA9IHRhc2tOYW1lLnBsYWNlaG9sZGVyO1xuICAgICAgICB0YXNrTmFtZS51c2VyVHlwZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRhc2tOYW1lLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwicG9tby1pbnB1dCBwbGFjZWhvbGRlclwiKTtcblxuICAgICAgICBwb21vc1JlcXVpcmVkLmlubmVyVGV4dCA9IHBvbW9zUmVxdWlyZWQucGxhY2Vob2xkZXI7XG4gICAgICAgIHBvbW9zUmVxdWlyZWQudXNlclR5cGVkID0gdW5kZWZpbmVkO1xuICAgICAgICBwb21vc1JlcXVpcmVkLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwicG9tby1pbnB1dCBwbGFjZWhvbGRlclwiKTtcblxuICAgICAgICBkZXNjcmlwdGlvbi5pbm5lclRleHQgPSBkZXNjcmlwdGlvbi5wbGFjZWhvbGRlcjtcbiAgICAgICAgZGVzY3JpcHRpb24udXNlclR5cGVkID0gdW5kZWZpbmVkO1xuICAgICAgICBkZXNjcmlwdGlvbi5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInBvbW8taW5wdXQgcGxhY2Vob2xkZXJcIik7XG5cbiAgICAgICAgbW9kYWwuZWxlbWVudHMudmFsdWVzID0gdW5kZWZpbmVkO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogU2hvd3MgYSBuZXcgdGFzayBvbnRvIHRoZSBkaXNwbGF5XG4gICAgICovXG4gICAgZnVuY3Rpb24gc3RhcnROZXdUYXNrKCkge1xuICAgICAgICBsZXQgdGFza0xpc3RGaXJzdENoaWxkID0gdGFza0xpc3RIVE1MLmNoaWxkTm9kZXNbMF07XG4gICAgICAgIGxldCBuZXh0VGFzayA9IGN1cnJlbnRQb21vU2Vzc2lvbi5nZXROZXh0VGFzaygpO1xuICAgICAgICBpZiAobmV4dFRhc2sgPT09IG51bGwpIHtcbiAgICAgICAgICAgIC8vIGNvbXBsZXRlIHRoZSBzZXNzaW9uXG4gICAgICAgICAgICBjdXJyZW50UG9tb1Nlc3Npb24ubW9kZSA9IFBPTU9fU0VTU0lPTl9NT0RFUy5DT01QTEVURTtcbiAgICAgICAgICAgIHN0b3JlUG9tb1Nlc3Npb24oY3VycmVudFBvbW9TZXNzaW9uKTtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9XCIuL2hpc3RvcnkuaHRtbFwiO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGN1cnJlbnRUYXNrVG9CZUFkZGVkID0gYDxwb21vLXRhc2sgZGVzY3JpcHRpb249XCIke25leHRUYXNrLmRlc2NyaXB0aW9ufVwiIHBvbW9zVXNlZD1cIiR7bmV4dFRhc2sucG9tb3NVc2VkfVwiIHBvbW9zUmVxdWlyZWQ9JHtuZXh0VGFzay5wb21vc1JlcXVpcmVkfT4ke25leHRUYXNrLnRpdGxlfTwvcG9tby10YXNrPmA7XG4gICAgICAgIGN1cnJlbnRUYXNrSFRNTC5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgY3VycmVudFRhc2tUb0JlQWRkZWQpO1xuICAgICAgICB0YXNrTGlzdEhUTUwucmVtb3ZlQ2hpbGQodGFza0xpc3RIVE1MLmNoaWxkTm9kZXNbMF0pO1xuICAgICAgICBsZXQgZWxlbWVudCA9IGN1cnJlbnRUYXNrSFRNTC5jaGlsZE5vZGVzW2N1cnJlbnRUYXNrSFRNTC5jaGlsZE5vZGVzLmxlbmd0aCAtIDFdO1xuICAgICAgICBlbGVtZW50LnNldEZpbmlzaFRhc2tDYWxsYmFjaygoKSA9PiB7XG4gICAgICAgICAgICByZW1vdmVDb21wbGV0ZWRUYXNrcygpO1xuICAgICAgICAgICAgc3RhcnROZXdUYXNrKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBlbGVtZW50LnNldERlbGV0ZVRhc2tDYWxsYmFjaygoKSA9PiB7XG4gICAgICAgICAgICBkZWxldGVUYXNrQnlJZChuZXh0VGFzay5pZCk7XG4gICAgICAgIH0pO1xuICAgICAgICBlbGVtZW50LnRhc2sgPSBuZXh0VGFzaztcblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHJlbW92ZSBjb21wbGV0ZWQgdGFza3MgZnJvbSBkaXNwbGF5IGFuZCB1cGRhdGUgdGhlIGN1cnJlbnQgcG9tbyBzZXNzaW9uXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVtb3ZlQ29tcGxldGVkVGFza3MoKSB7XG4gICAgICAgIGxldCBjb21wbGV0ZWRJZHMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgbm9kZSBvZiBjdXJyZW50VGFza0hUTUwuY2hpbGROb2Rlcykge1xuICAgICAgICAgICAgaWYgKG5vZGUuY29tcGxldGVkKSB7XG4gICAgICAgICAgICAgICAgY29tcGxldGVkSWRzLnB1c2gobm9kZS50YXNrLmlkKTtcbiAgICAgICAgICAgICAgICBub2RlLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFRhc2tIVE1MLnJlbW92ZUNoaWxkKG5vZGUpO1xuICAgICAgICAgICAgICAgIH0sIDIwMCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBub2RlIG9mIHRhc2tMaXN0SFRNTC5jaGlsZE5vZGVzKSB7XG4gICAgICAgICAgICBpZiAobm9kZS5jb21wbGV0ZWQpIHtcbiAgICAgICAgICAgICAgICBjb21wbGV0ZWRJZHMucHVzaChub2RlLnRhc2suaWQpO1xuICAgICAgICAgICAgICAgIG5vZGUuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0YXNrTGlzdEhUTUwucmVtb3ZlQ2hpbGQobm9kZSk7XG4gICAgICAgICAgICAgICAgfSwgMjAwKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb21wbGV0ZWRJZHMuZm9yRWFjaCgoaWQpID0+IHtcbiAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi5jb21wbGV0ZVRhc2soaWQpO1xuICAgICAgICB9KTtcbiAgICAgICAgc3RvcmVQb21vU2Vzc2lvbihjdXJyZW50UG9tb1Nlc3Npb24pO1xuXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVsZXRlVGFza0J5SWQoaWQpIHtcbiAgICAgICAgLy8gc2VhcmNoIGN1cnJlbnQgdGFzayBsaXN0IGFuZCB0YXNrIGxpc3RzIGZvciB0aGlzIGlkIGFuZCByZW1vdmUgaXQgZnJvbSBkaXNwbGF5IGFuZCB0aGUgcG9tbyBzZXNzaW9uXG4gICAgICAgIGxldCBjdXJyZW50VGFza0VsZW1lbnRMaXN0ID0gY3VycmVudFRhc2tIVE1MLmNoaWxkTm9kZXM7XG4gICAgICAgIGlmIChjdXJyZW50VGFza0VsZW1lbnRMaXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgbGV0IHRhc2sgPSBjdXJyZW50VGFza0VsZW1lbnRMaXN0W2N1cnJlbnRUYXNrRWxlbWVudExpc3QubGVuZ3RoIC0gMV0udGFzaztcbiAgICAgICAgICAgIGlmICh0YXNrLmlkID09PSBpZCkge1xuICAgICAgICAgICAgICAgIGlmIChjb25maXJtKFwiQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIHRhc2s/XCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi5kZWxldGVUYXNrKHRhc2spO1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGFza0hUTUwucmVtb3ZlQ2hpbGQoY3VycmVudFRhc2tIVE1MLmNoaWxkTm9kZXNbY3VycmVudFRhc2tFbGVtZW50TGlzdC5sZW5ndGggLSAxXSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0TmV3VGFzaygpOyAgICAgXG4gICAgICAgICAgICAgICAgICAgIHN0b3JlUG9tb1Nlc3Npb24oY3VycmVudFBvbW9TZXNzaW9uKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGFza0xpc3RIVE1MLmNoaWxkTm9kZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgdGFza0xpc3RIVE1MLmNoaWxkTm9kZXMpIHtcbiAgICAgICAgICAgICAgICBsZXQgdGFzayA9IG5vZGUudGFzaztcbiAgICAgICAgICAgICAgICBpZiAodGFzay5pZCA9PT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm0oXCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgdGFzaz9cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi5kZWxldGVUYXNrKHRhc2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0xpc3RIVE1MLnJlbW92ZUNoaWxkKHRhc2tMaXN0SFRNTC5jaGlsZE5vZGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JlUG9tb1Nlc3Npb24oY3VycmVudFBvbW9TZXNzaW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZCBhbGwgdGFza3MgZnJvbSBzdG9yYWdlIGZvciB0aGUgY3VycmVudCBzZXNzaW9uIGFuZCByZW5kZXIgdGhlbVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGxvYWRUYXNrcygpIHtcbiAgICAgICAgbGV0IGlkID0gZ2V0TGF0ZXN0U2Vzc2lvbklEKCk7XG4gICAgICAgIGxldCBhbGxUYXNrcyA9IFtdO1xuICAgICAgICBpZiAoaWQgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGxldCB0YXNrcyA9IGN1cnJlbnRQb21vU2Vzc2lvbi5hbGxUYXNrcztcbiAgICAgICAgICAgIE9iamVjdC52YWx1ZXModGFza3MpLmZvckVhY2goKHRhc2spID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0YXNrKTtcbiAgICAgICAgICAgICAgICBpZiAodGFzay5zZXNzaW9uSUQgPT09IGlkICYmICF0YXNrLmNvbXBsZXRlZCkge1xuICAgICAgICAgICAgICAgICAgICBhbGxUYXNrcy5wdXNoKHRhc2spO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYWxsVGFza3MuZm9yRWFjaCgodGFzaykgPT4ge1xuICAgICAgICAgICAgICAgIHJlbmRlclRhc2tJbnRvVGFza0xpc3QodGFzayk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBub2RlIG9mIHRhc2tMaXN0SFRNTC5jaGlsZE5vZGVzKSB7XG4gICAgICAgICAgICBub2RlLnNldEZpbmlzaFRhc2tDYWxsYmFjaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ29tcGxldGVkVGFza3MoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufSk7Il0sInNvdXJjZVJvb3QiOiIifQ==