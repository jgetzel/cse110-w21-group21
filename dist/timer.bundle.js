(()=>{"use strict";var e={409:(e,t,r)=>{r.d(t,{xN:()=>s,RL:()=>i,RK:()=>a});var n=r(594),o=r(771);function s(){var e=!1;null===a(n.Rd)&&(e=!0),null===a(n.oi)&&(e=!0),null===!localStorage.getItem(o.Do)&&(e=!0),null===!localStorage.getItem(o.mn)&&(e=!0),null===a(o.XB)&&(e=!0),e&&(i(n.Rd,{}),i(n.oi,0),i(o.mn,"complete"),i(o.Do,0),i(o.XB,{}))}function i(e,t){localStorage.setItem(e,JSON.stringify(t))}function a(e){return JSON.parse(localStorage.getItem(e))}},771:(e,t,r)=>{r.d(t,{Do:()=>l,mn:()=>c,XB:()=>u,rA:()=>d,Nt:()=>m,_c:()=>p,E3:()=>f,qc:()=>h,yJ:()=>v,RU:()=>y,hY:()=>k});var n=r(409),o=r(594);function s(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw s}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l="pomo_session_id",c="latest_pomo_session_status",u="pomo_session_map",d={INACTIVE:"inactive",BREAK:"break",LONG_BREAK:"longbreak",ACTIVE:"active",COMPLETE:"complete"},m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.allTasks=[],this.mode=d.INACTIVE,this.time=0,this.pomosElapsed=0,this.startDate=new Date}var t,r;return t=e,(r=[{key:"currentTask",value:function(){var e=this.allTasks.filter((function(e){return!e.completed}));return e.length>0?e[0]:null}},{key:"addTask",value:function(e){(0,o.rs)(e),this.allTasks.push(e)}},{key:"deleteTask",value:function(e){(0,o.c_)(e.id);for(var t=0;t<this.allTasks.length;t++){var r=this.allTasks[t];if(e.id===r.id)return void this.allTasks.splice(t,1)}}},{key:"completeTask",value:function(e){var t,r=s(this.allTasks);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.id===e)return n.completed=!0,!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"getNextTask",value:function(){var e,t=s(this.allTasks);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(!1===r.completed)return r}}catch(e){t.e(e)}finally{t.f()}return null}},{key:"incrementTaskPomosUsed",value:function(e){var t,r=s(this.allTasks);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.id===e)return n.pomosUsed+=1,void(this.pomosElapsed+=1)}}catch(e){r.e(e)}finally{r.f()}}},{key:"isBreak",value:function(){return this.mode===d.LONG_BREAK||this.mode===d.BREAK}},{key:"reorderTasks",value:function(){}},{key:"getPomosLeftInSession",value:function(){var e=0;return this.allTasks.forEach((function(t){e+=Math.max(t.pomosRequired-t.pomosUsed,0)})),e}},{key:"parseSessionFromObj",value:function(e){return this.id=e.id,this.mode=e.mode,this.time=e.time,this.pomosElapsed=e.pomosElapsed,this.startDate=new Date(e.startDate),this.allTasks=e.allTasks.map((function(e){var t=new o.iQ;return t.parseTaskFromObj(e)})),this}},{key:"serializeIntoObj",value:function(){return{id:this.id,allTasks:this.allTasks.map((function(e){return e.serializeIntoObj()})),mode:this.mode,time:this.time,pomosElapsed:this.pomosElapsed,startDate:this.startDate.getTime()}}}])&&a(t.prototype,r),e}();function p(e){var t=(0,n.RK)(u),r=new m;return t[e]?r.parseSessionFromObj(t[e]):null}function f(e){var t=(0,n.RK)(u);t[e.id]=e.serializeIntoObj(),(0,n.RL)(u,t)}function h(){var e=parseInt(localStorage.getItem(l));return localStorage.setItem(l,e+1),e}function v(e){localStorage.setItem(c,e)}function y(){return"complete"===localStorage.getItem(c)?null:parseInt(localStorage.getItem(l))-1}function k(){var e=y();if(null===e)return!1;var t=p(e);return null!==t&&t.mode!==d.COMPLETE&&t.mode!==d.INACTIVE}},594:(e,t,r)=>{r.d(t,{iQ:()=>i,Rd:()=>a,oi:()=>l,rs:()=>c,c_:()=>u,zT:()=>d});var n=r(409),o=r(771);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(t,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionID=t,this.id=-1,this.title=r,this.description=n,this.pomosRequired=o,this.completed=!1,this.pomosUsed=0}var t,r;return t=e,(r=[{key:"parseTaskFromObj",value:function(t){var r=new e(t.sessionID,t.title,t.description,t.pomosRequired);return r.completed=t.completed,r.id=t.id,r.pomosUsed=t.pomosUsed,r}},{key:"serializeIntoObj",value:function(){return{title:this.title,description:this.description,pomosRequired:this.pomosRequired,completed:this.completed,pomosUsed:this.pomosUsed,id:this.id,sessionID:this.sessionID}}}])&&s(t.prototype,r),e}(),a="pomo_task_map",l="pomo_task_index";function c(e){var t=(0,n.RK)(a);if(!t[e.id]){var r=parseInt((0,n.RK)(l));e.id=r,(0,n.RL)(l,r+1)}var o=e.serializeIntoObj();return t[e.id]=o,(0,n.RL)(a,t),e.id}function u(e){var t=(0,n.RK)(a);delete t[e],(0,n.RL)(a,t)}function d(){var e=(0,o.RU)();if(null===e)return!1;var t=(0,o._c)(e);return null!==t&&null!==t.currentTask()}}},t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{function e(e){var t,r=e%60;t=r<10?"0"+r:r;var n=Math.floor(e/60);return(n<10?"0"+n:n)+":"+t}var t=r(409),n=r(771),o=r(594),s="day",i="night";function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=s;return e.getHours()<4?t=i:e.getHours()<18?t=s:e.getHours()<24&&(t=i),t}function l(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,s=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw s}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}window.addEventListener("DOMContentLoaded",(function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=0,r=6,n=e.getDay(),o=localStorage.getItem("bg-seed");null!==o&&o[0]==n||(o=n+"-"+Math.floor(Math.random()*r),localStorage.setItem("bg-seed",o));var s=a(e);t=parseInt(o[2]),document.getElementById("backdrop").style.backgroundImage='url("../assets/images/backgrounds/'.concat(s,"/bg").concat(t,'.jpg")')}();var r=new URLSearchParams(window.location.search),s=r.get("loadSaved"),i=document.getElementById("taskCreator"),c=document.getElementById("addTaskModal"),u=document.getElementById("taskList"),d=document.getElementById("startTimer"),m=document.getElementById("currentTask"),p=document.getElementById("taskList"),f=document.getElementById("timer-progress"),h=document.getElementById("distractedWrapper"),v=document.getElementById("completeSession"),y=document.getElementById("EndBreakEarlyWrapper");v.onclick=function(){g.mode=n.rA.COMPLETE,(0,n.E3)(g)};var k=1500;if((0,t.xN)(),"false"!=s||!(0,o.zT)()||confirm("By starting a new timer, you will lose any unfinished tasks from your previous session")){var g=null;if("true"==s){var T=(0,n.RU)();if(g=(0,n._c)(T),(0,n.hY)()&&g.mode!=n.rA.INACTIVE)O(),A();else{var E=(0,n.qc)();(0,n.yJ)("in-progress");var b=g.allTasks;b.forEach((function(e){e.sessionID=E,(0,o.rs)(e)})),(g=new n.Nt(E)).time=k,g.allTasks=b,(0,n.E3)(g),O()}}else if("false"==s){var I=(0,n.qc)();(0,n.yJ)("in-progress"),(g=new n.Nt(I)).time=k,(0,n.E3)(g),O()}r.set("loadSaved",!0),f.setDisplayText(e(g.time)),f.setPercentage(g.time/k),g.mode===n.rA.BREAK?(B(),f.setPercentage(g.time/300)):g.mode===n.rA.LONG_BREAK&&(B(),f.setPercentage(g.time/SVGFEColorMatrixElement)),y.onclick=function(){w(),g.time=k,g.mode=n.rA.ACTIVE},d.onclick=A,c.shadowRoot.getElementById("save-btn").addEventListener("click",(function(){var e,t,r,s=c.elements.values;if(null!=s){var i=(0,n.RU)(),a=new o.iQ(i,s.taskName,s.description,parseInt(s.pomosRequired));R(a),g.addTask(a),(0,n.E3)(g),e=c.shadowRoot.getElementById("task-name").elements.wrapper,t=c.shadowRoot.getElementById("pomos-required").elements.wrapper,r=c.shadowRoot.getElementById("description").elements.wrapper,e.innerText=e.placeholder,e.userTyped=void 0,e.setAttribute("class","pomo-input placeholder"),t.innerText=t.placeholder,t.userTyped=void 0,t.setAttribute("class","pomo-input placeholder"),r.innerText=r.placeholder,r.userTyped=void 0,r.setAttribute("class","pomo-input placeholder"),c.elements.values=void 0}})),i.onclick=function(){c.displayModal()}}else window.location="./index.html";function A(){m.setAttribute("class","currentTaskWorkTime"),f.setSize("1.5rem"),u.setAttribute("class","taskListWorkTime"),document.getElementById("timerWrapper").setAttribute("class","timerWrapperWorkTime"),h.style.display="block",document.getElementById("completeSessionWrapper").setAttribute("class","completeSessionWrapperWorkTime"),document.getElementById("taskCreatorWrapper").style.display="none",document.getElementById("currentTaskWrapper").style.display="block",S(),g.mode===n.rA.INACTIVE&&(g.mode=n.rA.ACTIVE,(0,n.E3)(g)),setInterval((function(){if((g=(0,n._c)(g.id)).time-=1,g.time<0&&(g.time=0),0==g.time)if(g.mode===n.rA.ACTIVE){B(),g.pomosElapsed+=1;var t=m.childNodes[0];t.incrementPomosUsed(),t.task.pomosUsed+=1,t.setAttribute("pomosused",1+parseInt(t.getAttribute("pomosused"))),g.pomosElapsed%4==0?(g.time=600,g.mode=n.rA.LONG_BREAK):(g.time=300,g.mode=n.rA.BREAK)}else g.mode!==n.rA.COMPLETE&&(w(),g.time=k,g.mode=n.rA.ACTIVE);document.title=e(g.time),f.setDisplayText(e(g.time)),g.mode===n.rA.ACTIVE?(f.setPercentage(g.time/k),document.title+=" - Work"):g.mode===n.rA.BREAK?(f.setPercentage(g.time/300),document.title+=" - Break"):g.mode===n.rA.LONG_BREAK&&(f.setPercentage(g.time/600),document.title+=" - Long Break"),(0,n.E3)(g)}),1e3);var t=m.childNodes[0];t.setFinishTaskCallback((function(){N(),S()}));var r=g.currentTask();t.task=r}function w(){document.getElementById("timer-status").innerText="Pomo Time",m.setAttribute("class","currentTaskWorkTime"),p.setAttribute("class","taskListWorkTime"),h.style.display="block",y.style.display="none",timerWrapper.setAttribute("class","timerWrapperWorkTime"),completeSessionWrapper.setAttribute("class","completeSessionWrapperWorkTime")}function B(){m.setAttribute("class","currentTaskBreakTime"),p.setAttribute("class","taskListBreakTime"),document.getElementById("timer-status").innerText="Break Time",y.style.display="block",h.style.display="none",timerWrapper.setAttribute("class","timerWrapperBreakTime"),completeSessionWrapper.setAttribute("class","completeSessionWrapperBreakTime")}function R(e){var t='<pomo-task description ="'.concat(e.description,'" pomosUsed="').concat(e.pomosUsed,'", pomosRequired ="').concat(e.pomosRequired,'">').concat(e.title,"</pomo-task>");u.insertAdjacentHTML("beforeend",t);var r=u.childNodes[u.childNodes.length-1];r.setFinishTaskCallback((function(){N()})),r.setDeleteTaskCallback((function(){C(e.id)})),r.task=e}function S(){p.childNodes[0];var e=g.getNextTask();if(null===e)return g.mode=n.rA.COMPLETE,(0,n.E3)(g),void(window.location="./history.html");var t='<pomo-task description="'.concat(e.description,'" pomosUsed="').concat(e.pomosUsed,'" pomosRequired=').concat(e.pomosRequired,">").concat(e.title,"</pomo-task>");m.insertAdjacentHTML("beforeend",t),p.removeChild(p.childNodes[0]);var r=m.childNodes[m.childNodes.length-1];r.setFinishTaskCallback((function(){N(),S()})),r.setDeleteTaskCallback((function(){C(e.id)})),r.task=e}function N(){var e,t=[],r=l(m.childNodes);try{var o=function(){var r=e.value;r.completed&&(t.push(r.task.id),r.hide(),setTimeout((function(){m.removeChild(r)}),200))};for(r.s();!(e=r.n()).done;)o()}catch(e){r.e(e)}finally{r.f()}var s,i=l(p.childNodes);try{var a=function(){var e=s.value;e.completed&&(t.push(e.task.id),e.hide(),setTimeout((function(){p.removeChild(e)}),200))};for(i.s();!(s=i.n()).done;)a()}catch(e){i.e(e)}finally{i.f()}t.forEach((function(e){g.completeTask(e)})),(0,n.E3)(g)}function C(e){var t=m.childNodes;if(t.length){var r=t[t.length-1].task;if(r.id===e&&confirm("Are you sure you want to delete this task?"))return g.deleteTask(r),m.removeChild(m.childNodes[t.length-1]),S(),void(0,n.E3)(g)}if(p.childNodes.length){var o,s=0,i=l(p.childNodes);try{for(i.s();!(o=i.n()).done;){var a=o.value.task;if(a.id===e&&confirm("Are you sure you want to delete this task?"))return g.deleteTask(a),p.removeChild(p.childNodes[s]),void(0,n.E3)(g);s++}}catch(e){i.e(e)}finally{i.f()}}}function O(){var e=(0,n.RU)(),t=[];if(null!==e){var r=g.allTasks;Object.values(r).forEach((function(r){console.log(r),r.sessionID!==e||r.completed||t.push(r)})),t.forEach((function(e){R(e)}))}var o,s=l(p.childNodes);try{for(s.s();!(o=s.n()).done;)o.value.setFinishTaskCallback((function(){N()}))}catch(e){s.e(e)}finally{s.f()}}}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jc2UxMTAtdzIxLWdyb3VwMjEvLi9zb3VyY2UvYXNzZXRzL3NjcmlwdHMvZGF0YWJhc2UvaW5kZXguanMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxLy4vc291cmNlL2Fzc2V0cy9zY3JpcHRzL2RhdGFiYXNlL3Nlc3Npb24uanMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxLy4vc291cmNlL2Fzc2V0cy9zY3JpcHRzL2RhdGFiYXNlL3Rhc2suanMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2NzZTExMC13MjEtZ3JvdXAyMS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxLy4vc291cmNlL2Fzc2V0cy9zY3JpcHRzL3V0aWxzL2Zvcm1hdC10aW1lLmpzIiwid2VicGFjazovL2NzZTExMC13MjEtZ3JvdXAyMS8uL3NvdXJjZS9hc3NldHMvc2NyaXB0cy91dGlscy90aGVtZS5qcyIsIndlYnBhY2s6Ly9jc2UxMTAtdzIxLWdyb3VwMjEvLi9zb3VyY2UvYXNzZXRzL3NjcmlwdHMvdGltZXIuanMiXSwibmFtZXMiOlsiaW5pdGlhbGl6ZURhdGFiYXNlIiwibmVlZFRvSW5pdGlhbGl6ZSIsImdldE9iamVjdCIsIlBPTU9fVEFTS19NQVAiLCJQT01PX1RBU0tfSU5ERVgiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiUE9NT19TRVNTSU9OX0lEIiwiTEFURVNUX1BPTU9fU0VTU0lPTl9TVEFUVVMiLCJQT01PX1NFU1NJT05fTUFQIiwic3RvcmVPYmplY3QiLCJrZXkiLCJvYmplY3QiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsInBhcnNlIiwiUE9NT19TRVNTSU9OX01PREVTIiwiSU5BQ1RJVkUiLCJCUkVBSyIsIkxPTkdfQlJFQUsiLCJBQ1RJVkUiLCJDT01QTEVURSIsIlBvbW9TZXNzaW9uIiwiaWQiLCJ0aGlzIiwiYWxsVGFza3MiLCJtb2RlIiwidGltZSIsInBvbW9zRWxhcHNlZCIsInN0YXJ0RGF0ZSIsIkRhdGUiLCJhbGxJblByb2dyZXNzVGFza3MiLCJmaWx0ZXIiLCJ0YXNrIiwiY29tcGxldGVkIiwibGVuZ3RoIiwic3RvcmVUYXNrIiwicHVzaCIsImRlbGV0ZVRhc2tCeVRhc2tJRCIsImkiLCJzdG9yZWRUYXNrIiwic3BsaWNlIiwicG9tb3NVc2VkIiwibGVmdCIsImZvckVhY2giLCJNYXRoIiwibWF4IiwicG9tb3NSZXF1aXJlZCIsInNlc3Npb25fb2JqIiwibWFwIiwidGFza09iaiIsInQiLCJUYXNrIiwicGFyc2VUYXNrRnJvbU9iaiIsInNlcmlhbGl6ZUludG9PYmoiLCJnZXRUaW1lIiwiZ2V0UG9tb1Nlc3Npb24iLCJhbGxTZXNzaW9ucyIsInAiLCJwYXJzZVNlc3Npb25Gcm9tT2JqIiwic3RvcmVQb21vU2Vzc2lvbiIsInNlc3Npb24iLCJnZXROZXdTZXNzaW9uSUQiLCJwcmV2SUQiLCJwYXJzZUludCIsInNldEN1cnJlbnRTZXNzaW9uU3RhdHVzIiwic3RhdHVzIiwiZ2V0TGF0ZXN0U2Vzc2lvbklEIiwidGhlcmVJc1VuZmluaXNoZWRTZXNzaW9uIiwic2Vzc2lvbklEIiwiY3VycmVudFBvbW9TZXNzaW9uIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInRhc2tfb2JqIiwidGFza19tYXAiLCJvYmoiLCJhcmVUaGVyZVVuZmluaXNoZWRUYXNrc0Zyb21MYXN0U2Vzc2lvbiIsIm9sZFNlc3Npb25JRCIsImN1cnJlbnRUYXNrIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkIiwiZGVmaW5pdGlvbiIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiZm9ybWF0VGltZSIsInNlY29uZHMiLCJzc3RyIiwicyIsIm0iLCJmbG9vciIsIlRIRU1FX01PREVTIiwiZ2V0VGhlbWVNb2RlIiwidG9kYXkiLCJ0aW1lUGVyaW9kIiwiZ2V0SG91cnMiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwibnVtQkdzIiwiZ2V0RGF5Iiwic2VlZCIsInJhbmRvbSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsInNlbGVjdEFuZFNldFRoZW1lIiwidXJsUGFyYW1zIiwiVVJMU2VhcmNoUGFyYW1zIiwibG9jYXRpb24iLCJzZWFyY2giLCJsb2FkU2F2ZWQiLCJhZGRUYXNrQnV0dG9uIiwibW9kYWwiLCJ0YXNrTGlzdCIsInN0YXJ0VGltZXJCdXR0b24iLCJjdXJyZW50VGFza0hUTUwiLCJ0YXNrTGlzdEhUTUwiLCJ0aW1lclByb2dyZXNzQ2lyY2xlIiwiZGlzdHJhY3RlZEJ1dHRvbiIsImNvbXBsZXRlU2Vzc2lvbkJ1dHRvbiIsIkVuZEJyZWFrRWFybHlCdXR0b24iLCJvbmNsaWNrIiwibWF4UG9tb1RpbWUiLCJjb25maXJtIiwibG9hZFRhc2tzIiwiaW5pdGlhdGVUaW1lciIsIm9sZFRhc2tzIiwic2V0Iiwic2V0RGlzcGxheVRleHQiLCJzZXRQZXJjZW50YWdlIiwicmVuZGVyQnJlYWtNb2RlIiwiU1ZHRkVDb2xvck1hdHJpeEVsZW1lbnQiLCJyZW5kZXJBY3RpdmVNb2RlIiwic2hhZG93Um9vdCIsInRhc2tOYW1lIiwidGFza1ZhbHVlcyIsImVsZW1lbnRzIiwidmFsdWVzIiwidW5kZWZpbmVkIiwibmV3VGFzayIsInJlbmRlclRhc2tJbnRvVGFza0xpc3QiLCJhZGRUYXNrIiwid3JhcHBlciIsImlubmVyVGV4dCIsInBsYWNlaG9sZGVyIiwidXNlclR5cGVkIiwic2V0QXR0cmlidXRlIiwiZGlzcGxheU1vZGFsIiwic2V0U2l6ZSIsImRpc3BsYXkiLCJzdGFydE5ld1Rhc2siLCJzZXRJbnRlcnZhbCIsImN1cnJlbnRUYXNrRmlyc3RDaGlsZCIsImNoaWxkTm9kZXMiLCJpbmNyZW1lbnRQb21vc1VzZWQiLCJnZXRBdHRyaWJ1dGUiLCJzZXRGaW5pc2hUYXNrQ2FsbGJhY2siLCJyZW1vdmVDb21wbGV0ZWRUYXNrcyIsInRpbWVyV3JhcHBlciIsImNvbXBsZXRlU2Vzc2lvbldyYXBwZXIiLCJjdXJyZW50VGFza0VsZW1lbnQiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJlbGVtZW50Iiwic2V0RGVsZXRlVGFza0NhbGxiYWNrIiwiZGVsZXRlVGFza0J5SWQiLCJuZXh0VGFzayIsImdldE5leHRUYXNrIiwiY3VycmVudFRhc2tUb0JlQWRkZWQiLCJyZW1vdmVDaGlsZCIsImNvbXBsZXRlZElkcyIsIm5vZGUiLCJoaWRlIiwic2V0VGltZW91dCIsImNvbXBsZXRlVGFzayIsImN1cnJlbnRUYXNrRWxlbWVudExpc3QiLCJkZWxldGVUYXNrIiwidGFza3MiLCJjb25zb2xlIiwibG9nIl0sIm1hcHBpbmdzIjoia0dBR08sU0FBU0EsSUFFWixJQUFJQyxHQUFtQixFQUNVLE9BQTdCQyxFQUFVQyxRQUNWRixHQUFtQixHQUVZLE9BQS9CQyxFQUFVRSxRQUNWSCxHQUFtQixHQUV3QixRQUExQ0ksYUFBYUMsUUFBUUMsUUFDdEJOLEdBQW1CLEdBRW1DLFFBQXJESSxhQUFhQyxRQUFRRSxRQUN0QlAsR0FBbUIsR0FFYSxPQUFoQ0MsRUFBVU8sUUFDVlIsR0FBbUIsR0FJbkJBLElBQ0FTLEVBQVlQLEtBQWUsSUFDM0JPLEVBQVlOLEtBQWlCLEdBQzdCTSxFQUFZRixLQUE0QixZQUN4Q0UsRUFBWUgsS0FBaUIsR0FDN0JHLEVBQVlELEtBQWtCLEtBVy9CLFNBQVNDLEVBQVlDLEVBQUtDLEdBQzdCUCxhQUFhUSxRQUFRRixFQUFLRyxLQUFLQyxVQUFVSCxJQUV0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LEdBQ2YsR0FBVyxPQUFQRixFQUFhLENBQ2IsSUFBSXFLLEVBQVF0SCxFQUFtQjdDLFNBQy9CK0QsT0FBTzZELE9BQU91QyxHQUFPaEosU0FBUSxTQUFDWCxHQUMxQjRKLFFBQVFDLElBQUk3SixHQUNSQSxFQUFLb0MsWUFBYzlDLEdBQU9VLEVBQUtDLFdBQy9CVCxFQUFTWSxLQUFLSixNQUd0QlIsRUFBU21CLFNBQVEsU0FBQ1gsR0FDZHVILEVBQXVCdkgsTUFaZCxVQWVBK0YsRUFBYXFDLFlBZmIsSUFlakIsMkJBQTBDLFFBQ2pDRyx1QkFBc0IsV0FDdkJDLE9BakJTLG9DIiwiZmlsZSI6InRpbWVyLmJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBPTU9fVEFTS19JTkRFWCwgUE9NT19UQVNLX01BUCB9IGZyb20gXCIuL3Rhc2tcIjtcbmltcG9ydCB7IFBPTU9fU0VTU0lPTl9JRCwgTEFURVNUX1BPTU9fU0VTU0lPTl9TVEFUVVMsIFBPTU9fU0VTU0lPTl9NQVAgfSBmcm9tIFwiLi9zZXNzaW9uXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXplRGF0YWJhc2UoKSB7XG4gICAgLy8gY2hlY2sgaWYgd2UgbmVlZCB0byBpbml0aWFsaXplXG4gICAgbGV0IG5lZWRUb0luaXRpYWxpemUgPSBmYWxzZTtcbiAgICBpZiAoZ2V0T2JqZWN0KFBPTU9fVEFTS19NQVApID09PSBudWxsKSB7XG4gICAgICAgIG5lZWRUb0luaXRpYWxpemUgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoZ2V0T2JqZWN0KFBPTU9fVEFTS19JTkRFWCkgPT09IG51bGwpIHtcbiAgICAgICAgbmVlZFRvSW5pdGlhbGl6ZSA9IHRydWU7XG4gICAgfVxuICAgIGlmICghbG9jYWxTdG9yYWdlLmdldEl0ZW0oUE9NT19TRVNTSU9OX0lEKSA9PT0gbnVsbCkge1xuICAgICAgICBuZWVkVG9Jbml0aWFsaXplID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKCFsb2NhbFN0b3JhZ2UuZ2V0SXRlbShMQVRFU1RfUE9NT19TRVNTSU9OX1NUQVRVUykgPT09IG51bGwpIHtcbiAgICAgICAgbmVlZFRvSW5pdGlhbGl6ZSA9IHRydWU7XG4gICAgfVxuICAgIGlmIChnZXRPYmplY3QoUE9NT19TRVNTSU9OX01BUCkgPT09IG51bGwpIHtcbiAgICAgICAgbmVlZFRvSW5pdGlhbGl6ZSA9IHRydWU7XG4gICAgfVxuXG4gICAgLy8gdGhlbiBpbml0aWFsaXplXG4gICAgaWYgKG5lZWRUb0luaXRpYWxpemUpIHtcbiAgICAgICAgc3RvcmVPYmplY3QoUE9NT19UQVNLX01BUCwge30pO1xuICAgICAgICBzdG9yZU9iamVjdChQT01PX1RBU0tfSU5ERVgsIDApO1xuICAgICAgICBzdG9yZU9iamVjdChMQVRFU1RfUE9NT19TRVNTSU9OX1NUQVRVUywgXCJjb21wbGV0ZVwiKTtcbiAgICAgICAgc3RvcmVPYmplY3QoUE9NT19TRVNTSU9OX0lELCAwKTtcbiAgICAgICAgc3RvcmVPYmplY3QoUE9NT19TRVNTSU9OX01BUCwge30pO1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiByZXNldERhdGFiYXNlKCkge1xuICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2VbUE9NT19UQVNLX01BUF07XG4gICAgZGVsZXRlIGxvY2FsU3RvcmFnZVtQT01PX1RBU0tfSU5ERVhdO1xuICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2VbTEFURVNUX1BPTU9fU0VTU0lPTl9TVEFUVVNdO1xuICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2VbUE9NT19TRVNTSU9OX0lEXTtcbiAgICBkZWxldGUgbG9jYWxTdG9yYWdlW1BPTU9fU0VTU0lPTl9NQVBdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3RvcmVPYmplY3Qoa2V5LCBvYmplY3QpIHtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KG9iamVjdCkpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldE9iamVjdChrZXkpIHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpKTtcbn0iLCIvKipcbiAqIFRoaXMgZmlsZSBpcyByZWxhdGVkIHRvIGZpbmRpbmcgcG9tbyBzZXNzaW9uc1xuICovXG5pbXBvcnQgeyBnZXRPYmplY3QsIHN0b3JlT2JqZWN0IH0gZnJvbSBcIi4vaW5kZXhcIjtcbmltcG9ydCB7IGRlbGV0ZVRhc2tCeVRhc2tJRCwgc3RvcmVUYXNrLCBUYXNrIH0gZnJvbSBcIi4vdGFza1wiO1xuXG5cbmV4cG9ydCBjb25zdCBQT01PX1NFU1NJT05fSUQgPSBcInBvbW9fc2Vzc2lvbl9pZFwiO1xuZXhwb3J0IGNvbnN0IExBVEVTVF9QT01PX1NFU1NJT05fU1RBVFVTID0gXCJsYXRlc3RfcG9tb19zZXNzaW9uX3N0YXR1c1wiO1xuZXhwb3J0IGNvbnN0IFBPTU9fU0VTU0lPTl9NQVAgPSBcInBvbW9fc2Vzc2lvbl9tYXBcIjtcblxuLyoqIHRoZSBkaWZmZXJlbnQgcG9tbyBzZXNzaW9uIG1vZGVzIGFzIGNvbnN0YW50cyAqL1xuZXhwb3J0IGNvbnN0IFBPTU9fU0VTU0lPTl9NT0RFUyA9IHtcbiAgLyoqIHdoZW4gdGhlIHVzZXIgaXMgaW4gdGhlIGludGVyZmFjZSBvZiBjcmVhdGluZyBhIG5ldyB0aW1lciBhbmQgaGFzIG5vdCBzdGFydGVkIHRoZWlyIG5ldyBzZXNzaW9uIHlldCAqL1xuICBJTkFDVElWRTogXCJpbmFjdGl2ZVwiLFxuICAvKiogd2hlbiBydW5uaW5nIHRoZSBicmVhayB0aW1lciAqL1xuICBCUkVBSzogXCJicmVha1wiLFxuICAvKiogd2hlbiBydW5uaW5nIHRoZSBsb25nZXIgYnJlYWsgdGltZXIgKi9cbiAgTE9OR19CUkVBSzogXCJsb25nYnJlYWtcIixcbiAgLyoqIHdoZW4gcnVubmluZyB0aGUgYWN0aXZlIHBvbW8gd29yayB0aW1lICovXG4gIEFDVElWRTogXCJhY3RpdmVcIixcbiAgLyoqIHdoZW4gdGhlIHVzZXIgbWFya3MgdGhpcyBwb21vIHNlc3Npb24gYXMgY29tcGxldGUsIHJlZ2FyZGxlc3Mgb2Ygd2hldGhlciB0YXNrcyBhcmUgY29tcGxldGVkIG9yIG5vdCAqL1xuICBDT01QTEVURTogXCJjb21wbGV0ZVwiLFxufTtcblxuZXhwb3J0IGNsYXNzIFBvbW9TZXNzaW9uIHtcbiAgLyoqXG4gICAqIENyZWF0ZSBhIG5ldyBQb21vIFNlc3Npb24gb2JqZWN0XG4gICAqIEBwYXJhbSB7bnVtYmVyfSBpZCAtIGlkIG9mIHRoaXMgc2Vzc2lvblxuICAgKi9cbiAgY29uc3RydWN0b3IoaWQpIHtcbiAgICB0aGlzLmlkID0gaWQ7XG4gICAgLyoqIEB0eXBlIHtUYXNrW119IC0gYSBsaXN0IG9mIGFsbCB0YXNrcyBhc3NvY2lhdGVkIHdpdGggdGhpcyBzZXNzaW9uICovXG4gICAgdGhpcy5hbGxUYXNrcyA9IFtdO1xuICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAtIHRoZSBjdXJyZW50IG1vZGUgb2YgdGhlIHBvbW8gc2Vzc2lvbiAqL1xuICAgIHRoaXMubW9kZSA9IFBPTU9fU0VTU0lPTl9NT0RFUy5JTkFDVElWRTtcbiAgICAvKiogQHR5cGUge051bWJlcn0gLSB0aGUgY3VycmVudCB0aW1lIG9mIHRoZSBwb21vIHNlc3Npb24gKi9cbiAgICB0aGlzLnRpbWUgPSAwO1xuXG4gICAgLyoqIEB0eXBlIHtOdW1iZXJ9IC0gbnVtYmVyIG9mIHBvbW9zIGVsYXBzZWQgc3VjY2VzZnVsbHkgZm9yIHRoaXMgcG9tbyBzZXNzaW9uICovXG4gICAgdGhpcy5wb21vc0VsYXBzZWQgPSAwO1xuXG4gICAgdGhpcy5zdGFydERhdGUgPSBuZXcgRGF0ZSgpO1xuICB9XG4gIC8qKlxuICAgKiBcbiAgICogQHJldHVybnMge1Rhc2sgfCBudWxsIH0gLSB0aGUgY3VycmVudCB0YXNrIGZvciB0aGlzIHBvbW8gc2Vzc2lvbiBvciBudWxsIGlmIHRoZXJlIGFyZSBubyB0YXNrcyBsZWZ0XG4gICAqL1xuICBjdXJyZW50VGFzaygpIHtcbiAgICBsZXQgYWxsSW5Qcm9ncmVzc1Rhc2tzID0gdGhpcy5hbGxUYXNrcy5maWx0ZXIoKHRhc2spID0+ICF0YXNrLmNvbXBsZXRlZCk7XG4gICAgaWYgKGFsbEluUHJvZ3Jlc3NUYXNrcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBhbGxJblByb2dyZXNzVGFza3NbMF07XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG4gIC8qKlxuICAgKiBBZGRzIGEgbmV3IHRhc2tcbiAgICogQHBhcmFtIHtUYXNrfSB0YXNrIFxuICAgKi9cbiAgYWRkVGFzayh0YXNrKSB7XG4gICAgc3RvcmVUYXNrKHRhc2spO1xuICAgIHRoaXMuYWxsVGFza3MucHVzaCh0YXNrKTtcbiAgfVxuICAvKipcbiAgICogRGVsZXRlIGEgdGFza1xuICAgKiBAcGFyYW0ge1Rhc2t9IHRhc2sgXG4gICAqL1xuICBkZWxldGVUYXNrKHRhc2spIHtcbiAgICBkZWxldGVUYXNrQnlUYXNrSUQodGFzay5pZCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmFsbFRhc2tzLmxlbmd0aDsgaSsrKXtcbiAgICAgIGNvbnN0IHN0b3JlZFRhc2sgPSB0aGlzLmFsbFRhc2tzW2ldO1xuICAgICAgaWYgKHRhc2suaWQgPT09IHN0b3JlZFRhc2suaWQpIHtcbiAgICAgICAgdGhpcy5hbGxUYXNrcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ29tcGxldGVzIHRoZSBnaXZlbiB0YXNrIGFzc29jaWF0ZWQgdG8gdGhlIGlkXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBpZCBcbiAgICogQHJldHVybnMge2Jvb2xlYW59IHRydWUgaWYgY29tcGxldGVkLCBmYWxzZSBpZiBubyB0YXNrIGZvdW5kXG4gICAqL1xuICBjb21wbGV0ZVRhc2soaWQpIHtcbiAgICBmb3IgKGxldCB0YXNrIG9mIHRoaXMuYWxsVGFza3MpIHtcbiAgICAgIGlmICh0YXNrLmlkID09PSBpZCkge1xuICAgICAgICB0YXNrLmNvbXBsZXRlZCA9IHRydWU7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIG5leHQgaW5jb21wbGV0ZSB0YXNrIGluIHRoZSBvcmRlciBvciBudWxsIGlmIGFsbCBjb21wbGV0ZWRcbiAgICogQHJldHVybnMge1Rhc2sgfCBudWxsfVxuICAgKi9cbiAgZ2V0TmV4dFRhc2soKSB7XG4gICAgZm9yIChjb25zdCB0YXNrIG9mIHRoaXMuYWxsVGFza3MpIHtcbiAgICAgIGlmICh0YXNrLmNvbXBsZXRlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuIHRhc2s7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG4gIC8qKlxuICAgKiBJbmNyZW1lbnQgdGhlIHBvbW9zIHVzZWQgZm9yIGEgdGFzayBhbmQgaW5jcmVtZW50IHBvbW9zRWxhcHNlZFxuICAgKiBAcGFyYW0ge251bWJlcn0gaWQgXG4gICAqL1xuICBpbmNyZW1lbnRUYXNrUG9tb3NVc2VkKGlkKSB7XG4gICAgZm9yIChjb25zdCB0YXNrIG9mIHRoaXMuYWxsVGFza3MpIHtcbiAgICAgIGlmICh0YXNrLmlkID09PSBpZCkge1xuICAgICAgICB0YXNrLnBvbW9zVXNlZCArPSAxO1xuICAgICAgICB0aGlzLnBvbW9zRWxhcHNlZCArPSAxO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFxuICAgKiBAcmV0dXJucyB0cnVlIGlmIHNlc3Npb24gaXMgaW4gYnJlYWsgbW9kZSByaWdodCBub3csIGZhbHNlIG90aGVyd2lzZVxuICAgKi9cbiAgaXNCcmVhaygpIHtcbiAgICByZXR1cm4gdGhpcy5tb2RlID09PSBQT01PX1NFU1NJT05fTU9ERVMuTE9OR19CUkVBSyB8fCB0aGlzLm1vZGUgPT09IFBPTU9fU0VTU0lPTl9NT0RFUy5CUkVBSztcbiAgfVxuXG4gIC8qKlxuICAgKiBUT0RPXG4gICAqL1xuICByZW9yZGVyVGFza3MoKSB7XG5cbiAgfVxuXG4gIGdldFBvbW9zTGVmdEluU2Vzc2lvbigpIHtcbiAgICBsZXQgbGVmdCA9IDA7XG4gICAgdGhpcy5hbGxUYXNrcy5mb3JFYWNoKCh0YXNrKSA9PiB7XG4gICAgICBsZWZ0ICs9IE1hdGgubWF4KHRhc2sucG9tb3NSZXF1aXJlZCAtIHRhc2sucG9tb3NVc2VkLCAwKTtcbiAgICB9KTtcbiAgICByZXR1cm4gbGVmdDtcbiAgfVxuICBwYXJzZVNlc3Npb25Gcm9tT2JqKHNlc3Npb25fb2JqKSB7XG4gICAgdGhpcy5pZCA9IHNlc3Npb25fb2JqLmlkO1xuICAgIHRoaXMubW9kZSA9IHNlc3Npb25fb2JqLm1vZGU7XG4gICAgdGhpcy50aW1lID0gc2Vzc2lvbl9vYmoudGltZTtcbiAgICB0aGlzLnBvbW9zRWxhcHNlZCA9IHNlc3Npb25fb2JqLnBvbW9zRWxhcHNlZDtcbiAgICB0aGlzLnN0YXJ0RGF0ZSA9IG5ldyBEYXRlKHNlc3Npb25fb2JqLnN0YXJ0RGF0ZSk7XG4gICAgdGhpcy5hbGxUYXNrcyA9IHNlc3Npb25fb2JqLmFsbFRhc2tzLm1hcCgodGFza09iaikgPT4ge1xuICAgICAgbGV0IHQgPSBuZXcgVGFzaygpO1xuICAgICAgdCA9IHQucGFyc2VUYXNrRnJvbU9iaih0YXNrT2JqKTtcbiAgICAgIHJldHVybiB0O1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIHNlcmlhbGl6ZUludG9PYmooKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiB0aGlzLmlkLCBhbGxUYXNrczogdGhpcy5hbGxUYXNrcy5tYXAoKHRhc2spID0+IHRhc2suc2VyaWFsaXplSW50b09iaigpKSwgbW9kZTogdGhpcy5tb2RlLCB0aW1lOiB0aGlzLnRpbWUsIHBvbW9zRWxhcHNlZDogdGhpcy5wb21vc0VsYXBzZWQsIHN0YXJ0RGF0ZTogdGhpcy5zdGFydERhdGUuZ2V0VGltZSgpXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBhIHBvbW8gc2Vzc2lvbiBvYmplY3RcbiAqIEBwYXJhbSB7bnVtYmVyfSBpZCBcbiAqIEByZXR1cm5zIHtQb21vU2Vzc2lvbiB8IG51bGx9IHRoZSBzZXNzaW9uIGZvciB0aGlzIGlkIG9yIG51bGwgaWYgdGhlcmUgaXMgbm8gc2Vzc2lvbiBhc3NvY2lhdGVkIHdpdGggdGhpcyBpZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UG9tb1Nlc3Npb24oaWQpIHtcbiAgY29uc3QgYWxsU2Vzc2lvbnMgPSBnZXRPYmplY3QoUE9NT19TRVNTSU9OX01BUCk7XG4gIGxldCBwID0gbmV3IFBvbW9TZXNzaW9uKCk7XG4gIGlmICghYWxsU2Vzc2lvbnNbaWRdKSByZXR1cm4gbnVsbDtcbiAgcmV0dXJuIHAucGFyc2VTZXNzaW9uRnJvbU9iaihhbGxTZXNzaW9uc1tpZF0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3RvcmVQb21vU2Vzc2lvbihzZXNzaW9uKSB7XG4gIGNvbnN0IGFsbFNlc3Npb25zID0gZ2V0T2JqZWN0KFBPTU9fU0VTU0lPTl9NQVApO1xuICBhbGxTZXNzaW9uc1tzZXNzaW9uLmlkXSA9IHNlc3Npb24uc2VyaWFsaXplSW50b09iaigpO1xuICBzdG9yZU9iamVjdChQT01PX1NFU1NJT05fTUFQLCBhbGxTZXNzaW9ucyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXROZXdTZXNzaW9uSUQoKSB7XG4gIGxldCBwcmV2SUQgPSBwYXJzZUludChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShQT01PX1NFU1NJT05fSUQpKTtcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oUE9NT19TRVNTSU9OX0lELCBwcmV2SUQgKyAxKTtcbiAgcmV0dXJuIHByZXZJRDtcbn1cblxuLyoqXG4gKiBTZXQgdGhlIGN1cnJlbnQgc2Vzc2lvbidzIHN0YXR1c1xuICogQHBhcmFtIHtzdHJpbmd9IHN0YXR1cyAtIGNhbiBiZSBcImNvbXBsZXRlXCIgb3IgXCJpbi1wcm9ncmVzc1wiXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRDdXJyZW50U2Vzc2lvblN0YXR1cyhzdGF0dXMpIHtcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oTEFURVNUX1BPTU9fU0VTU0lPTl9TVEFUVVMsIHN0YXR1cyk7XG59XG5cbi8qKlxuICogV2lsbCByZXR1cm4gdGhlIHNlc3Npb24gSUQgb2YgdGhlIGxhc3Qgc2Vzc2lvbiBpZiBpdCB3YXMgbm90IGVuZGVkLiBPdGhlcndpc2UgaWYgdGhlIGxhc3Qgc2Vzc2lvbiBkb2VzIG5vdCBleGlzdCBcbiAqIG9yIHdhcyBlbmRlZCBhbHJlYWR5LCB0aGlzIGZ1bmN0aW9uIHJldHVybnMgbnVsbFxuICogXG4gKiBAcmV0dXJucyB7bnVtYmVyIHwgbnVsbH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldExhdGVzdFNlc3Npb25JRCgpIHtcbiAgbGV0IHN0YXR1cyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKExBVEVTVF9QT01PX1NFU1NJT05fU1RBVFVTKTtcbiAgaWYgKHN0YXR1cyA9PT0gXCJjb21wbGV0ZVwiKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHBhcnNlSW50KGxvY2FsU3RvcmFnZS5nZXRJdGVtKFBPTU9fU0VTU0lPTl9JRCkpIC0gMTtcbiAgfVxufVxuXG4vKipcbiAqIEByZXR1cm5zIHtib29sZWFufSAtIHRydWUgaWYgdGhlcmUgaXMgYSB1bmZpbmlzaGVkIHNlc3Npb24gdGhhdCB3YXMgbm90IGNvbXBsZXRlZCBvciBxdWl0dGVkLiBmYWxzZSBvdGhlcndpc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRoZXJlSXNVbmZpbmlzaGVkU2Vzc2lvbigpIHtcbiAgbGV0IHNlc3Npb25JRCA9IGdldExhdGVzdFNlc3Npb25JRCgpO1xuICBpZiAoc2Vzc2lvbklEID09PSBudWxsKSByZXR1cm4gZmFsc2U7XG4gIGxldCBjdXJyZW50UG9tb1Nlc3Npb24gPSBnZXRQb21vU2Vzc2lvbihzZXNzaW9uSUQpO1xuICBpZiAoY3VycmVudFBvbW9TZXNzaW9uICE9PSBudWxsICYmIGN1cnJlbnRQb21vU2Vzc2lvbi5tb2RlICE9PSBQT01PX1NFU1NJT05fTU9ERVMuQ09NUExFVEUgJiYgY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgIT09IFBPTU9fU0VTU0lPTl9NT0RFUy5JTkFDVElWRSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnRpbnVlQWN0aXZlU2Vzc2lvbigpIHtcbiAgaWYgKHRoZXJlSXNVbmZpbmlzaGVkU2Vzc2lvbigpKSB7XG4gICAgd2luZG93LmxvY2F0aW9uID0gXCIvdGltZXIuaHRtbD9sb2FkU2F2ZWQ9dHJ1ZVwiO1xuICB9XG59IiwiaW1wb3J0IHsgZ2V0T2JqZWN0LCBzdG9yZU9iamVjdCB9IGZyb20gXCIuXCI7XG5pbXBvcnQgeyBnZXRMYXRlc3RTZXNzaW9uSUQsIGdldFBvbW9TZXNzaW9uIH0gZnJvbSBcIi4vc2Vzc2lvblwiO1xuXG5leHBvcnQgY2xhc3MgVGFzayB7XG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNlc3Npb25JRCBcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGl0bGUgXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRlc2NyaXB0aW9uIFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBwb21vc1JlcXVpcmVkIFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNlc3Npb25JRCwgdGl0bGUsIGRlc2NyaXB0aW9uLCBwb21vc1JlcXVpcmVkKSB7XG4gICAgICAgIHRoaXMuc2Vzc2lvbklEID0gc2Vzc2lvbklEO1xuICAgICAgICB0aGlzLmlkID0gLTE7XG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgICB0aGlzLnBvbW9zUmVxdWlyZWQgPSBwb21vc1JlcXVpcmVkO1xuICAgICAgICB0aGlzLmNvbXBsZXRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnBvbW9zVXNlZCA9IDA7XG4gICAgfVxuICAgIHBhcnNlVGFza0Zyb21PYmoodGFza19vYmopIHtcbiAgICAgICAgbGV0IHRhc2sgPSBuZXcgVGFzayh0YXNrX29iai5zZXNzaW9uSUQsIHRhc2tfb2JqLnRpdGxlLCB0YXNrX29iai5kZXNjcmlwdGlvbiwgdGFza19vYmoucG9tb3NSZXF1aXJlZCk7XG4gICAgICAgIHRhc2suY29tcGxldGVkID0gdGFza19vYmouY29tcGxldGVkO1xuICAgICAgICB0YXNrLmlkID0gdGFza19vYmouaWQ7XG4gICAgICAgIHRhc2sucG9tb3NVc2VkID0gdGFza19vYmoucG9tb3NVc2VkO1xuICAgICAgICByZXR1cm4gdGFzaztcbiAgICB9XG4gICAgc2VyaWFsaXplSW50b09iaigpIHtcbiAgICAgICAgcmV0dXJuIHsgdGl0bGU6IHRoaXMudGl0bGUsIGRlc2NyaXB0aW9uOiB0aGlzLmRlc2NyaXB0aW9uLCBwb21vc1JlcXVpcmVkOiB0aGlzLnBvbW9zUmVxdWlyZWQsIGNvbXBsZXRlZDogdGhpcy5jb21wbGV0ZWQsIHBvbW9zVXNlZDogdGhpcy5wb21vc1VzZWQsIGlkOiB0aGlzLmlkLCBzZXNzaW9uSUQ6IHRoaXMuc2Vzc2lvbklEIH07XG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgUE9NT19UQVNLX01BUCA9IFwicG9tb190YXNrX21hcFwiO1xuZXhwb3J0IGNvbnN0IFBPTU9fVEFTS19JTkRFWCA9IFwicG9tb190YXNrX2luZGV4XCI7XG5cbi8qKlxuICogV2lsbCBzdG9yZSBhIG5ldyBvciB1cGRhdGVkIHRhc2sgaW50byBsb2NhbCBzdG9yYWdlXG4gKiBcbiAqIEhhcyBhIHNpZGUgZWZmZWN0IG9mIGFkZGluZyB0aGUgaWQgb2YgdGhlIG5ldyB0YXNrIGlmIGl0IHdhc250IHN0b3JlZCBpbiBzdG9yYWdlIGJlZm9yZVxuICogXG4gKiBAcGFyYW0ge1Rhc2t9IHRhc2tcbiAqIEByZXR1cm5zIHtudW1iZXJ9IC0gdGhlIGlkIG9mIHRoZSB0YXNrXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdG9yZVRhc2sodGFzaykge1xuICAgIGxldCB0YXNrX21hcCA9IGdldE9iamVjdChQT01PX1RBU0tfTUFQKTtcbiAgICBpZiAoIXRhc2tfbWFwW3Rhc2suaWRdKSB7XG4gICAgICAgIC8vIGlmIHRhc2sgbWFwIGRvZXMgbm90IGhhdmUgdGhpcyB0YXNrLCBjcmVhdGUgYSBuZXcgaW5kZXhcbiAgICAgICAgbGV0IGlkID0gcGFyc2VJbnQoZ2V0T2JqZWN0KFBPTU9fVEFTS19JTkRFWCkpO1xuICAgICAgICB0YXNrLmlkID0gaWQ7XG4gICAgICAgIC8vIGluY3JlbWVudCBnbG9iYWwgaWRcbiAgICAgICAgc3RvcmVPYmplY3QoUE9NT19UQVNLX0lOREVYLCBpZCArIDEpO1xuICAgIH1cbiAgICBsZXQgb2JqID0gdGFzay5zZXJpYWxpemVJbnRvT2JqKCk7XG4gICAgdGFza19tYXBbdGFzay5pZF0gPSBvYmo7XG4gICAgc3RvcmVPYmplY3QoUE9NT19UQVNLX01BUCwgdGFza19tYXApO1xuICAgIHJldHVybiB0YXNrLmlkO1xufVxuXG4vKipcbiAqIEdldCB0aGUgdGFzayBhc3NvY2lhdGVkIHdpdGggdGhpcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IGlkIFxuICogQHJldHVybnMge1Rhc2t9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRUYXNrKGlkKSB7XG4gICAgbGV0IHRhc2tfbWFwID0gZ2V0T2JqZWN0KFBPTU9fVEFTS19NQVApO1xuICAgIGxldCB0YXNrX29iaiA9IHRhc2tfbWFwW2lkXTtcbiAgICBsZXQgdCA9IG5ldyBUYXNrKCk7XG4gICAgdCA9IHQucGFyc2VUYXNrRnJvbU9iaih0YXNrX29iaik7XG4gICAgcmV0dXJuIHQ7XG5cbn1cbi8qKlxuICogR2V0IGFsbCB0YXNrc1xuICogXG4gKiBAcmV0dXJucyB7TWFwPG51bWJlciwgVGFzaz59IC0gYSBtYXAgZnJvbSB0YXNrIGlkIHRvIHRhc2tcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEFsbFRhc2tzKCkge1xuICAgIGxldCB0YXNrX21hcCA9IGdldE9iamVjdChQT01PX1RBU0tfTUFQKTtcbiAgICBsZXQgcGFyc2VkX3Rhc2tfbWFwID0ge307XG4gICAgZm9yIChsZXQgaWQgaW4gdGFza19tYXApIHtcbiAgICAgICAgbGV0IHRhc2tfb2JqID0gdGFza19tYXBbaWRdO1xuICAgICAgICBsZXQgdCA9IG5ldyBUYXNrKCk7XG4gICAgICAgIHQgPSB0LnBhcnNlVGFza0Zyb21PYmoodGFza19vYmopO1xuICAgICAgICBwYXJzZWRfdGFza19tYXBbaWRdID0gdDtcbiAgICB9XG4gICAgcmV0dXJuIHBhcnNlZF90YXNrX21hcDtcbn1cblxuLyoqXG4gKiBEZWxldGUgYSBzcGVjaWZpYyB0YXNrIGZyb20gZGF0YWJhc2UgYnkgdGhlIHVuaXF1ZSB0YXNrIElEXG4gKiBcbiAqIEBwYXJhbSB7bnVtYmVyfSBpZCBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZVRhc2tCeVRhc2tJRChpZCkge1xuICAgIGxldCB0YXNrX21hcCA9IGdldE9iamVjdChQT01PX1RBU0tfTUFQKTtcbiAgICBkZWxldGUgdGFza19tYXBbaWRdO1xuICAgIHN0b3JlT2JqZWN0KFBPTU9fVEFTS19NQVAsIHRhc2tfbWFwKTtcbn1cblxuXG4vKipcbiAqIENoZWNrcyBpZiB0aGVyZSBhcmUgYW55IHVuZmluaXNoZWQgdGFza3MgZnJvbSB0aGUgcHJldmlvdXMgc2Vzc2lvblxuICogQHJldHVybnMge2Jvb2xlYW59IC0gdHJ1ZSBpZiB1bmlmaW5pc2hlZCB0YXNrcyBleGlzdCwgZmFsc2Ugb3RoZXJ3aXNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhcmVUaGVyZVVuZmluaXNoZWRUYXNrc0Zyb21MYXN0U2Vzc2lvbigpIHtcbiAgICBsZXQgb2xkU2Vzc2lvbklEID0gZ2V0TGF0ZXN0U2Vzc2lvbklEKCk7XG4gICAgaWYgKG9sZFNlc3Npb25JRCA9PT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICAgIGxldCBzZXNzaW9uID0gZ2V0UG9tb1Nlc3Npb24ob2xkU2Vzc2lvbklEKTtcbiAgICBpZiAoc2Vzc2lvbiA9PT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChzZXNzaW9uLmN1cnJlbnRUYXNrKCkgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdGlmKF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0pIHtcblx0XHRyZXR1cm4gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8qKlxuICogVGFrZXMgYSBudW1iZXIgb2Ygc2Vjb25kcyBhbmQgZm9ybWF0cyBpdCBpbnRvIGEgTU06U1MgZm9ybWF0XG4gKiBAcGFyYW0ge251bWJlcn0gc2Vjb25kcyBcbiAqIEByZXR1cm5zIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRUaW1lKHNlY29uZHMpIHtcbiAgbGV0IHMgPSBzZWNvbmRzICUgNjA7XG4gIGxldCBzc3RyID0gXCJcIjtcbiAgaWYgKHMgPCAxMCkge1xuICAgIHNzdHIgPSBcIjBcIiArIHM7XG4gIH0gZWxzZSB7XG4gICAgc3N0ciA9IHM7XG4gIH1cbiAgbGV0IG0gPSBNYXRoLmZsb29yKHNlY29uZHMgLyA2MCk7XG4gIGxldCBtc3RyID0gXCJcIjtcbiAgaWYgKG0gPCAxMCkge1xuICAgIG1zdHIgPSBcIjBcIiArIG07XG4gIH0gZWxzZSB7XG4gICAgbXN0ciA9IG07XG4gIH1cbiAgcmV0dXJuIG1zdHIgKyBcIjpcIiArIHNzdHI7XG59IiwiLyoqXG4gKiBXaWxsIHJhbmRvbWx5IHBpY2sgYSB0aGVtZSBhbmQgdW5pcXVlIGJhY2tncm91bmQgZGVwZW5kaW5nIG9uIHdoYXQgZGF5IGl0IGlzIGFuZCB3aGF0IHRpbWUgaXQgaXMgYW5kIHNldCBpdCBvbiB0aGUgcGFnZVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2VsZWN0QW5kU2V0VGhlbWUodG9kYXkgPSBuZXcgRGF0ZSgpKSB7XG4gIGxldCBpZCA9IDA7XG4gIGxldCBudW1CR3MgPSA2O1xuXG4gIGxldCBkID0gdG9kYXkuZ2V0RGF5KCk7XG5cbiAgbGV0IHNlZWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImJnLXNlZWRcIik7XG5cbiAgaWYgKHNlZWQgPT09IG51bGwgfHwgc2VlZFswXSAhPSBkKSB7XG4gICAgc2VlZCA9IGQgKyBcIi1cIiArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG51bUJHcyk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJiZy1zZWVkXCIsIHNlZWQpO1xuICB9XG4gIGxldCB0aW1lUGVyaW9kID0gZ2V0VGhlbWVNb2RlKHRvZGF5KTtcbiAgaWQgPSBwYXJzZUludChzZWVkWzJdKTtcblxuICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmFja2Ryb3BcIik7XG4gIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybChcIi4uL2Fzc2V0cy9pbWFnZXMvYmFja2dyb3VuZHMvJHt0aW1lUGVyaW9kfS9iZyR7aWR9LmpwZ1wiKWA7XG59O1xuXG5leHBvcnQgY29uc3QgVEhFTUVfTU9ERVMgPSB7XG4gIERBWTogXCJkYXlcIixcbiAgTklHSFQ6IFwibmlnaHRcIixcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUaGVtZU1vZGUodG9kYXkgPSBuZXcgRGF0ZSgpKSB7XG4gIGxldCB0aW1lUGVyaW9kID0gVEhFTUVfTU9ERVMuREFZO1xuICBpZiAodG9kYXkuZ2V0SG91cnMoKSA8IDQpIHtcbiAgICB0aW1lUGVyaW9kID0gVEhFTUVfTU9ERVMuTklHSFQ7XG4gIH1cbiAgZWxzZSBpZiAodG9kYXkuZ2V0SG91cnMoKSA8IDE4KSB7XG4gICAgdGltZVBlcmlvZCA9IFRIRU1FX01PREVTLkRBWTtcbiAgfSBlbHNlIGlmICh0b2RheS5nZXRIb3VycygpIDwgMjQpIHtcbiAgICB0aW1lUGVyaW9kID0gVEhFTUVfTU9ERVMuTklHSFQ7XG4gIH1cbiAgcmV0dXJuIHRpbWVQZXJpb2Q7XG59IiwiaW1wb3J0IHsgZm9ybWF0VGltZSB9IGZyb20gXCIuL3V0aWxzL2Zvcm1hdC10aW1lXCI7XG5pbXBvcnQgeyBpbml0aWFsaXplRGF0YWJhc2UgfSBmcm9tIFwiLi9kYXRhYmFzZVwiO1xuaW1wb3J0IHsgZ2V0TGF0ZXN0U2Vzc2lvbklELCBnZXROZXdTZXNzaW9uSUQsIGdldFBvbW9TZXNzaW9uLCBQb21vU2Vzc2lvbiwgUE9NT19TRVNTSU9OX01PREVTLCBzZXRDdXJyZW50U2Vzc2lvblN0YXR1cywgc3RvcmVQb21vU2Vzc2lvbiwgdGhlcmVJc1VuZmluaXNoZWRTZXNzaW9uIH0gZnJvbSBcIi4vZGF0YWJhc2Uvc2Vzc2lvblwiO1xuaW1wb3J0IHsgYXJlVGhlcmVVbmZpbmlzaGVkVGFza3NGcm9tTGFzdFNlc3Npb24sIHN0b3JlVGFza30gZnJvbSBcIi4vZGF0YWJhc2UvdGFza1wiO1xuaW1wb3J0IHsgVGFzayB9IGZyb20gXCIuL2RhdGFiYXNlL3Rhc2tcIjtcbmltcG9ydCB7IHNlbGVjdEFuZFNldFRoZW1lIH0gZnJvbSBcIi4vdXRpbHMvdGhlbWVcIjtcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XG4gICAgc2VsZWN0QW5kU2V0VGhlbWUoKTtcbiAgICBcbiAgICBjb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuICAgIGNvbnN0IGxvYWRTYXZlZCA9IHVybFBhcmFtcy5nZXQoXCJsb2FkU2F2ZWRcIik7XG5cbiAgICBsZXQgYWRkVGFza0J1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGFza0NyZWF0b3JcIik7XG4gICAgbGV0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGRUYXNrTW9kYWxcIik7XG4gICAgbGV0IHRhc2tMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0YXNrTGlzdFwiKTtcbiAgICBsZXQgc3RhcnRUaW1lckJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RhcnRUaW1lclwiKTtcbiAgICBsZXQgY3VycmVudFRhc2tIVE1MID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjdXJyZW50VGFza1wiKTtcbiAgICBsZXQgdGFza0xpc3RIVE1MID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0YXNrTGlzdFwiKTtcbiAgICBsZXQgdGltZXJQcm9ncmVzc0NpcmNsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGltZXItcHJvZ3Jlc3NcIik7XG4gICAgbGV0IGRpc3RyYWN0ZWRCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRpc3RyYWN0ZWRXcmFwcGVyXCIpO1xuICAgIGxldCBjb21wbGV0ZVNlc3Npb25CdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbXBsZXRlU2Vzc2lvblwiKTtcbiAgICBsZXQgRW5kQnJlYWtFYXJseUJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiRW5kQnJlYWtFYXJseVdyYXBwZXJcIik7XG5cbiAgICBjb21wbGV0ZVNlc3Npb25CdXR0b24ub25jbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgPSBQT01PX1NFU1NJT05fTU9ERVMuQ09NUExFVEU7XG4gICAgICAgIHN0b3JlUG9tb1Nlc3Npb24oY3VycmVudFBvbW9TZXNzaW9uKTtcbiAgICB9O1xuXG4gICAgLy8gVE9ETzogbW92ZSB0aGlzIHRpbWUgdmFyaWFibGUgaW50byB0aGUgcG9tbyBzZXNzaW9uIG9iamVjdCBjbGFzcyB1c2luZyBsb2NhbHN0b3JhZ2VcbiAgICBsZXQgbWF4UG9tb1RpbWUgPSAyNSAqIDYwO1xuICAgIGxldCBtYXhCcmVha1RpbWUgPSA1ICogNjA7XG4gICAgbGV0IG1heExvbmdCcmVha1RpbWUgPSAxMCAqIDYwO1xuXG4gICAgXG4gICAgaW5pdGlhbGl6ZURhdGFiYXNlKCk7XG4gICAgaWYgKGxvYWRTYXZlZCA9PSBcImZhbHNlXCIpIHtcbiAgICAgICAgbGV0IG9sZFRhc2tzTGVmdCA9IGFyZVRoZXJlVW5maW5pc2hlZFRhc2tzRnJvbUxhc3RTZXNzaW9uKCk7XG4gICAgICAgIGlmIChvbGRUYXNrc0xlZnQpIHtcbiAgICAgICAgICAgIGxldCBjb25maXJtZWQgPSBjb25maXJtKFwiQnkgc3RhcnRpbmcgYSBuZXcgdGltZXIsIHlvdSB3aWxsIGxvc2UgYW55IHVuZmluaXNoZWQgdGFza3MgZnJvbSB5b3VyIHByZXZpb3VzIHNlc3Npb25cIik7XG4gICAgICAgICAgICBpZiAoIWNvbmZpcm1lZCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IFwiLi9pbmRleC5odG1sXCI7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgXG5cbiAgICAvKiogQHR5cGUge1BvbW9TZXNzaW9ufSAqL1xuICAgIGxldCBjdXJyZW50UG9tb1Nlc3Npb24gPSBudWxsO1xuXG4gICAgLy8gVXNlIGxlZnRvdmVyIHRhc2tzIGFuZCByZW5kZXIgdGhlbVxuICAgIGlmIChsb2FkU2F2ZWQgPT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgbGV0IHNlc3Npb25JRCA9IGdldExhdGVzdFNlc3Npb25JRCgpO1xuICAgICAgICBjdXJyZW50UG9tb1Nlc3Npb24gPSBnZXRQb21vU2Vzc2lvbihzZXNzaW9uSUQpO1xuXG4gICAgICAgIGlmICh0aGVyZUlzVW5maW5pc2hlZFNlc3Npb24oKSAmJiBjdXJyZW50UG9tb1Nlc3Npb24ubW9kZSAhPSBQT01PX1NFU1NJT05fTU9ERVMuSU5BQ1RJVkUpIHtcbiAgICAgICAgICAgIGxvYWRUYXNrcygpO1xuICAgICAgICAgICAgaW5pdGlhdGVUaW1lcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gY3JlYXRlIG5ldyBzZXNzaW9uIGFuZCB1c2Ugb2xkIHRhc2tzIGZyb20gbGFzdCB0aW1lXG4gICAgICAgICAgICBsZXQgc2Vzc2lvbklEID0gZ2V0TmV3U2Vzc2lvbklEKCk7XG4gICAgICAgICAgICBzZXRDdXJyZW50U2Vzc2lvblN0YXR1cyhcImluLXByb2dyZXNzXCIpO1xuXG4gICAgICAgICAgICAvLyB0YWtlIHRoZSBvbGQgdGFza3MgYW5kIHVwZGF0ZSB0aGUgc2Vzc2lvbiBpZHMgdG8gdGhlIG5ldyBvbmVcbiAgICAgICAgICAgIGxldCBvbGRUYXNrcyA9IGN1cnJlbnRQb21vU2Vzc2lvbi5hbGxUYXNrcztcbiAgICAgICAgICAgIG9sZFRhc2tzLmZvckVhY2goKHRhc2spID0+IHtcbiAgICAgICAgICAgICAgICB0YXNrLnNlc3Npb25JRCA9IHNlc3Npb25JRDtcbiAgICAgICAgICAgICAgICBzdG9yZVRhc2sodGFzayk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uID0gbmV3IFBvbW9TZXNzaW9uKHNlc3Npb25JRCk7XG5cbiAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lID0gbWF4UG9tb1RpbWU7XG4gICAgICAgICAgICBjdXJyZW50UG9tb1Nlc3Npb24uYWxsVGFza3MgPSBvbGRUYXNrcztcbiAgICAgICAgICAgIC8vIHNhdmUgb3VyIG5ldyBwb21vIHNlc3Npb25cbiAgICAgICAgICAgIHN0b3JlUG9tb1Nlc3Npb24oY3VycmVudFBvbW9TZXNzaW9uKTtcbiAgICAgICAgICAgIGxvYWRUYXNrcygpO1xuICAgICAgICB9XG4gICAgXG4gICAgfVxuICAgIGVsc2UgaWYgKGxvYWRTYXZlZCA9PSBcImZhbHNlXCIpIHtcbiAgICAgICAgLy8gbm90ZSwgaWYgeW91IHJlZnJlc2ggZm9yIG5vdywgeW91IHdpbGwgbG9zZSB5b3VyIHNlc3Npb24ncyBjaGFuZ2VzLi4uXG4gICAgICAgIGxldCBzZXNzaW9uSUQgPSBnZXROZXdTZXNzaW9uSUQoKTtcbiAgICAgICAgc2V0Q3VycmVudFNlc3Npb25TdGF0dXMoXCJpbi1wcm9ncmVzc1wiKTtcblxuICAgICAgICBjdXJyZW50UG9tb1Nlc3Npb24gPSBuZXcgUG9tb1Nlc3Npb24oc2Vzc2lvbklEKTtcbiAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLnRpbWUgPSBtYXhQb21vVGltZTtcbiAgICAgICAgLy8gc2F2ZSBvdXIgbmV3IHBvbW8gc2Vzc2lvblxuICAgICAgICBzdG9yZVBvbW9TZXNzaW9uKGN1cnJlbnRQb21vU2Vzc2lvbik7XG4gICAgICAgIGxvYWRUYXNrcygpO1xuXG4gICAgfVxuXG4gICAgdXJsUGFyYW1zLnNldChcImxvYWRTYXZlZFwiLCB0cnVlKTtcblxuICAgIHRpbWVyUHJvZ3Jlc3NDaXJjbGUuc2V0RGlzcGxheVRleHQoZm9ybWF0VGltZShjdXJyZW50UG9tb1Nlc3Npb24udGltZSkpO1xuICAgIHRpbWVyUHJvZ3Jlc3NDaXJjbGUuc2V0UGVyY2VudGFnZShjdXJyZW50UG9tb1Nlc3Npb24udGltZSAvIG1heFBvbW9UaW1lKTtcbiAgICBpZiAoY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgPT09IFBPTU9fU0VTU0lPTl9NT0RFUy5CUkVBSykge1xuICAgICAgICByZW5kZXJCcmVha01vZGUoKTtcbiAgICAgICAgdGltZXJQcm9ncmVzc0NpcmNsZS5zZXRQZXJjZW50YWdlKGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lIC8gbWF4QnJlYWtUaW1lKTtcbiAgICB9IGVsc2UgaWYgKGN1cnJlbnRQb21vU2Vzc2lvbi5tb2RlID09PSBQT01PX1NFU1NJT05fTU9ERVMuTE9OR19CUkVBSykge1xuICAgICAgICByZW5kZXJCcmVha01vZGUoKTtcbiAgICAgICAgdGltZXJQcm9ncmVzc0NpcmNsZS5zZXRQZXJjZW50YWdlKGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lIC8gU1ZHRkVDb2xvck1hdHJpeEVsZW1lbnQpO1xuICAgIH1cblxuICAgIC8vIEltcGxlbWVudHMgdGhlIG9uY2xpY2sgZnVuY3Rpb25hbGl0eSBvZiBFbmQgQnJlYWsgRWFybHkgQnV0dG9uLCB3aGljaCBpbW1lZGlhdGVseSBzdG9wIHRoZSBicmVhayBcbiAgICAvLyBhbmQgZ28gdG8gdGhlIHdvcmsgdGltZVxuICAgIEVuZEJyZWFrRWFybHlCdXR0b24ub25jbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmVuZGVyQWN0aXZlTW9kZSgpO1xuICAgICAgICBjdXJyZW50UG9tb1Nlc3Npb24udGltZSA9IG1heFBvbW9UaW1lO1xuICAgICAgICBjdXJyZW50UG9tb1Nlc3Npb24ubW9kZSA9IFBPTU9fU0VTU0lPTl9NT0RFUy5BQ1RJVkU7XG4gICAgfTtcblxuICAgIHN0YXJ0VGltZXJCdXR0b24ub25jbGljayA9IGluaXRpYXRlVGltZXI7XG5cbiAgICBtb2RhbC5zaGFkb3dSb290LmdldEVsZW1lbnRCeUlkKFwic2F2ZS1idG5cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNvbnRlbnRzU2F2ZWQpO1xuICAgIGFkZFRhc2tCdXR0b24ub25jbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbW9kYWwuZGlzcGxheU1vZGFsKCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEltcGxlbWVudHMgdGhlIG9uQ2xpY2sgZnVuY3Rpb25hbGl0eSBvZiB0aGUgU3RhcnQgVGltZXIgYnV0dG9uLCB3aGljaCBzdGFydHMgdGhlIHBvbW8gdGltZXIgYW5kIGN5Y2xlc1xuICAgICAqIHBvbW8gYW5kIGJyZWFrIHRpbWVycyB1bnRpbCBhbGwgcG9tb3MgYXJlIGNvbXBsZXRlZC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpbml0aWF0ZVRpbWVyKCkge1xuICAgICAgICBjdXJyZW50VGFza0hUTUwuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjdXJyZW50VGFza1dvcmtUaW1lXCIpO1xuICAgICAgICB0aW1lclByb2dyZXNzQ2lyY2xlLnNldFNpemUoXCIxLjVyZW1cIik7XG5cbiAgICAgICAgdGFza0xpc3Quc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJ0YXNrTGlzdFdvcmtUaW1lXCIpO1xuXG4gICAgICAgIGxldCB0aW1lcldyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRpbWVyV3JhcHBlclwiKTtcbiAgICAgICAgdGltZXJXcmFwcGVyLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwidGltZXJXcmFwcGVyV29ya1RpbWVcIik7XG5cbiAgICAgICAgZGlzdHJhY3RlZEJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuXG5cbiAgICAgICAgbGV0IGNvbXBsZXRlU2Vzc2lvbldyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbXBsZXRlU2Vzc2lvbldyYXBwZXJcIik7XG4gICAgICAgIGNvbXBsZXRlU2Vzc2lvbldyYXBwZXIuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjb21wbGV0ZVNlc3Npb25XcmFwcGVyV29ya1RpbWVcIik7XG4gICAgICAgIGxldCB0YXNrQ3JlYXRvcldyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRhc2tDcmVhdG9yV3JhcHBlclwiKTtcbiAgICAgICAgdGFza0NyZWF0b3JXcmFwcGVyLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImN1cnJlbnRUYXNrV3JhcHBlclwiKS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuXG4gICAgICAgIHN0YXJ0TmV3VGFzaygpO1xuXG4gICAgICAgIGlmIChjdXJyZW50UG9tb1Nlc3Npb24ubW9kZSA9PT0gUE9NT19TRVNTSU9OX01PREVTLklOQUNUSVZFKSB7XG4gICAgICAgICAgICBjdXJyZW50UG9tb1Nlc3Npb24ubW9kZSA9IFBPTU9fU0VTU0lPTl9NT0RFUy5BQ1RJVkU7XG4gICAgICAgICAgICBzdG9yZVBvbW9TZXNzaW9uKGN1cnJlbnRQb21vU2Vzc2lvbik7XG4gICAgICAgIH1cblxuICAgICAgICAvL3JlbW92ZXMgZmlyc3QgY2hpbGQgZnJvbSB0YXNrIGxpc3QgYW5kIGFkZHMgdG8gY3VycmVudCB0YXNrXG5cbiAgICAgICAgbGV0IHRpbWVyTG9vcCA9IHNldEludGVydmFsKHRpbWVDaGFuZ2VyLCAxMDAwKTtcblxuICAgICAgICBsZXQgY3VycmVudFRhc2tGaXJzdENoaWxkID0gY3VycmVudFRhc2tIVE1MLmNoaWxkTm9kZXNbMF07XG4gICAgICAgIGN1cnJlbnRUYXNrRmlyc3RDaGlsZC5zZXRGaW5pc2hUYXNrQ2FsbGJhY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmVtb3ZlQ29tcGxldGVkVGFza3MoKTtcbiAgICAgICAgICAgIHN0YXJ0TmV3VGFzaygpO1xuICAgICAgICB9KTtcbiAgICAgICAgbGV0IGN1cnJlbnRUYXNrID0gY3VycmVudFBvbW9TZXNzaW9uLmN1cnJlbnRUYXNrKCk7XG4gICAgICAgIGN1cnJlbnRUYXNrRmlyc3RDaGlsZC50YXNrID0gY3VycmVudFRhc2s7XG4gICAgICAgIGZ1bmN0aW9uIHRpbWVDaGFuZ2VyKCkge1xuICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uID0gZ2V0UG9tb1Nlc3Npb24oY3VycmVudFBvbW9TZXNzaW9uLmlkKTtcbiAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lIC09IDE7XG4gICAgICAgICAgICBpZiAoY3VycmVudFBvbW9TZXNzaW9uLnRpbWUgPCAwKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLnRpbWUgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBjaGVjayBpZiBzZXNzaW9uIGlzIGluY29tcGxldGUuIGlmIGluY29tcGxldGUsIFxuICAgICAgICAgICAgXG5cbiAgICAgICAgICAgIC8vIElmIHRpbWVyIGhpdHMgMCwgdG9nZ2xlIHRvIG5leHQgYnJlYWsgb3IgcG9tbyB0aW1lclxuICAgICAgICAgICAgaWYgKGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lID09IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgPT09IFBPTU9fU0VTU0lPTl9NT0RFUy5BQ1RJVkUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9icmVhayBcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyQnJlYWtNb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi5wb21vc0VsYXBzZWQgKz0gMTtcblxuICAgICAgICAgICAgICAgICAgICBsZXQgY3VycmVudFRhc2tGaXJzdENoaWxkID0gY3VycmVudFRhc2tIVE1MLmNoaWxkTm9kZXNbMF07XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRUYXNrRmlyc3RDaGlsZC5pbmNyZW1lbnRQb21vc1VzZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFRhc2tGaXJzdENoaWxkLnRhc2sucG9tb3NVc2VkICs9IDE7XG5cbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFRhc2tGaXJzdENoaWxkLnNldEF0dHJpYnV0ZShcInBvbW9zdXNlZFwiLCAxICsgcGFyc2VJbnQoY3VycmVudFRhc2tGaXJzdENoaWxkLmdldEF0dHJpYnV0ZShcInBvbW9zdXNlZFwiKSkpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIExvbmcgYnJlYWssIGN1cnJlbnRseSBoYXJkY29kZWQgYWZ0ZXIgZXZlcnkgNCBwb21vc1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFBvbW9TZXNzaW9uLnBvbW9zRWxhcHNlZCAlIDQgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLnRpbWUgPSBtYXhMb25nQnJlYWtUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgPSBQT01PX1NFU1NJT05fTU9ERVMuTE9OR19CUkVBSztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBTaG9ydCBicmVha1xuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lID0gbWF4QnJlYWtUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgPSBQT01PX1NFU1NJT05fTU9ERVMuQlJFQUs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gTmV4dCB0aW1lciBzaG91bGQgYmUgYSBwb21vIHRpbWVyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgIT09IFBPTU9fU0VTU0lPTl9NT0RFUy5DT01QTEVURSkge1xuICAgICAgICAgICAgICAgICAgICByZW5kZXJBY3RpdmVNb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lID0gbWF4UG9tb1RpbWU7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi5tb2RlID0gUE9NT19TRVNTSU9OX01PREVTLkFDVElWRTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBBZGQgZnVuY3Rpb25hbGl0eSBmb3IgbW92aW5nIG9udG8gbmV4dCB0YXNrLCB1cGRhdGluZyBwb21vcyB1c2VkIG9uIGN1cnJlbnQgdGFzaywgZXRjLlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFB1c2ggdXBkYXRlZCB0aW1lIHRvIHRoZSBwYWdlXG4gICAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IGZvcm1hdFRpbWUoY3VycmVudFBvbW9TZXNzaW9uLnRpbWUpO1xuICAgICAgICAgICAgdGltZXJQcm9ncmVzc0NpcmNsZS5zZXREaXNwbGF5VGV4dChmb3JtYXRUaW1lKGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lKSk7XG4gICAgICAgICAgICBpZiAoY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgPT09IFBPTU9fU0VTU0lPTl9NT0RFUy5BQ1RJVkUpIHtcbiAgICAgICAgICAgICAgICB0aW1lclByb2dyZXNzQ2lyY2xlLnNldFBlcmNlbnRhZ2UoY3VycmVudFBvbW9TZXNzaW9uLnRpbWUgLyBtYXhQb21vVGltZSk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQudGl0bGUgKz0gXCIgLSBXb3JrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjdXJyZW50UG9tb1Nlc3Npb24ubW9kZSA9PT0gUE9NT19TRVNTSU9OX01PREVTLkJSRUFLKSB7XG4gICAgICAgICAgICAgICAgdGltZXJQcm9ncmVzc0NpcmNsZS5zZXRQZXJjZW50YWdlKGN1cnJlbnRQb21vU2Vzc2lvbi50aW1lIC8gbWF4QnJlYWtUaW1lKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC50aXRsZSArPSBcIiAtIEJyZWFrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjdXJyZW50UG9tb1Nlc3Npb24ubW9kZSA9PT0gUE9NT19TRVNTSU9OX01PREVTLkxPTkdfQlJFQUspIHtcbiAgICAgICAgICAgICAgICB0aW1lclByb2dyZXNzQ2lyY2xlLnNldFBlcmNlbnRhZ2UoY3VycmVudFBvbW9TZXNzaW9uLnRpbWUgLyBtYXhMb25nQnJlYWtUaW1lKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC50aXRsZSArPSBcIiAtIExvbmcgQnJlYWtcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN0b3JlUG9tb1Nlc3Npb24oY3VycmVudFBvbW9TZXNzaW9uKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbmRlckFjdGl2ZU1vZGUoKSB7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGltZXItc3RhdHVzXCIpLmlubmVyVGV4dCA9IFwiUG9tbyBUaW1lXCI7XG4gICAgICAgIGN1cnJlbnRUYXNrSFRNTC5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImN1cnJlbnRUYXNrV29ya1RpbWVcIik7XG4gICAgICAgIHRhc2tMaXN0SFRNTC5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInRhc2tMaXN0V29ya1RpbWVcIik7XG4gICAgICAgIGRpc3RyYWN0ZWRCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgICAgRW5kQnJlYWtFYXJseUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cbiAgICAgICAgdGltZXJXcmFwcGVyLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwidGltZXJXcmFwcGVyV29ya1RpbWVcIik7XG4gICAgICAgIGNvbXBsZXRlU2Vzc2lvbldyYXBwZXIuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjb21wbGV0ZVNlc3Npb25XcmFwcGVyV29ya1RpbWVcIik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVuZGVyQnJlYWtNb2RlKCkge1xuICAgICAgICBjdXJyZW50VGFza0hUTUwuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjdXJyZW50VGFza0JyZWFrVGltZVwiKTtcbiAgICAgICAgdGFza0xpc3RIVE1MLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwidGFza0xpc3RCcmVha1RpbWVcIik7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGltZXItc3RhdHVzXCIpLmlubmVyVGV4dCA9IFwiQnJlYWsgVGltZVwiO1xuICAgICAgICBFbmRCcmVha0Vhcmx5QnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgIGRpc3RyYWN0ZWRCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXG4gICAgICAgIHRpbWVyV3JhcHBlci5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInRpbWVyV3JhcHBlckJyZWFrVGltZVwiKTtcbiAgICAgICAgY29tcGxldGVTZXNzaW9uV3JhcHBlci5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImNvbXBsZXRlU2Vzc2lvbldyYXBwZXJCcmVha1RpbWVcIik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgKiBSZW5kZXIgYSB0YXNrIG9udG8gdGhlIFxuICAgICogQHBhcmFtIHtUYXNrfSB0YXNrIFxuICAgICovXG4gICAgZnVuY3Rpb24gcmVuZGVyVGFza0ludG9UYXNrTGlzdCh0YXNrKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRUYXNrRWxlbWVudCA9IGA8cG9tby10YXNrIGRlc2NyaXB0aW9uID1cIiR7dGFzay5kZXNjcmlwdGlvbn1cIiBwb21vc1VzZWQ9XCIke3Rhc2sucG9tb3NVc2VkfVwiLCBwb21vc1JlcXVpcmVkID1cIiR7dGFzay5wb21vc1JlcXVpcmVkfVwiPiR7dGFzay50aXRsZX08L3BvbW8tdGFzaz5gO1xuICAgICAgICB0YXNrTGlzdC5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgY3VycmVudFRhc2tFbGVtZW50KTtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IHRhc2tMaXN0LmNoaWxkTm9kZXNbdGFza0xpc3QuY2hpbGROb2Rlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgZWxlbWVudC5zZXRGaW5pc2hUYXNrQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgICAgICAgcmVtb3ZlQ29tcGxldGVkVGFza3MoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGVsZW1lbnQuc2V0RGVsZXRlVGFza0NhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgICAgIGRlbGV0ZVRhc2tCeUlkKHRhc2suaWQpO1xuICAgICAgICB9KTtcbiAgICAgICAgZWxlbWVudC50YXNrID0gdGFzaztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIHdoZW4gd2Ugc2F2ZSBhIG5ldyB0YXNrLlxuICAgICAqIEFkZHMgbmV3IHRhc2sgdG8gdGhlIGN1cnJlbnQgdGFza3MgbGlzdC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb250ZW50c1NhdmVkKCkge1xuICAgICAgICBsZXQgdGFza1ZhbHVlcyA9IG1vZGFsLmVsZW1lbnRzLnZhbHVlcztcbiAgICAgICAgaWYodGFza1ZhbHVlcyAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGxldCBzZXNzaW9uSUQgPSBnZXRMYXRlc3RTZXNzaW9uSUQoKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRhc2tWYWx1ZXMpO1xuICAgICAgICAgICAgbGV0IG5ld1Rhc2sgPSBuZXcgVGFzayhzZXNzaW9uSUQsIHRhc2tWYWx1ZXMudGFza05hbWUsIHRhc2tWYWx1ZXMuZGVzY3JpcHRpb24sIHBhcnNlSW50KHRhc2tWYWx1ZXMucG9tb3NSZXF1aXJlZCkpO1xuICAgICAgICAgICAgcmVuZGVyVGFza0ludG9UYXNrTGlzdChuZXdUYXNrKTtcbiAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi5hZGRUYXNrKG5ld1Rhc2spO1xuICAgICAgICAgICAgc3RvcmVQb21vU2Vzc2lvbihjdXJyZW50UG9tb1Nlc3Npb24pO1xuXG4gICAgICAgICAgICByZXNldElucHV0cygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXJzIGlucHV0cyBhbmQgcmVzZXRzIHN0eWxlXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVzZXRJbnB1dHMoKSB7XG4gICAgICAgIGNvbnN0IHRhc2tOYW1lID0gbW9kYWwuc2hhZG93Um9vdC5nZXRFbGVtZW50QnlJZChcInRhc2stbmFtZVwiKS5lbGVtZW50cy53cmFwcGVyO1xuICAgICAgICBjb25zdCBwb21vc1JlcXVpcmVkID0gbW9kYWwuc2hhZG93Um9vdC5nZXRFbGVtZW50QnlJZChcInBvbW9zLXJlcXVpcmVkXCIpLmVsZW1lbnRzLndyYXBwZXI7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gbW9kYWwuc2hhZG93Um9vdC5nZXRFbGVtZW50QnlJZChcImRlc2NyaXB0aW9uXCIpLmVsZW1lbnRzLndyYXBwZXI7XG5cbiAgICAgICAgdGFza05hbWUuaW5uZXJUZXh0ID0gdGFza05hbWUucGxhY2Vob2xkZXI7XG4gICAgICAgIHRhc2tOYW1lLnVzZXJUeXBlZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGFza05hbWUuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJwb21vLWlucHV0IHBsYWNlaG9sZGVyXCIpO1xuXG4gICAgICAgIHBvbW9zUmVxdWlyZWQuaW5uZXJUZXh0ID0gcG9tb3NSZXF1aXJlZC5wbGFjZWhvbGRlcjtcbiAgICAgICAgcG9tb3NSZXF1aXJlZC51c2VyVHlwZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHBvbW9zUmVxdWlyZWQuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJwb21vLWlucHV0IHBsYWNlaG9sZGVyXCIpO1xuXG4gICAgICAgIGRlc2NyaXB0aW9uLmlubmVyVGV4dCA9IGRlc2NyaXB0aW9uLnBsYWNlaG9sZGVyO1xuICAgICAgICBkZXNjcmlwdGlvbi51c2VyVHlwZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIGRlc2NyaXB0aW9uLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwicG9tby1pbnB1dCBwbGFjZWhvbGRlclwiKTtcblxuICAgICAgICBtb2RhbC5lbGVtZW50cy52YWx1ZXMgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBTaG93cyBhIG5ldyB0YXNrIG9udG8gdGhlIGRpc3BsYXlcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzdGFydE5ld1Rhc2soKSB7XG4gICAgICAgIGxldCB0YXNrTGlzdEZpcnN0Q2hpbGQgPSB0YXNrTGlzdEhUTUwuY2hpbGROb2Rlc1swXTtcbiAgICAgICAgbGV0IG5leHRUYXNrID0gY3VycmVudFBvbW9TZXNzaW9uLmdldE5leHRUYXNrKCk7XG4gICAgICAgIGlmIChuZXh0VGFzayA9PT0gbnVsbCkge1xuICAgICAgICAgICAgLy8gY29tcGxldGUgdGhlIHNlc3Npb25cbiAgICAgICAgICAgIGN1cnJlbnRQb21vU2Vzc2lvbi5tb2RlID0gUE9NT19TRVNTSU9OX01PREVTLkNPTVBMRVRFO1xuICAgICAgICAgICAgc3RvcmVQb21vU2Vzc2lvbihjdXJyZW50UG9tb1Nlc3Npb24pO1xuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID1cIi4vaGlzdG9yeS5odG1sXCI7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY3VycmVudFRhc2tUb0JlQWRkZWQgPSBgPHBvbW8tdGFzayBkZXNjcmlwdGlvbj1cIiR7bmV4dFRhc2suZGVzY3JpcHRpb259XCIgcG9tb3NVc2VkPVwiJHtuZXh0VGFzay5wb21vc1VzZWR9XCIgcG9tb3NSZXF1aXJlZD0ke25leHRUYXNrLnBvbW9zUmVxdWlyZWR9PiR7bmV4dFRhc2sudGl0bGV9PC9wb21vLXRhc2s+YDtcbiAgICAgICAgY3VycmVudFRhc2tIVE1MLmluc2VydEFkamFjZW50SFRNTChcImJlZm9yZWVuZFwiLCBjdXJyZW50VGFza1RvQmVBZGRlZCk7XG4gICAgICAgIHRhc2tMaXN0SFRNTC5yZW1vdmVDaGlsZCh0YXNrTGlzdEhUTUwuY2hpbGROb2Rlc1swXSk7XG4gICAgICAgIGxldCBlbGVtZW50ID0gY3VycmVudFRhc2tIVE1MLmNoaWxkTm9kZXNbY3VycmVudFRhc2tIVE1MLmNoaWxkTm9kZXMubGVuZ3RoIC0gMV07XG4gICAgICAgIGVsZW1lbnQuc2V0RmluaXNoVGFza0NhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgICAgIHJlbW92ZUNvbXBsZXRlZFRhc2tzKCk7XG4gICAgICAgICAgICBzdGFydE5ld1Rhc2soKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGVsZW1lbnQuc2V0RGVsZXRlVGFza0NhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgICAgIGRlbGV0ZVRhc2tCeUlkKG5leHRUYXNrLmlkKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGVsZW1lbnQudGFzayA9IG5leHRUYXNrO1xuXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogcmVtb3ZlIGNvbXBsZXRlZCB0YXNrcyBmcm9tIGRpc3BsYXkgYW5kIHVwZGF0ZSB0aGUgY3VycmVudCBwb21vIHNlc3Npb25cbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZW1vdmVDb21wbGV0ZWRUYXNrcygpIHtcbiAgICAgICAgbGV0IGNvbXBsZXRlZElkcyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBub2RlIG9mIGN1cnJlbnRUYXNrSFRNTC5jaGlsZE5vZGVzKSB7XG4gICAgICAgICAgICBpZiAobm9kZS5jb21wbGV0ZWQpIHtcbiAgICAgICAgICAgICAgICBjb21wbGV0ZWRJZHMucHVzaChub2RlLnRhc2suaWQpO1xuICAgICAgICAgICAgICAgIG5vZGUuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGFza0hUTUwucmVtb3ZlQ2hpbGQobm9kZSk7XG4gICAgICAgICAgICAgICAgfSwgMjAwKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IG5vZGUgb2YgdGFza0xpc3RIVE1MLmNoaWxkTm9kZXMpIHtcbiAgICAgICAgICAgIGlmIChub2RlLmNvbXBsZXRlZCkge1xuICAgICAgICAgICAgICAgIGNvbXBsZXRlZElkcy5wdXNoKG5vZGUudGFzay5pZCk7XG4gICAgICAgICAgICAgICAgbm9kZS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tMaXN0SFRNTC5yZW1vdmVDaGlsZChub2RlKTtcbiAgICAgICAgICAgICAgICB9LCAyMDApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbXBsZXRlZElkcy5mb3JFYWNoKChpZCkgPT4ge1xuICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLmNvbXBsZXRlVGFzayhpZCk7XG4gICAgICAgIH0pO1xuICAgICAgICBzdG9yZVBvbW9TZXNzaW9uKGN1cnJlbnRQb21vU2Vzc2lvbik7XG5cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWxldGVUYXNrQnlJZChpZCkge1xuICAgICAgICAvLyBzZWFyY2ggY3VycmVudCB0YXNrIGxpc3QgYW5kIHRhc2sgbGlzdHMgZm9yIHRoaXMgaWQgYW5kIHJlbW92ZSBpdCBmcm9tIGRpc3BsYXkgYW5kIHRoZSBwb21vIHNlc3Npb25cbiAgICAgICAgbGV0IGN1cnJlbnRUYXNrRWxlbWVudExpc3QgPSBjdXJyZW50VGFza0hUTUwuY2hpbGROb2RlcztcbiAgICAgICAgaWYgKGN1cnJlbnRUYXNrRWxlbWVudExpc3QubGVuZ3RoKSB7XG4gICAgICAgICAgICBsZXQgdGFzayA9IGN1cnJlbnRUYXNrRWxlbWVudExpc3RbY3VycmVudFRhc2tFbGVtZW50TGlzdC5sZW5ndGggLSAxXS50YXNrO1xuICAgICAgICAgICAgaWYgKHRhc2suaWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpcm0oXCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgdGFzaz9cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLmRlbGV0ZVRhc2sodGFzayk7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRUYXNrSFRNTC5yZW1vdmVDaGlsZChjdXJyZW50VGFza0hUTUwuY2hpbGROb2Rlc1tjdXJyZW50VGFza0VsZW1lbnRMaXN0Lmxlbmd0aCAtIDFdKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnROZXdUYXNrKCk7ICAgICBcbiAgICAgICAgICAgICAgICAgICAgc3RvcmVQb21vU2Vzc2lvbihjdXJyZW50UG9tb1Nlc3Npb24pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0YXNrTGlzdEhUTUwuY2hpbGROb2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiB0YXNrTGlzdEhUTUwuY2hpbGROb2Rlcykge1xuICAgICAgICAgICAgICAgIGxldCB0YXNrID0gbm9kZS50YXNrO1xuICAgICAgICAgICAgICAgIGlmICh0YXNrLmlkID09PSBpZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlybShcIkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyB0YXNrP1wiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFBvbW9TZXNzaW9uLmRlbGV0ZVRhc2sodGFzayk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrTGlzdEhUTUwucmVtb3ZlQ2hpbGQodGFza0xpc3RIVE1MLmNoaWxkTm9kZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmVQb21vU2Vzc2lvbihjdXJyZW50UG9tb1Nlc3Npb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkIGFsbCB0YXNrcyBmcm9tIHN0b3JhZ2UgZm9yIHRoZSBjdXJyZW50IHNlc3Npb24gYW5kIHJlbmRlciB0aGVtXG4gICAgICovXG4gICAgZnVuY3Rpb24gbG9hZFRhc2tzKCkge1xuICAgICAgICBsZXQgaWQgPSBnZXRMYXRlc3RTZXNzaW9uSUQoKTtcbiAgICAgICAgbGV0IGFsbFRhc2tzID0gW107XG4gICAgICAgIGlmIChpZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgbGV0IHRhc2tzID0gY3VycmVudFBvbW9TZXNzaW9uLmFsbFRhc2tzO1xuICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyh0YXNrcykuZm9yRWFjaCgodGFzaykgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRhc2spO1xuICAgICAgICAgICAgICAgIGlmICh0YXNrLnNlc3Npb25JRCA9PT0gaWQgJiYgIXRhc2suY29tcGxldGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGFsbFRhc2tzLnB1c2godGFzayk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBhbGxUYXNrcy5mb3JFYWNoKCh0YXNrKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVuZGVyVGFza0ludG9UYXNrTGlzdCh0YXNrKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IG5vZGUgb2YgdGFza0xpc3RIVE1MLmNoaWxkTm9kZXMpIHtcbiAgICAgICAgICAgIG5vZGUuc2V0RmluaXNoVGFza0NhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICByZW1vdmVDb21wbGV0ZWRUYXNrcygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59KTsiXSwic291cmNlUm9vdCI6IiJ9