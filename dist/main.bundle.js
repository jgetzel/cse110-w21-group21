(()=>{"use strict";var e={409:(e,t,n)=>{n.d(t,{xN:()=>a,RL:()=>i,RK:()=>s});var r=n(594),o=n(771);function a(){var e=!1;null===s(r.Rd)&&(e=!0),null===s(r.oi)&&(e=!0),null===!localStorage.getItem(o.Do)&&(e=!0),null===!localStorage.getItem(o.mn)&&(e=!0),null===s(o.XB)&&(e=!0),e&&(i(r.Rd,{}),i(r.oi,0),i(o.mn,"complete"),i(o.Do,0),i(o.XB,{}))}function i(e,t){localStorage.setItem(e,JSON.stringify(t))}function s(e){return JSON.parse(localStorage.getItem(e))}},771:(e,t,n)=>{n.d(t,{Do:()=>l,mn:()=>u,XB:()=>c,_c:()=>m,RU:()=>p,iF:()=>v});var r=n(409),o=n(594);function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l="pomo_session_id",u="latest_pomo_session_status",c="pomo_session_map",d="inactive",f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.allTasks=[],this.mode=d,this.time=0,this.pomosElapsed=0,this.startDate=new Date}var t,n;return t=e,(n=[{key:"currentTask",value:function(){var e=this.allTasks.filter((function(e){return!e.completed}));return e.length>0?e[0]:null}},{key:"addTask",value:function(e){(0,o.rs)(e),this.allTasks.push(e)}},{key:"deleteTask",value:function(e){(0,o.c_)(e.id);for(var t=0;t<this.allTasks.length;t++){var n=this.allTasks[t];if(e.id===n.id)return void this.allTasks.splice(t,1)}}},{key:"completeTask",value:function(e){var t,n=a(this.allTasks);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.id===e)return r.completed=!0,!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"getNextTask",value:function(){var e,t=a(this.allTasks);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(!1===n.completed)return n}}catch(e){t.e(e)}finally{t.f()}return null}},{key:"incrementTaskPomosUsed",value:function(e){var t,n=a(this.allTasks);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.id===e)return r.pomosUsed+=1,void(this.pomosElapsed+=1)}}catch(e){n.e(e)}finally{n.f()}}},{key:"isBreak",value:function(){return"longbreak"===this.mode||"break"===this.mode}},{key:"reorderTasks",value:function(){}},{key:"getPomosLeftInSession",value:function(){var e=0;return this.allTasks.forEach((function(t){e+=Math.max(t.pomosRequired-t.pomosUsed,0)})),e}},{key:"parseSessionFromObj",value:function(e){return this.id=e.id,this.mode=e.mode,this.time=e.time,this.pomosElapsed=e.pomosElapsed,this.startDate=new Date(e.startDate),this.allTasks=e.allTasks.map((function(e){var t=new o.iQ;return t.parseTaskFromObj(e)})),this}},{key:"serializeIntoObj",value:function(){return{id:this.id,allTasks:this.allTasks.map((function(e){return e.serializeIntoObj()})),mode:this.mode,time:this.time,pomosElapsed:this.pomosElapsed,startDate:this.startDate.getTime()}}}])&&s(t.prototype,n),e}();function m(e){var t=(0,r.RK)(c),n=new f;return t[e]?n.parseSessionFromObj(t[e]):null}function p(){return"complete"===localStorage.getItem(u)?null:parseInt(localStorage.getItem(l))-1}function v(){(function(){var e=p();if(null===e)return!1;var t=m(e);return null!==t&&"complete"!==t.mode&&t.mode!==d})()&&(window.location="/timer.html?loadSaved=true")}},594:(e,t,n)=>{n.d(t,{iQ:()=>i,Rd:()=>s,oi:()=>l,rs:()=>u,c_:()=>c,zT:()=>d});var r=n(409),o=n(771);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionID=t,this.id=-1,this.title=n,this.description=r,this.pomosRequired=o,this.completed=!1,this.pomosUsed=0}var t,n;return t=e,(n=[{key:"parseTaskFromObj",value:function(t){var n=new e(t.sessionID,t.title,t.description,t.pomosRequired);return n.completed=t.completed,n.id=t.id,n.pomosUsed=t.pomosUsed,n}},{key:"serializeIntoObj",value:function(){return{title:this.title,description:this.description,pomosRequired:this.pomosRequired,completed:this.completed,pomosUsed:this.pomosUsed,id:this.id,sessionID:this.sessionID}}}])&&a(t.prototype,n),e}(),s="pomo_task_map",l="pomo_task_index";function u(e){var t=(0,r.RK)(s);if(!t[e.id]){var n=parseInt((0,r.RK)(l));e.id=n,(0,r.RL)(l,n+1)}var o=e.serializeIntoObj();return t[e.id]=o,(0,r.RL)(s,t),e.id}function c(e){var t=(0,r.RK)(s);delete t[e],(0,r.RL)(s,t)}function d(){var e=(0,o.RU)();if(null===e)return!1;var t=(0,o._c)(e);return null!==t&&null!==t.currentTask()}}},t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=n(409),t=n(771),r=n(594),o="day",a="night";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=o;return e.getHours()<4?t=a:e.getHours()<18?t=o:e.getHours()<24&&(t=a),t}window.addEventListener("DOMContentLoaded",(function(){(0,e.xN)(),(0,t.iF)(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=0,n=6,r=e.getDay(),o=localStorage.getItem("bg-seed");null!==o&&o[0]==r||(o=r+"-"+Math.floor(Math.random()*n),localStorage.setItem("bg-seed",o));var a=i(e);t=parseInt(o[2]),document.getElementById("backdrop").style.backgroundImage='url("../assets/images/backgrounds/'.concat(a,"/bg").concat(t,'.jpg")')}(),(0,r.zT)()||(console.log(document.getElementById("leftover-tasks-wrapper")),document.getElementById("leftover-tasks-wrapper").style.display="none")}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jc2UxMTAtdzIxLWdyb3VwMjEvLi9zb3VyY2UvYXNzZXRzL3NjcmlwdHMvZGF0YWJhc2UvaW5kZXguanMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxLy4vc291cmNlL2Fzc2V0cy9zY3JpcHRzL2RhdGFiYXNlL3Nlc3Npb24uanMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxLy4vc291cmNlL2Fzc2V0cy9zY3JpcHRzL2RhdGFiYXNlL3Rhc2suanMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2NzZTExMC13MjEtZ3JvdXAyMS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxLy4vc291cmNlL2Fzc2V0cy9zY3JpcHRzL3V0aWxzL3RoZW1lLmpzIiwid2VicGFjazovL2NzZTExMC13MjEtZ3JvdXAyMS8uL3NvdXJjZS9hc3NldHMvc2NyaXB0cy9tYWluLmpzIl0sIm5hbWVzIjpbImluaXRpYWxpemVEYXRhYmFzZSIsIm5lZWRUb0luaXRpYWxpemUiLCJnZXRPYmplY3QiLCJQT01PX1RBU0tfTUFQIiwiUE9NT19UQVNLX0lOREVYIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsIlBPTU9fU0VTU0lPTl9JRCIsIkxBVEVTVF9QT01PX1NFU1NJT05fU1RBVFVTIiwiUE9NT19TRVNTSU9OX01BUCIsInN0b3JlT2JqZWN0Iiwia2V5Iiwib2JqZWN0Iiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwYXJzZSIsIlBPTU9fU0VTU0lPTl9NT0RFUyIsIlBvbW9TZXNzaW9uIiwiaWQiLCJ0aGlzIiwiYWxsVGFza3MiLCJtb2RlIiwidGltZSIsInBvbW9zRWxhcHNlZCIsInN0YXJ0RGF0ZSIsIkRhdGUiLCJhbGxJblByb2dyZXNzVGFza3MiLCJmaWx0ZXIiLCJ0YXNrIiwiY29tcGxldGVkIiwibGVuZ3RoIiwic3RvcmVUYXNrIiwicHVzaCIsImRlbGV0ZVRhc2tCeVRhc2tJRCIsImkiLCJzdG9yZWRUYXNrIiwic3BsaWNlIiwicG9tb3NVc2VkIiwibGVmdCIsImZvckVhY2giLCJNYXRoIiwibWF4IiwicG9tb3NSZXF1aXJlZCIsInNlc3Npb25fb2JqIiwibWFwIiwidGFza09iaiIsInQiLCJUYXNrIiwicGFyc2VUYXNrRnJvbU9iaiIsInNlcmlhbGl6ZUludG9PYmoiLCJnZXRUaW1lIiwiZ2V0UG9tb1Nlc3Npb24iLCJhbGxTZXNzaW9ucyIsInAiLCJwYXJzZVNlc3Npb25Gcm9tT2JqIiwiZ2V0TGF0ZXN0U2Vzc2lvbklEIiwicGFyc2VJbnQiLCJjb250aW51ZUFjdGl2ZVNlc3Npb24iLCJzZXNzaW9uSUQiLCJjdXJyZW50UG9tb1Nlc3Npb24iLCJ0aGVyZUlzVW5maW5pc2hlZFNlc3Npb24iLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJ0YXNrX29iaiIsInRhc2tfbWFwIiwib2JqIiwiYXJlVGhlcmVVbmZpbmlzaGVkVGFza3NGcm9tTGFzdFNlc3Npb24iLCJvbGRTZXNzaW9uSUQiLCJzZXNzaW9uIiwiY3VycmVudFRhc2siLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImQiLCJkZWZpbml0aW9uIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJUSEVNRV9NT0RFUyIsImdldFRoZW1lTW9kZSIsInRvZGF5IiwidGltZVBlcmlvZCIsImdldEhvdXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm51bUJHcyIsImdldERheSIsInNlZWQiLCJmbG9vciIsInJhbmRvbSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsInNlbGVjdEFuZFNldFRoZW1lIiwiY29uc29sZSIsImxvZyIsImRpc3BsYXkiXSwibWFwcGluZ3MiOiJrR0FHTyxTQUFTQSxJQUVaLElBQUlDLEdBQW1CLEVBQ1UsT0FBN0JDLEVBQVVDLFFBQ1ZGLEdBQW1CLEdBRVksT0FBL0JDLEVBQVVFLFFBQ1ZILEdBQW1CLEdBRXdCLFFBQTFDSSxhQUFhQyxRQUFRQyxRQUN0Qk4sR0FBbUIsR0FFbUMsUUFBckRJLGFBQWFDLFFBQVFFLFFBQ3RCUCxHQUFtQixHQUVhLE9BQWhDQyxFQUFVTyxRQUNWUixHQUFtQixHQUluQkEsSUFDQVMsRUFBWVAsS0FBZSxJQUMzQk8sRUFBWU4sS0FBaUIsR0FDN0JNLEVBQVlGLEtBQTRCLFlBQ3hDRSxFQUFZSCxLQUFpQixHQUM3QkcsRUFBWUQsS0FBa0IsS0FXL0IsU0FBU0MsRUFBWUMsRUFBS0MsR0FDN0JQLGFBQWFRLFFBQVFGLEVBQUtHLEtBQUtDLFVBQVVILElBRXRDLFNBQVNWLEVBQVVTLEdBQ3RCLE9BQU9HLEtBQUtFLE1BQU1YLGFBQWFDLFFBQVFLLE0sNndDQ3BDcEMsSUFBTUosRUFBa0Isa0JBQ2xCQyxFQUE2Qiw2QkFDN0JDLEVBQW1CLG1CQUduQlEsRUFFRCxXQVdDQyxFQUFiLFdBS0UsV0FBWUMsSSw0RkFBSSxTQUNkQyxLQUFLRCxHQUFLQSxFQUVWQyxLQUFLQyxTQUFXLEdBRWhCRCxLQUFLRSxLQUFPTCxFQUVaRyxLQUFLRyxLQUFPLEVBR1pILEtBQUtJLGFBQWUsRUFFcEJKLEtBQUtLLFVBQVksSUFBSUMsSyxRQWpCekIsTyxFQUFBLEcsRUFBQSwwQkF1QkUsV0FDRSxJQUFJQyxFQUFxQlAsS0FBS0MsU0FBU08sUUFBTyxTQUFDQyxHQUFELE9BQVdBLEVBQUtDLGFBQzlELE9BQUlILEVBQW1CSSxPQUFTLEVBQ3JC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RixJQUVsQyxJQUFJTCxFQUFhRixFQUFhQyxHQUM5QnpFLEVBQUtzQyxTQUFTeUMsRUFBSyxJQUVMRyxTQUFTQyxlQUFlLFlBQzlCQyxNQUFNQyxnQkFBZCw0Q0FBcUVYLEVBQXJFLGNBQXFGMUUsRUFBckYsVUNYRXNGLElBQ21CcEMsWUFFZnFDLFFBQVFDLElBQUlOLFNBQVNDLGVBQWUsMkJBQ3BDRCxTQUFTQyxlQUFlLDBCQUEwQkMsTUFBTUssUUFBVSxZIiwiZmlsZSI6Im1haW4uYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUE9NT19UQVNLX0lOREVYLCBQT01PX1RBU0tfTUFQIH0gZnJvbSBcIi4vdGFza1wiO1xuaW1wb3J0IHsgUE9NT19TRVNTSU9OX0lELCBMQVRFU1RfUE9NT19TRVNTSU9OX1NUQVRVUywgUE9NT19TRVNTSU9OX01BUCB9IGZyb20gXCIuL3Nlc3Npb25cIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemVEYXRhYmFzZSgpIHtcbiAgICAvLyBjaGVjayBpZiB3ZSBuZWVkIHRvIGluaXRpYWxpemVcbiAgICBsZXQgbmVlZFRvSW5pdGlhbGl6ZSA9IGZhbHNlO1xuICAgIGlmIChnZXRPYmplY3QoUE9NT19UQVNLX01BUCkgPT09IG51bGwpIHtcbiAgICAgICAgbmVlZFRvSW5pdGlhbGl6ZSA9IHRydWU7XG4gICAgfVxuICAgIGlmIChnZXRPYmplY3QoUE9NT19UQVNLX0lOREVYKSA9PT0gbnVsbCkge1xuICAgICAgICBuZWVkVG9Jbml0aWFsaXplID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKCFsb2NhbFN0b3JhZ2UuZ2V0SXRlbShQT01PX1NFU1NJT05fSUQpID09PSBudWxsKSB7XG4gICAgICAgIG5lZWRUb0luaXRpYWxpemUgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoIWxvY2FsU3RvcmFnZS5nZXRJdGVtKExBVEVTVF9QT01PX1NFU1NJT05fU1RBVFVTKSA9PT0gbnVsbCkge1xuICAgICAgICBuZWVkVG9Jbml0aWFsaXplID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGdldE9iamVjdChQT01PX1NFU1NJT05fTUFQKSA9PT0gbnVsbCkge1xuICAgICAgICBuZWVkVG9Jbml0aWFsaXplID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyB0aGVuIGluaXRpYWxpemVcbiAgICBpZiAobmVlZFRvSW5pdGlhbGl6ZSkge1xuICAgICAgICBzdG9yZU9iamVjdChQT01PX1RBU0tfTUFQLCB7fSk7XG4gICAgICAgIHN0b3JlT2JqZWN0KFBPTU9fVEFTS19JTkRFWCwgMCk7XG4gICAgICAgIHN0b3JlT2JqZWN0KExBVEVTVF9QT01PX1NFU1NJT05fU1RBVFVTLCBcImNvbXBsZXRlXCIpO1xuICAgICAgICBzdG9yZU9iamVjdChQT01PX1NFU1NJT05fSUQsIDApO1xuICAgICAgICBzdG9yZU9iamVjdChQT01PX1NFU1NJT05fTUFQLCB7fSk7XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0RGF0YWJhc2UoKSB7XG4gICAgZGVsZXRlIGxvY2FsU3RvcmFnZVtQT01PX1RBU0tfTUFQXTtcbiAgICBkZWxldGUgbG9jYWxTdG9yYWdlW1BPTU9fVEFTS19JTkRFWF07XG4gICAgZGVsZXRlIGxvY2FsU3RvcmFnZVtMQVRFU1RfUE9NT19TRVNTSU9OX1NUQVRVU107XG4gICAgZGVsZXRlIGxvY2FsU3RvcmFnZVtQT01PX1NFU1NJT05fSURdO1xuICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2VbUE9NT19TRVNTSU9OX01BUF07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzdG9yZU9iamVjdChrZXksIG9iamVjdCkge1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgSlNPTi5zdHJpbmdpZnkob2JqZWN0KSk7XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0T2JqZWN0KGtleSkge1xuICAgIHJldHVybiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSkpO1xufSIsIi8qKlxuICogVGhpcyBmaWxlIGlzIHJlbGF0ZWQgdG8gZmluZGluZyBwb21vIHNlc3Npb25zXG4gKi9cbmltcG9ydCB7IGdldE9iamVjdCwgc3RvcmVPYmplY3QgfSBmcm9tIFwiLi9pbmRleFwiO1xuaW1wb3J0IHsgZGVsZXRlVGFza0J5VGFza0lELCBzdG9yZVRhc2ssIFRhc2sgfSBmcm9tIFwiLi90YXNrXCI7XG5cblxuZXhwb3J0IGNvbnN0IFBPTU9fU0VTU0lPTl9JRCA9IFwicG9tb19zZXNzaW9uX2lkXCI7XG5leHBvcnQgY29uc3QgTEFURVNUX1BPTU9fU0VTU0lPTl9TVEFUVVMgPSBcImxhdGVzdF9wb21vX3Nlc3Npb25fc3RhdHVzXCI7XG5leHBvcnQgY29uc3QgUE9NT19TRVNTSU9OX01BUCA9IFwicG9tb19zZXNzaW9uX21hcFwiO1xuXG4vKiogdGhlIGRpZmZlcmVudCBwb21vIHNlc3Npb24gbW9kZXMgYXMgY29uc3RhbnRzICovXG5leHBvcnQgY29uc3QgUE9NT19TRVNTSU9OX01PREVTID0ge1xuICAvKiogd2hlbiB0aGUgdXNlciBpcyBpbiB0aGUgaW50ZXJmYWNlIG9mIGNyZWF0aW5nIGEgbmV3IHRpbWVyIGFuZCBoYXMgbm90IHN0YXJ0ZWQgdGhlaXIgbmV3IHNlc3Npb24geWV0ICovXG4gIElOQUNUSVZFOiBcImluYWN0aXZlXCIsXG4gIC8qKiB3aGVuIHJ1bm5pbmcgdGhlIGJyZWFrIHRpbWVyICovXG4gIEJSRUFLOiBcImJyZWFrXCIsXG4gIC8qKiB3aGVuIHJ1bm5pbmcgdGhlIGxvbmdlciBicmVhayB0aW1lciAqL1xuICBMT05HX0JSRUFLOiBcImxvbmdicmVha1wiLFxuICAvKiogd2hlbiBydW5uaW5nIHRoZSBhY3RpdmUgcG9tbyB3b3JrIHRpbWUgKi9cbiAgQUNUSVZFOiBcImFjdGl2ZVwiLFxuICAvKiogd2hlbiB0aGUgdXNlciBtYXJrcyB0aGlzIHBvbW8gc2Vzc2lvbiBhcyBjb21wbGV0ZSwgcmVnYXJkbGVzcyBvZiB3aGV0aGVyIHRhc2tzIGFyZSBjb21wbGV0ZWQgb3Igbm90ICovXG4gIENPTVBMRVRFOiBcImNvbXBsZXRlXCIsXG59O1xuXG5leHBvcnQgY2xhc3MgUG9tb1Nlc3Npb24ge1xuICAvKipcbiAgICogQ3JlYXRlIGEgbmV3IFBvbW8gU2Vzc2lvbiBvYmplY3RcbiAgICogQHBhcmFtIHtudW1iZXJ9IGlkIC0gaWQgb2YgdGhpcyBzZXNzaW9uXG4gICAqL1xuICBjb25zdHJ1Y3RvcihpZCkge1xuICAgIHRoaXMuaWQgPSBpZDtcbiAgICAvKiogQHR5cGUge1Rhc2tbXX0gLSBhIGxpc3Qgb2YgYWxsIHRhc2tzIGFzc29jaWF0ZWQgd2l0aCB0aGlzIHNlc3Npb24gKi9cbiAgICB0aGlzLmFsbFRhc2tzID0gW107XG4gICAgLyoqIEB0eXBlIHtzdHJpbmd9IC0gdGhlIGN1cnJlbnQgbW9kZSBvZiB0aGUgcG9tbyBzZXNzaW9uICovXG4gICAgdGhpcy5tb2RlID0gUE9NT19TRVNTSU9OX01PREVTLklOQUNUSVZFO1xuICAgIC8qKiBAdHlwZSB7TnVtYmVyfSAtIHRoZSBjdXJyZW50IHRpbWUgb2YgdGhlIHBvbW8gc2Vzc2lvbiAqL1xuICAgIHRoaXMudGltZSA9IDA7XG5cbiAgICAvKiogQHR5cGUge051bWJlcn0gLSBudW1iZXIgb2YgcG9tb3MgZWxhcHNlZCBzdWNjZXNmdWxseSBmb3IgdGhpcyBwb21vIHNlc3Npb24gKi9cbiAgICB0aGlzLnBvbW9zRWxhcHNlZCA9IDA7XG5cbiAgICB0aGlzLnN0YXJ0RGF0ZSA9IG5ldyBEYXRlKCk7XG4gIH1cbiAgLyoqXG4gICAqIFxuICAgKiBAcmV0dXJucyB7VGFzayB8IG51bGwgfSAtIHRoZSBjdXJyZW50IHRhc2sgZm9yIHRoaXMgcG9tbyBzZXNzaW9uIG9yIG51bGwgaWYgdGhlcmUgYXJlIG5vIHRhc2tzIGxlZnRcbiAgICovXG4gIGN1cnJlbnRUYXNrKCkge1xuICAgIGxldCBhbGxJblByb2dyZXNzVGFza3MgPSB0aGlzLmFsbFRhc2tzLmZpbHRlcigodGFzaykgPT4gIXRhc2suY29tcGxldGVkKTtcbiAgICBpZiAoYWxsSW5Qcm9ncmVzc1Rhc2tzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIGFsbEluUHJvZ3Jlc3NUYXNrc1swXTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgLyoqXG4gICAqIEFkZHMgYSBuZXcgdGFza1xuICAgKiBAcGFyYW0ge1Rhc2t9IHRhc2sgXG4gICAqL1xuICBhZGRUYXNrKHRhc2spIHtcbiAgICBzdG9yZVRhc2sodGFzayk7XG4gICAgdGhpcy5hbGxUYXNrcy5wdXNoKHRhc2spO1xuICB9XG4gIC8qKlxuICAgKiBEZWxldGUgYSB0YXNrXG4gICAqIEBwYXJhbSB7VGFza30gdGFzayBcbiAgICovXG4gIGRlbGV0ZVRhc2sodGFzaykge1xuICAgIGRlbGV0ZVRhc2tCeVRhc2tJRCh0YXNrLmlkKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYWxsVGFza3MubGVuZ3RoOyBpKyspe1xuICAgICAgY29uc3Qgc3RvcmVkVGFzayA9IHRoaXMuYWxsVGFza3NbaV07XG4gICAgICBpZiAodGFzay5pZCA9PT0gc3RvcmVkVGFzay5pZCkge1xuICAgICAgICB0aGlzLmFsbFRhc2tzLnNwbGljZShpLCAxKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDb21wbGV0ZXMgdGhlIGdpdmVuIHRhc2sgYXNzb2NpYXRlZCB0byB0aGUgaWRcbiAgICogQHBhcmFtIHtudW1iZXJ9IGlkIFxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gdHJ1ZSBpZiBjb21wbGV0ZWQsIGZhbHNlIGlmIG5vIHRhc2sgZm91bmRcbiAgICovXG4gIGNvbXBsZXRlVGFzayhpZCkge1xuICAgIGZvciAobGV0IHRhc2sgb2YgdGhpcy5hbGxUYXNrcykge1xuICAgICAgaWYgKHRhc2suaWQgPT09IGlkKSB7XG4gICAgICAgIHRhc2suY29tcGxldGVkID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICAvKipcbiAgICogUmV0dXJucyB0aGUgbmV4dCBpbmNvbXBsZXRlIHRhc2sgaW4gdGhlIG9yZGVyIG9yIG51bGwgaWYgYWxsIGNvbXBsZXRlZFxuICAgKiBAcmV0dXJucyB7VGFzayB8IG51bGx9XG4gICAqL1xuICBnZXROZXh0VGFzaygpIHtcbiAgICBmb3IgKGNvbnN0IHRhc2sgb2YgdGhpcy5hbGxUYXNrcykge1xuICAgICAgaWYgKHRhc2suY29tcGxldGVkID09PSBmYWxzZSkge1xuICAgICAgICByZXR1cm4gdGFzaztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgLyoqXG4gICAqIEluY3JlbWVudCB0aGUgcG9tb3MgdXNlZCBmb3IgYSB0YXNrIGFuZCBpbmNyZW1lbnQgcG9tb3NFbGFwc2VkXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBpZCBcbiAgICovXG4gIGluY3JlbWVudFRhc2tQb21vc1VzZWQoaWQpIHtcbiAgICBmb3IgKGNvbnN0IHRhc2sgb2YgdGhpcy5hbGxUYXNrcykge1xuICAgICAgaWYgKHRhc2suaWQgPT09IGlkKSB7XG4gICAgICAgIHRhc2sucG9tb3NVc2VkICs9IDE7XG4gICAgICAgIHRoaXMucG9tb3NFbGFwc2VkICs9IDE7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogXG4gICAqIEByZXR1cm5zIHRydWUgaWYgc2Vzc2lvbiBpcyBpbiBicmVhayBtb2RlIHJpZ2h0IG5vdywgZmFsc2Ugb3RoZXJ3aXNlXG4gICAqL1xuICBpc0JyZWFrKCkge1xuICAgIHJldHVybiB0aGlzLm1vZGUgPT09IFBPTU9fU0VTU0lPTl9NT0RFUy5MT05HX0JSRUFLIHx8IHRoaXMubW9kZSA9PT0gUE9NT19TRVNTSU9OX01PREVTLkJSRUFLO1xuICB9XG5cbiAgLyoqXG4gICAqIFRPRE9cbiAgICovXG4gIHJlb3JkZXJUYXNrcygpIHtcblxuICB9XG5cbiAgZ2V0UG9tb3NMZWZ0SW5TZXNzaW9uKCkge1xuICAgIGxldCBsZWZ0ID0gMDtcbiAgICB0aGlzLmFsbFRhc2tzLmZvckVhY2goKHRhc2spID0+IHtcbiAgICAgIGxlZnQgKz0gTWF0aC5tYXgodGFzay5wb21vc1JlcXVpcmVkIC0gdGFzay5wb21vc1VzZWQsIDApO1xuICAgIH0pO1xuICAgIHJldHVybiBsZWZ0O1xuICB9XG4gIHBhcnNlU2Vzc2lvbkZyb21PYmooc2Vzc2lvbl9vYmopIHtcbiAgICB0aGlzLmlkID0gc2Vzc2lvbl9vYmouaWQ7XG4gICAgdGhpcy5tb2RlID0gc2Vzc2lvbl9vYmoubW9kZTtcbiAgICB0aGlzLnRpbWUgPSBzZXNzaW9uX29iai50aW1lO1xuICAgIHRoaXMucG9tb3NFbGFwc2VkID0gc2Vzc2lvbl9vYmoucG9tb3NFbGFwc2VkO1xuICAgIHRoaXMuc3RhcnREYXRlID0gbmV3IERhdGUoc2Vzc2lvbl9vYmouc3RhcnREYXRlKTtcbiAgICB0aGlzLmFsbFRhc2tzID0gc2Vzc2lvbl9vYmouYWxsVGFza3MubWFwKCh0YXNrT2JqKSA9PiB7XG4gICAgICBsZXQgdCA9IG5ldyBUYXNrKCk7XG4gICAgICB0ID0gdC5wYXJzZVRhc2tGcm9tT2JqKHRhc2tPYmopO1xuICAgICAgcmV0dXJuIHQ7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgc2VyaWFsaXplSW50b09iaigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IHRoaXMuaWQsIGFsbFRhc2tzOiB0aGlzLmFsbFRhc2tzLm1hcCgodGFzaykgPT4gdGFzay5zZXJpYWxpemVJbnRvT2JqKCkpLCBtb2RlOiB0aGlzLm1vZGUsIHRpbWU6IHRoaXMudGltZSwgcG9tb3NFbGFwc2VkOiB0aGlzLnBvbW9zRWxhcHNlZCwgc3RhcnREYXRlOiB0aGlzLnN0YXJ0RGF0ZS5nZXRUaW1lKClcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogR2V0IGEgcG9tbyBzZXNzaW9uIG9iamVjdFxuICogQHBhcmFtIHtudW1iZXJ9IGlkIFxuICogQHJldHVybnMge1BvbW9TZXNzaW9uIHwgbnVsbH0gdGhlIHNlc3Npb24gZm9yIHRoaXMgaWQgb3IgbnVsbCBpZiB0aGVyZSBpcyBubyBzZXNzaW9uIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGlkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQb21vU2Vzc2lvbihpZCkge1xuICBjb25zdCBhbGxTZXNzaW9ucyA9IGdldE9iamVjdChQT01PX1NFU1NJT05fTUFQKTtcbiAgbGV0IHAgPSBuZXcgUG9tb1Nlc3Npb24oKTtcbiAgaWYgKCFhbGxTZXNzaW9uc1tpZF0pIHJldHVybiBudWxsO1xuICByZXR1cm4gcC5wYXJzZVNlc3Npb25Gcm9tT2JqKGFsbFNlc3Npb25zW2lkXSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzdG9yZVBvbW9TZXNzaW9uKHNlc3Npb24pIHtcbiAgY29uc3QgYWxsU2Vzc2lvbnMgPSBnZXRPYmplY3QoUE9NT19TRVNTSU9OX01BUCk7XG4gIGFsbFNlc3Npb25zW3Nlc3Npb24uaWRdID0gc2Vzc2lvbi5zZXJpYWxpemVJbnRvT2JqKCk7XG4gIHN0b3JlT2JqZWN0KFBPTU9fU0VTU0lPTl9NQVAsIGFsbFNlc3Npb25zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE5ld1Nlc3Npb25JRCgpIHtcbiAgbGV0IHByZXZJRCA9IHBhcnNlSW50KGxvY2FsU3RvcmFnZS5nZXRJdGVtKFBPTU9fU0VTU0lPTl9JRCkpO1xuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShQT01PX1NFU1NJT05fSUQsIHByZXZJRCArIDEpO1xuICByZXR1cm4gcHJldklEO1xufVxuXG4vKipcbiAqIFNldCB0aGUgY3VycmVudCBzZXNzaW9uJ3Mgc3RhdHVzXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RhdHVzIC0gY2FuIGJlIFwiY29tcGxldGVcIiBvciBcImluLXByb2dyZXNzXCJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldEN1cnJlbnRTZXNzaW9uU3RhdHVzKHN0YXR1cykge1xuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShMQVRFU1RfUE9NT19TRVNTSU9OX1NUQVRVUywgc3RhdHVzKTtcbn1cblxuLyoqXG4gKiBXaWxsIHJldHVybiB0aGUgc2Vzc2lvbiBJRCBvZiB0aGUgbGFzdCBzZXNzaW9uIGlmIGl0IHdhcyBub3QgZW5kZWQuIE90aGVyd2lzZSBpZiB0aGUgbGFzdCBzZXNzaW9uIGRvZXMgbm90IGV4aXN0IFxuICogb3Igd2FzIGVuZGVkIGFscmVhZHksIHRoaXMgZnVuY3Rpb24gcmV0dXJucyBudWxsXG4gKiBcbiAqIEByZXR1cm5zIHtudW1iZXIgfCBudWxsfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGF0ZXN0U2Vzc2lvbklEKCkge1xuICBsZXQgc3RhdHVzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oTEFURVNUX1BPTU9fU0VTU0lPTl9TVEFUVVMpO1xuICBpZiAoc3RhdHVzID09PSBcImNvbXBsZXRlXCIpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gcGFyc2VJbnQobG9jYWxTdG9yYWdlLmdldEl0ZW0oUE9NT19TRVNTSU9OX0lEKSkgLSAxO1xuICB9XG59XG5cbi8qKlxuICogQHJldHVybnMge2Jvb2xlYW59IC0gdHJ1ZSBpZiB0aGVyZSBpcyBhIHVuZmluaXNoZWQgc2Vzc2lvbiB0aGF0IHdhcyBub3QgY29tcGxldGVkIG9yIHF1aXR0ZWQuIGZhbHNlIG90aGVyd2lzZVxuICovXG5leHBvcnQgZnVuY3Rpb24gdGhlcmVJc1VuZmluaXNoZWRTZXNzaW9uKCkge1xuICBsZXQgc2Vzc2lvbklEID0gZ2V0TGF0ZXN0U2Vzc2lvbklEKCk7XG4gIGlmIChzZXNzaW9uSUQgPT09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgbGV0IGN1cnJlbnRQb21vU2Vzc2lvbiA9IGdldFBvbW9TZXNzaW9uKHNlc3Npb25JRCk7XG4gIGlmIChjdXJyZW50UG9tb1Nlc3Npb24gIT09IG51bGwgJiYgY3VycmVudFBvbW9TZXNzaW9uLm1vZGUgIT09IFBPTU9fU0VTU0lPTl9NT0RFUy5DT01QTEVURSAmJiBjdXJyZW50UG9tb1Nlc3Npb24ubW9kZSAhPT0gUE9NT19TRVNTSU9OX01PREVTLklOQUNUSVZFKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29udGludWVBY3RpdmVTZXNzaW9uKCkge1xuICBpZiAodGhlcmVJc1VuZmluaXNoZWRTZXNzaW9uKCkpIHtcbiAgICB3aW5kb3cubG9jYXRpb24gPSBcIi90aW1lci5odG1sP2xvYWRTYXZlZD10cnVlXCI7XG4gIH1cbn0iLCJpbXBvcnQgeyBnZXRPYmplY3QsIHN0b3JlT2JqZWN0IH0gZnJvbSBcIi5cIjtcbmltcG9ydCB7IGdldExhdGVzdFNlc3Npb25JRCwgZ2V0UG9tb1Nlc3Npb24gfSBmcm9tIFwiLi9zZXNzaW9uXCI7XG5cbmV4cG9ydCBjbGFzcyBUYXNrIHtcbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc2Vzc2lvbklEIFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0aXRsZSBcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGVzY3JpcHRpb24gXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHBvbW9zUmVxdWlyZWQgXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc2Vzc2lvbklELCB0aXRsZSwgZGVzY3JpcHRpb24sIHBvbW9zUmVxdWlyZWQpIHtcbiAgICAgICAgdGhpcy5zZXNzaW9uSUQgPSBzZXNzaW9uSUQ7XG4gICAgICAgIHRoaXMuaWQgPSAtMTtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICAgIHRoaXMucG9tb3NSZXF1aXJlZCA9IHBvbW9zUmVxdWlyZWQ7XG4gICAgICAgIHRoaXMuY29tcGxldGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucG9tb3NVc2VkID0gMDtcbiAgICB9XG4gICAgcGFyc2VUYXNrRnJvbU9iaih0YXNrX29iaikge1xuICAgICAgICBsZXQgdGFzayA9IG5ldyBUYXNrKHRhc2tfb2JqLnNlc3Npb25JRCwgdGFza19vYmoudGl0bGUsIHRhc2tfb2JqLmRlc2NyaXB0aW9uLCB0YXNrX29iai5wb21vc1JlcXVpcmVkKTtcbiAgICAgICAgdGFzay5jb21wbGV0ZWQgPSB0YXNrX29iai5jb21wbGV0ZWQ7XG4gICAgICAgIHRhc2suaWQgPSB0YXNrX29iai5pZDtcbiAgICAgICAgdGFzay5wb21vc1VzZWQgPSB0YXNrX29iai5wb21vc1VzZWQ7XG4gICAgICAgIHJldHVybiB0YXNrO1xuICAgIH1cbiAgICBzZXJpYWxpemVJbnRvT2JqKCkge1xuICAgICAgICByZXR1cm4geyB0aXRsZTogdGhpcy50aXRsZSwgZGVzY3JpcHRpb246IHRoaXMuZGVzY3JpcHRpb24sIHBvbW9zUmVxdWlyZWQ6IHRoaXMucG9tb3NSZXF1aXJlZCwgY29tcGxldGVkOiB0aGlzLmNvbXBsZXRlZCwgcG9tb3NVc2VkOiB0aGlzLnBvbW9zVXNlZCwgaWQ6IHRoaXMuaWQsIHNlc3Npb25JRDogdGhpcy5zZXNzaW9uSUQgfTtcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBQT01PX1RBU0tfTUFQID0gXCJwb21vX3Rhc2tfbWFwXCI7XG5leHBvcnQgY29uc3QgUE9NT19UQVNLX0lOREVYID0gXCJwb21vX3Rhc2tfaW5kZXhcIjtcblxuLyoqXG4gKiBXaWxsIHN0b3JlIGEgbmV3IG9yIHVwZGF0ZWQgdGFzayBpbnRvIGxvY2FsIHN0b3JhZ2VcbiAqIFxuICogSGFzIGEgc2lkZSBlZmZlY3Qgb2YgYWRkaW5nIHRoZSBpZCBvZiB0aGUgbmV3IHRhc2sgaWYgaXQgd2FzbnQgc3RvcmVkIGluIHN0b3JhZ2UgYmVmb3JlXG4gKiBcbiAqIEBwYXJhbSB7VGFza30gdGFza1xuICogQHJldHVybnMge251bWJlcn0gLSB0aGUgaWQgb2YgdGhlIHRhc2tcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0b3JlVGFzayh0YXNrKSB7XG4gICAgbGV0IHRhc2tfbWFwID0gZ2V0T2JqZWN0KFBPTU9fVEFTS19NQVApO1xuICAgIGlmICghdGFza19tYXBbdGFzay5pZF0pIHtcbiAgICAgICAgLy8gaWYgdGFzayBtYXAgZG9lcyBub3QgaGF2ZSB0aGlzIHRhc2ssIGNyZWF0ZSBhIG5ldyBpbmRleFxuICAgICAgICBsZXQgaWQgPSBwYXJzZUludChnZXRPYmplY3QoUE9NT19UQVNLX0lOREVYKSk7XG4gICAgICAgIHRhc2suaWQgPSBpZDtcbiAgICAgICAgLy8gaW5jcmVtZW50IGdsb2JhbCBpZFxuICAgICAgICBzdG9yZU9iamVjdChQT01PX1RBU0tfSU5ERVgsIGlkICsgMSk7XG4gICAgfVxuICAgIGxldCBvYmogPSB0YXNrLnNlcmlhbGl6ZUludG9PYmooKTtcbiAgICB0YXNrX21hcFt0YXNrLmlkXSA9IG9iajtcbiAgICBzdG9yZU9iamVjdChQT01PX1RBU0tfTUFQLCB0YXNrX21hcCk7XG4gICAgcmV0dXJuIHRhc2suaWQ7XG59XG5cbi8qKlxuICogR2V0IHRoZSB0YXNrIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gaWQgXG4gKiBAcmV0dXJucyB7VGFza31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRhc2soaWQpIHtcbiAgICBsZXQgdGFza19tYXAgPSBnZXRPYmplY3QoUE9NT19UQVNLX01BUCk7XG4gICAgbGV0IHRhc2tfb2JqID0gdGFza19tYXBbaWRdO1xuICAgIGxldCB0ID0gbmV3IFRhc2soKTtcbiAgICB0ID0gdC5wYXJzZVRhc2tGcm9tT2JqKHRhc2tfb2JqKTtcbiAgICByZXR1cm4gdDtcblxufVxuLyoqXG4gKiBHZXQgYWxsIHRhc2tzXG4gKiBcbiAqIEByZXR1cm5zIHtNYXA8bnVtYmVyLCBUYXNrPn0gLSBhIG1hcCBmcm9tIHRhc2sgaWQgdG8gdGFza1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWxsVGFza3MoKSB7XG4gICAgbGV0IHRhc2tfbWFwID0gZ2V0T2JqZWN0KFBPTU9fVEFTS19NQVApO1xuICAgIGxldCBwYXJzZWRfdGFza19tYXAgPSB7fTtcbiAgICBmb3IgKGxldCBpZCBpbiB0YXNrX21hcCkge1xuICAgICAgICBsZXQgdGFza19vYmogPSB0YXNrX21hcFtpZF07XG4gICAgICAgIGxldCB0ID0gbmV3IFRhc2soKTtcbiAgICAgICAgdCA9IHQucGFyc2VUYXNrRnJvbU9iaih0YXNrX29iaik7XG4gICAgICAgIHBhcnNlZF90YXNrX21hcFtpZF0gPSB0O1xuICAgIH1cbiAgICByZXR1cm4gcGFyc2VkX3Rhc2tfbWFwO1xufVxuXG4vKipcbiAqIERlbGV0ZSBhIHNwZWNpZmljIHRhc2sgZnJvbSBkYXRhYmFzZSBieSB0aGUgdW5pcXVlIHRhc2sgSURcbiAqIFxuICogQHBhcmFtIHtudW1iZXJ9IGlkIFxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVsZXRlVGFza0J5VGFza0lEKGlkKSB7XG4gICAgbGV0IHRhc2tfbWFwID0gZ2V0T2JqZWN0KFBPTU9fVEFTS19NQVApO1xuICAgIGRlbGV0ZSB0YXNrX21hcFtpZF07XG4gICAgc3RvcmVPYmplY3QoUE9NT19UQVNLX01BUCwgdGFza19tYXApO1xufVxuXG5cbi8qKlxuICogQ2hlY2tzIGlmIHRoZXJlIGFyZSBhbnkgdW5maW5pc2hlZCB0YXNrcyBmcm9tIHRoZSBwcmV2aW91cyBzZXNzaW9uXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSB0cnVlIGlmIHVuaWZpbmlzaGVkIHRhc2tzIGV4aXN0LCBmYWxzZSBvdGhlcndpc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFyZVRoZXJlVW5maW5pc2hlZFRhc2tzRnJvbUxhc3RTZXNzaW9uKCkge1xuICAgIGxldCBvbGRTZXNzaW9uSUQgPSBnZXRMYXRlc3RTZXNzaW9uSUQoKTtcbiAgICBpZiAob2xkU2Vzc2lvbklEID09PSBudWxsKSByZXR1cm4gZmFsc2U7XG4gICAgbGV0IHNlc3Npb24gPSBnZXRQb21vU2Vzc2lvbihvbGRTZXNzaW9uSUQpO1xuICAgIGlmIChzZXNzaW9uID09PSBudWxsKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKHNlc3Npb24uY3VycmVudFRhc2soKSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0aWYoX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSkge1xuXHRcdHJldHVybiBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLyoqXG4gKiBXaWxsIHJhbmRvbWx5IHBpY2sgYSB0aGVtZSBhbmQgdW5pcXVlIGJhY2tncm91bmQgZGVwZW5kaW5nIG9uIHdoYXQgZGF5IGl0IGlzIGFuZCB3aGF0IHRpbWUgaXQgaXMgYW5kIHNldCBpdCBvbiB0aGUgcGFnZVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2VsZWN0QW5kU2V0VGhlbWUodG9kYXkgPSBuZXcgRGF0ZSgpKSB7XG4gIGxldCBpZCA9IDA7XG4gIGxldCBudW1CR3MgPSA2O1xuXG4gIGxldCBkID0gdG9kYXkuZ2V0RGF5KCk7XG5cbiAgbGV0IHNlZWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImJnLXNlZWRcIik7XG5cbiAgaWYgKHNlZWQgPT09IG51bGwgfHwgc2VlZFswXSAhPSBkKSB7XG4gICAgc2VlZCA9IGQgKyBcIi1cIiArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG51bUJHcyk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJiZy1zZWVkXCIsIHNlZWQpO1xuICB9XG4gIGxldCB0aW1lUGVyaW9kID0gZ2V0VGhlbWVNb2RlKHRvZGF5KTtcbiAgaWQgPSBwYXJzZUludChzZWVkWzJdKTtcblxuICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmFja2Ryb3BcIik7XG4gIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybChcIi4uL2Fzc2V0cy9pbWFnZXMvYmFja2dyb3VuZHMvJHt0aW1lUGVyaW9kfS9iZyR7aWR9LmpwZ1wiKWA7XG59O1xuXG5leHBvcnQgY29uc3QgVEhFTUVfTU9ERVMgPSB7XG4gIERBWTogXCJkYXlcIixcbiAgTklHSFQ6IFwibmlnaHRcIixcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUaGVtZU1vZGUodG9kYXkgPSBuZXcgRGF0ZSgpKSB7XG4gIGxldCB0aW1lUGVyaW9kID0gVEhFTUVfTU9ERVMuREFZO1xuICBpZiAodG9kYXkuZ2V0SG91cnMoKSA8IDQpIHtcbiAgICB0aW1lUGVyaW9kID0gVEhFTUVfTU9ERVMuTklHSFQ7XG4gIH1cbiAgZWxzZSBpZiAodG9kYXkuZ2V0SG91cnMoKSA8IDE4KSB7XG4gICAgdGltZVBlcmlvZCA9IFRIRU1FX01PREVTLkRBWTtcbiAgfSBlbHNlIGlmICh0b2RheS5nZXRIb3VycygpIDwgMjQpIHtcbiAgICB0aW1lUGVyaW9kID0gVEhFTUVfTU9ERVMuTklHSFQ7XG4gIH1cbiAgcmV0dXJuIHRpbWVQZXJpb2Q7XG59IiwiaW1wb3J0IHsgaW5pdGlhbGl6ZURhdGFiYXNlIH0gZnJvbSBcIi4vZGF0YWJhc2VcIjtcbmltcG9ydCB7IGNvbnRpbnVlQWN0aXZlU2Vzc2lvbiB9IGZyb20gXCIuL2RhdGFiYXNlL3Nlc3Npb25cIjtcbmltcG9ydCB7IGFyZVRoZXJlVW5maW5pc2hlZFRhc2tzRnJvbUxhc3RTZXNzaW9uIH0gZnJvbSBcIi4vZGF0YWJhc2UvdGFza1wiO1xuaW1wb3J0IHsgc2VsZWN0QW5kU2V0VGhlbWUgfSBmcm9tIFwiLi91dGlscy90aGVtZVwiO1xud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcbiAgICAvLyBjcmVhdGUgZXhhbXBsZSBidXR0b24gaSBndWVzc1xuICAgIGluaXRpYWxpemVEYXRhYmFzZSgpO1xuICAgIGNvbnRpbnVlQWN0aXZlU2Vzc2lvbigpO1xuICAgIHNlbGVjdEFuZFNldFRoZW1lKCk7XG4gICAgbGV0IG9sZFRhc2tzTGVmdCA9IGFyZVRoZXJlVW5maW5pc2hlZFRhc2tzRnJvbUxhc3RTZXNzaW9uKCk7XG4gICAgaWYgKCFvbGRUYXNrc0xlZnQpIHtcbiAgICAgICAgY29uc29sZS5sb2coZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsZWZ0b3Zlci10YXNrcy13cmFwcGVyXCIpKTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsZWZ0b3Zlci10YXNrcy13cmFwcGVyXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICB9XG59KTtcbiJdLCJzb3VyY2VSb290IjoiIn0=