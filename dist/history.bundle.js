(()=>{"use strict";var e={409:(e,t,o)=>{o.d(t,{xN:()=>r,RK:()=>l});var s=o(594),a=o(771);function r(){var e=!1;null===l(s.Rd)&&(e=!0),null===l(s.oi)&&(e=!0),null===!localStorage.getItem(a.Do)&&(e=!0),null===!localStorage.getItem(a.mn)&&(e=!0),null===l(a.XB)&&(e=!0),e&&(n(s.Rd,{}),n(s.oi,0),n(a.mn,"complete"),n(a.Do,0),n(a.XB,{}))}function n(e,t){localStorage.setItem(e,JSON.stringify(t))}function l(e){return JSON.parse(localStorage.getItem(e))}},771:(e,t,o)=>{o.d(t,{Do:()=>s,mn:()=>a,XB:()=>r,RU:()=>n}),o(409),o(594);var s="pomo_session_id",a="latest_pomo_session_status",r="pomo_session_map";function n(){return"complete"===localStorage.getItem(a)?null:parseInt(localStorage.getItem(s))-1}},594:(e,t,o)=>{o.d(t,{Rd:()=>s,oi:()=>a}),o(409),o(771);var s="pomo_task_map",a="pomo_task_index"}},t={};function o(s){if(t[s])return t[s].exports;var a=t[s]={exports:{}};return e[s](a,a.exports,o),a.exports}o.d=(e,t)=>{for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=o(409),t=o(771),s=function o(s){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.date=s,this.tasks={},this.greenTasks=0,this.yellowTasks=0,this.redTasks=0;for(var r=(0,t.RU)(),n=0;-1!=r;){var l=new Date((0,e.RK)(t.XB)[r].startDate);if(this.date.getMonth()===l.getMonth()&&this.date.getDate()===l.getDate()&&this.date.getYear()===l.getYear())Object.keys((0,e.RK)(t.XB)[r].allTasks).forEach((function(o){return a.tasks[n++]=(0,e.RK)(t.XB)[r].allTasks[o]}));else if(this.date.getMonth()>l.getMonth()||this.date.getDate()>l.getDate()||this.date.getYear()>l.getYear())break;r-=1}for(var d in this.tasks)this.tasks[d].completed?this.tasks[d].pomosUsed<=this.tasks[d].pomosRequired?this.greenTasks+=1:this.yellowTasks+=1:this.redTasks+=1},a="day",r="night";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=a;return e.getHours()<4?t=r:e.getHours()<18?t=a:e.getHours()<24&&(t=r),t}window.addEventListener("DOMContentLoaded",(function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=0,o=6,s=e.getDay(),a=localStorage.getItem("bg-seed");null!==a&&a[0]==s||(a=s+"-"+Math.floor(Math.random()*o),localStorage.setItem("bg-seed",a));var r=n(e);t=parseInt(a[2]),document.getElementById("backdrop").style.backgroundImage='url("../assets/images/backgrounds/'.concat(r,"/bg").concat(t,'.jpg")')}(),(0,e.xN)();var t=new s(new Date),o=document.getElementById("taskList");for(var a in t.tasks){var r=t.tasks[a],l='<pomo-task description ="'.concat(r.description,'" pomosUsed="').concat(r.pomosUsed,'", pomosRequired ="').concat(r.pomosRequired,'">').concat(r.title,"</pomo-task>");o.insertAdjacentHTML("beforeend",l);var d=o.childNodes[o.childNodes.length-1];d.task=r,d.shadowRoot.childNodes[0].childNodes[0].childNodes[3].style.display="none",d.shadowRoot.childNodes[0].childNodes[0].childNodes[2].style.display="none",r.completed?r.pomosUsed<=r.pomosRequired?d.shadowRoot.childNodes[0].childNodes[0].childNodes[1].childNodes[0].setAttribute("class","goodTimingTask"):d.shadowRoot.childNodes[0].childNodes[0].childNodes[1].childNodes[0].setAttribute("class","badTimingTask"):d.shadowRoot.childNodes[0].childNodes[0].childNodes[1].childNodes[0].setAttribute("class","incompleteTask")}var i={complete:t.greenTasks,overtime:t.yellowTasks,incomplete:t.redTasks};!function(e,t){var o=e.getContext("2d"),s=["#22DD9A","#F9C644","#FA7F7F"];new Chart(o,{type:"bar",data:{labels:["Tasks Completed on Time","Tasks Completed over Time","Tasks Incomplete"],datasets:[{label:"# of Tasks",data:[t.complete,t.overtime,t.incomplete],backgroundColor:s,borderColor:s,borderWidth:1}]},options:{legend:!1,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}(document.getElementById("efficiency-chart"),i);var c=document.getElementById("efficiency-weekly-chart"),h=function(){for(var e=[],t=0;t<7;t++){var o=new Date;o.setDate(o.getDate()-t),e.push(o)}return e}();h.reverse();var m=[],g=[];for(var p in h)m.push(new Date(h[p]).getMonth()+"/"+new Date(h[p]).getDate()),g.push(new s(new Date(h[p])));var u,k,v,f,b=[],T=[],y=[];for(var w in g)b.push(g[w].greenTasks),T.push(g[w].yellowTasks),y.push(g[w].redTasks);u={complete:b,overtime:T,incomplete:y},k=m,v=c.getContext("2d"),f=["Tasks Completed on Time","Tasks Completed over Time","Tasks Incomplete"],new Chart(v,{type:"line",data:{labels:k,datasets:[{label:f[0],borderColor:"#22DD9A",backgroundColor:"transparent",data:u.complete},{label:f[1],borderColor:"#F9C644",backgroundColor:"transparent",data:u.overtime},{label:f[2],borderColor:"#FA7F7F",backgroundColor:"transparent",data:u.incomplete}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jc2UxMTAtdzIxLWdyb3VwMjEvLi9zb3VyY2UvYXNzZXRzL3NjcmlwdHMvZGF0YWJhc2UvaW5kZXguanMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxLy4vc291cmNlL2Fzc2V0cy9zY3JpcHRzL2RhdGFiYXNlL3Nlc3Npb24uanMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxLy4vc291cmNlL2Fzc2V0cy9zY3JpcHRzL2RhdGFiYXNlL3Rhc2suanMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2NzZTExMC13MjEtZ3JvdXAyMS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vY3NlMTEwLXcyMS1ncm91cDIxLy4vc291cmNlL2Fzc2V0cy9zY3JpcHRzL2RhdGFiYXNlL3N0YXRzLmpzIiwid2VicGFjazovL2NzZTExMC13MjEtZ3JvdXAyMS8uL3NvdXJjZS9hc3NldHMvc2NyaXB0cy91dGlscy90aGVtZS5qcyIsIndlYnBhY2s6Ly9jc2UxMTAtdzIxLWdyb3VwMjEvLi9zb3VyY2UvYXNzZXRzL3NjcmlwdHMvaGlzdG9yeS5qcyIsIndlYnBhY2s6Ly9jc2UxMTAtdzIxLWdyb3VwMjEvLi9zb3VyY2UvYXNzZXRzL3NjcmlwdHMvaGlzdG9yeS1ncmFwaC5qcyJdLCJuYW1lcyI6WyJpbml0aWFsaXplRGF0YWJhc2UiLCJuZWVkVG9Jbml0aWFsaXplIiwiZ2V0T2JqZWN0IiwiUE9NT19UQVNLX01BUCIsIlBPTU9fVEFTS19JTkRFWCIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJQT01PX1NFU1NJT05fSUQiLCJMQVRFU1RfUE9NT19TRVNTSU9OX1NUQVRVUyIsIlBPTU9fU0VTU0lPTl9NQVAiLCJzdG9yZU9iamVjdCIsImtleSIsIm9iamVjdCIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwicGFyc2UiLCJnZXRMYXRlc3RTZXNzaW9uSUQiLCJwYXJzZUludCIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiZCIsImRlZmluaXRpb24iLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlBvbW9TdGF0cyIsImRhdGUiLCJ0aGlzIiwidGFza3MiLCJncmVlblRhc2tzIiwieWVsbG93VGFza3MiLCJyZWRUYXNrcyIsImlkIiwiY291bnRlciIsInNlc3Npb25fb2JqZWN0X2RhdGUiLCJEYXRlIiwiZ2V0TW9udGgiLCJnZXREYXRlIiwiZ2V0WWVhciIsImtleXMiLCJmb3JFYWNoIiwidGFza0lEIiwiY29tcGxldGVkIiwicG9tb3NVc2VkIiwicG9tb3NSZXF1aXJlZCIsIlRIRU1FX01PREVTIiwiZ2V0VGhlbWVNb2RlIiwidG9kYXkiLCJ0aW1lUGVyaW9kIiwiZ2V0SG91cnMiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwibnVtQkdzIiwiZ2V0RGF5Iiwic2VlZCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsInNlbGVjdEFuZFNldFRoZW1lIiwic3RhdHMiLCJ0YXNrTGlzdCIsInRhc2siLCJjdXJyZW50VGFza0VsZW1lbnQiLCJkZXNjcmlwdGlvbiIsInRpdGxlIiwiaW5zZXJ0QWRqYWNlbnRIVE1MIiwiZWxlbWVudCIsImNoaWxkTm9kZXMiLCJsZW5ndGgiLCJzaGFkb3dSb290IiwiZGlzcGxheSIsInNldEF0dHJpYnV0ZSIsImRhdGEiLCJjb21wbGV0ZSIsIm92ZXJ0aW1lIiwiaW5jb21wbGV0ZSIsImNoYXJ0ZWxlbWVudCIsImN0eCIsImdldENvbnRleHQiLCJjb2xvcnMiLCJDaGFydCIsInR5cGUiLCJsYWJlbHMiLCJkYXRhc2V0cyIsImxhYmVsIiwiYmFja2dyb3VuZENvbG9yIiwiYm9yZGVyQ29sb3IiLCJib3JkZXJXaWR0aCIsIm9wdGlvbnMiLCJsZWdlbmQiLCJzY2FsZXMiLCJ5QXhlcyIsInRpY2tzIiwiYmVnaW5BdFplcm8iLCJyZW5kZXJFZmZpY2llbmN5RGF0YSIsImNhbnZhczIiLCJzZXZlbkRhdGVzIiwiZGF0ZXMiLCJpIiwic2V0RGF0ZSIsInB1c2giLCJkYXRlc0ZvclNldmVuRGF5cyIsInJldmVyc2UiLCJkYXRlc0ZvckdyYXBoIiwid2Vla1N0YXRzIiwiZGF0ZUlEIiwid2Vla2x5RGF0YSIsImNvbXBsZXRlV2VlayIsIm92ZXJUaW1lV2VlayIsImluY29tcGxldGVXZWVrIiwic3RhdElEIl0sIm1hcHBpbmdzIjoieUZBR08sU0FBU0EsSUFFWixJQUFJQyxHQUFtQixFQUNVLE9BQTdCQyxFQUFVQyxRQUNWRixHQUFtQixHQUVZLE9BQS9CQyxFQUFVRSxRQUNWSCxHQUFtQixHQUV3QixRQUExQ0ksYUFBYUMsUUFBUUMsUUFDdEJOLEdBQW1CLEdBRW1DLFFBQXJESSxhQUFhQyxRQUFRRSxRQUN0QlAsR0FBbUIsR0FFYSxPQUFoQ0MsRUFBVU8sUUFDVlIsR0FBbUIsR0FJbkJBLElBQ0FTLEVBQVlQLEtBQWUsSUFDM0JPLEVBQVlOLEtBQWlCLEdBQzdCTSxFQUFZRixLQUE0QixZQUN4Q0UsRUFBWUgsS0FBaUIsR0FDN0JHLEVBQVlELEtBQWtCLEtBVy9CLFNBQVNDLEVBQVlDLEVBQUtDLEdBQzdCUCxhQUFhUSxRQUFRRixFQUFLRyxLQUFLQyxVQUFVSCxJQUV0QyxTQUFTVixFQUFVUyxHQUN0QixPQUFPRyxLQUFLRSxNQUFNWCxhQUFhQyxRQUFRSyxNLHlFQ3BDcEMsSUFBTUosRUFBa0Isa0JBQ2xCQyxF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LFdBQVlrQyxHQ2JpRFosRURlakJNLEVDZDVDMUIsRURjdUJrQixFQ2RKakIsV0FBVyxNQUM5QkksRUFBUyxDQUFDLDBCQUEyQiw0QkFBNkIsb0JBRXhELElBQUlGLE1BQU1ILEVBQUssQ0FDekJJLEtBQU0sT0FDTlQsS0FBTSxDQUNGVSxPQUFRZSxFQUNSZCxTQUFVLENBQUMsQ0FDUEMsTUFBT0YsRUFBTyxHQUNkSSxZQUFhLFVBQ2JELGdCQUFpQixjQUNqQmIsS0FBTWtDLEVBQVdqQyxVQUNsQixDQUNDVyxNQUFPRixFQUFPLEdBQ2RJLFlBQWEsVUFDYkQsZ0JBQWlCLGNBQ2pCYixLQUFNa0MsRUFBV2hDLFVBQ2xCLENBQ0NVLE1BQU9GLEVBQU8sR0FDZEksWUFBYSxVQUNiRCxnQkFBaUIsY0FDakJiLEtBQU1rQyxFQUFXL0IsY0FHekJhLFFBQVMsQ0FDTEUsT0FBUSxDQUNKQyxNQUFPLENBQUMsQ0FDSkMsTUFBTyxDQUNIQyxhQUFhLGEiLCJmaWxlIjoiaGlzdG9yeS5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQT01PX1RBU0tfSU5ERVgsIFBPTU9fVEFTS19NQVAgfSBmcm9tIFwiLi90YXNrXCI7XG5pbXBvcnQgeyBQT01PX1NFU1NJT05fSUQsIExBVEVTVF9QT01PX1NFU1NJT05fU1RBVFVTLCBQT01PX1NFU1NJT05fTUFQIH0gZnJvbSBcIi4vc2Vzc2lvblwiO1xuXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZURhdGFiYXNlKCkge1xuICAgIC8vIGNoZWNrIGlmIHdlIG5lZWQgdG8gaW5pdGlhbGl6ZVxuICAgIGxldCBuZWVkVG9Jbml0aWFsaXplID0gZmFsc2U7XG4gICAgaWYgKGdldE9iamVjdChQT01PX1RBU0tfTUFQKSA9PT0gbnVsbCkge1xuICAgICAgICBuZWVkVG9Jbml0aWFsaXplID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGdldE9iamVjdChQT01PX1RBU0tfSU5ERVgpID09PSBudWxsKSB7XG4gICAgICAgIG5lZWRUb0luaXRpYWxpemUgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoIWxvY2FsU3RvcmFnZS5nZXRJdGVtKFBPTU9fU0VTU0lPTl9JRCkgPT09IG51bGwpIHtcbiAgICAgICAgbmVlZFRvSW5pdGlhbGl6ZSA9IHRydWU7XG4gICAgfVxuICAgIGlmICghbG9jYWxTdG9yYWdlLmdldEl0ZW0oTEFURVNUX1BPTU9fU0VTU0lPTl9TVEFUVVMpID09PSBudWxsKSB7XG4gICAgICAgIG5lZWRUb0luaXRpYWxpemUgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoZ2V0T2JqZWN0KFBPTU9fU0VTU0lPTl9NQVApID09PSBudWxsKSB7XG4gICAgICAgIG5lZWRUb0luaXRpYWxpemUgPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIHRoZW4gaW5pdGlhbGl6ZVxuICAgIGlmIChuZWVkVG9Jbml0aWFsaXplKSB7XG4gICAgICAgIHN0b3JlT2JqZWN0KFBPTU9fVEFTS19NQVAsIHt9KTtcbiAgICAgICAgc3RvcmVPYmplY3QoUE9NT19UQVNLX0lOREVYLCAwKTtcbiAgICAgICAgc3RvcmVPYmplY3QoTEFURVNUX1BPTU9fU0VTU0lPTl9TVEFUVVMsIFwiY29tcGxldGVcIik7XG4gICAgICAgIHN0b3JlT2JqZWN0KFBPTU9fU0VTU0lPTl9JRCwgMCk7XG4gICAgICAgIHN0b3JlT2JqZWN0KFBPTU9fU0VTU0lPTl9NQVAsIHt9KTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gcmVzZXREYXRhYmFzZSgpIHtcbiAgICBkZWxldGUgbG9jYWxTdG9yYWdlW1BPTU9fVEFTS19NQVBdO1xuICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2VbUE9NT19UQVNLX0lOREVYXTtcbiAgICBkZWxldGUgbG9jYWxTdG9yYWdlW0xBVEVTVF9QT01PX1NFU1NJT05fU1RBVFVTXTtcbiAgICBkZWxldGUgbG9jYWxTdG9yYWdlW1BPTU9fU0VTU0lPTl9JRF07XG4gICAgZGVsZXRlIGxvY2FsU3RvcmFnZVtQT01PX1NFU1NJT05fTUFQXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0b3JlT2JqZWN0KGtleSwgb2JqZWN0KSB7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeShvYmplY3QpKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRPYmplY3Qoa2V5KSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSk7XG59IiwiLyoqXG4gKiBUaGlzIGZpbGUgaXMgcmVsYXRlZCB0byBmaW5kaW5nIHBvbW8gc2Vzc2lvbnNcbiAqL1xuaW1wb3J0IHsgZ2V0T2JqZWN0LCBzdG9yZU9iamVjdCB9IGZyb20gXCIuL2luZGV4XCI7XG5pbXBvcnQgeyBkZWxldGVUYXNrQnlUYXNrSUQsIHN0b3JlVGFzaywgVGFzayB9IGZyb20gXCIuL3Rhc2tcIjtcblxuXG5leHBvcnQgY29uc3QgUE9NT19TRVNTSU9OX0lEID0gXCJwb21vX3Nlc3Npb25faWRcIjtcbmV4cG9ydCBjb25zdCBMQVRFU1RfUE9NT19TRVNTSU9OX1NUQVRVUyA9IFwibGF0ZXN0X3BvbW9fc2Vzc2lvbl9zdGF0dXNcIjtcbmV4cG9ydCBjb25zdCBQT01PX1NFU1NJT05fTUFQID0gXCJwb21vX3Nlc3Npb25fbWFwXCI7XG5cbi8qKiB0aGUgZGlmZmVyZW50IHBvbW8gc2Vzc2lvbiBtb2RlcyBhcyBjb25zdGFudHMgKi9cbmV4cG9ydCBjb25zdCBQT01PX1NFU1NJT05fTU9ERVMgPSB7XG4gIC8qKiB3aGVuIHRoZSB1c2VyIGlzIGluIHRoZSBpbnRlcmZhY2Ugb2YgY3JlYXRpbmcgYSBuZXcgdGltZXIgYW5kIGhhcyBub3Qgc3RhcnRlZCB0aGVpciBuZXcgc2Vzc2lvbiB5ZXQgKi9cbiAgSU5BQ1RJVkU6IFwiaW5hY3RpdmVcIixcbiAgLyoqIHdoZW4gcnVubmluZyB0aGUgYnJlYWsgdGltZXIgKi9cbiAgQlJFQUs6IFwiYnJlYWtcIixcbiAgLyoqIHdoZW4gcnVubmluZyB0aGUgbG9uZ2VyIGJyZWFrIHRpbWVyICovXG4gIExPTkdfQlJFQUs6IFwibG9uZ2JyZWFrXCIsXG4gIC8qKiB3aGVuIHJ1bm5pbmcgdGhlIGFjdGl2ZSBwb21vIHdvcmsgdGltZSAqL1xuICBBQ1RJVkU6IFwiYWN0aXZlXCIsXG4gIC8qKiB3aGVuIHRoZSB1c2VyIG1hcmtzIHRoaXMgcG9tbyBzZXNzaW9uIGFzIGNvbXBsZXRlLCByZWdhcmRsZXNzIG9mIHdoZXRoZXIgdGFza3MgYXJlIGNvbXBsZXRlZCBvciBub3QgKi9cbiAgQ09NUExFVEU6IFwiY29tcGxldGVcIixcbn07XG5cbmV4cG9ydCBjbGFzcyBQb21vU2Vzc2lvbiB7XG4gIC8qKlxuICAgKiBDcmVhdGUgYSBuZXcgUG9tbyBTZXNzaW9uIG9iamVjdFxuICAgKiBAcGFyYW0ge251bWJlcn0gaWQgLSBpZCBvZiB0aGlzIHNlc3Npb25cbiAgICovXG4gIGNvbnN0cnVjdG9yKGlkKSB7XG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIC8qKiBAdHlwZSB7VGFza1tdfSAtIGEgbGlzdCBvZiBhbGwgdGFza3MgYXNzb2NpYXRlZCB3aXRoIHRoaXMgc2Vzc2lvbiAqL1xuICAgIHRoaXMuYWxsVGFza3MgPSBbXTtcbiAgICAvKiogQHR5cGUge3N0cmluZ30gLSB0aGUgY3VycmVudCBtb2RlIG9mIHRoZSBwb21vIHNlc3Npb24gKi9cbiAgICB0aGlzLm1vZGUgPSBQT01PX1NFU1NJT05fTU9ERVMuSU5BQ1RJVkU7XG4gICAgLyoqIEB0eXBlIHtOdW1iZXJ9IC0gdGhlIGN1cnJlbnQgdGltZSBvZiB0aGUgcG9tbyBzZXNzaW9uICovXG4gICAgdGhpcy50aW1lID0gMDtcblxuICAgIC8qKiBAdHlwZSB7TnVtYmVyfSAtIG51bWJlciBvZiBwb21vcyBlbGFwc2VkIHN1Y2Nlc2Z1bGx5IGZvciB0aGlzIHBvbW8gc2Vzc2lvbiAqL1xuICAgIHRoaXMucG9tb3NFbGFwc2VkID0gMDtcblxuICAgIHRoaXMuc3RhcnREYXRlID0gbmV3IERhdGUoKTtcbiAgfVxuICAvKipcbiAgICogXG4gICAqIEByZXR1cm5zIHtUYXNrIHwgbnVsbCB9IC0gdGhlIGN1cnJlbnQgdGFzayBmb3IgdGhpcyBwb21vIHNlc3Npb24gb3IgbnVsbCBpZiB0aGVyZSBhcmUgbm8gdGFza3MgbGVmdFxuICAgKi9cbiAgY3VycmVudFRhc2soKSB7XG4gICAgbGV0IGFsbEluUHJvZ3Jlc3NUYXNrcyA9IHRoaXMuYWxsVGFza3MuZmlsdGVyKCh0YXNrKSA9PiAhdGFzay5jb21wbGV0ZWQpO1xuICAgIGlmIChhbGxJblByb2dyZXNzVGFza3MubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gYWxsSW5Qcm9ncmVzc1Rhc2tzWzBdO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICAvKipcbiAgICogQWRkcyBhIG5ldyB0YXNrXG4gICAqIEBwYXJhbSB7VGFza30gdGFzayBcbiAgICovXG4gIGFkZFRhc2sodGFzaykge1xuICAgIHN0b3JlVGFzayh0YXNrKTtcbiAgICB0aGlzLmFsbFRhc2tzLnB1c2godGFzayk7XG4gIH1cbiAgLyoqXG4gICAqIERlbGV0ZSBhIHRhc2tcbiAgICogQHBhcmFtIHtUYXNrfSB0YXNrIFxuICAgKi9cbiAgZGVsZXRlVGFzayh0YXNrKSB7XG4gICAgZGVsZXRlVGFza0J5VGFza0lEKHRhc2suaWQpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5hbGxUYXNrcy5sZW5ndGg7IGkrKyl7XG4gICAgICBjb25zdCBzdG9yZWRUYXNrID0gdGhpcy5hbGxUYXNrc1tpXTtcbiAgICAgIGlmICh0YXNrLmlkID09PSBzdG9yZWRUYXNrLmlkKSB7XG4gICAgICAgIHRoaXMuYWxsVGFza3Muc3BsaWNlKGksIDEpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENvbXBsZXRlcyB0aGUgZ2l2ZW4gdGFzayBhc3NvY2lhdGVkIHRvIHRoZSBpZFxuICAgKiBAcGFyYW0ge251bWJlcn0gaWQgXG4gICAqIEByZXR1cm5zIHtib29sZWFufSB0cnVlIGlmIGNvbXBsZXRlZCwgZmFsc2UgaWYgbm8gdGFzayBmb3VuZFxuICAgKi9cbiAgY29tcGxldGVUYXNrKGlkKSB7XG4gICAgZm9yIChsZXQgdGFzayBvZiB0aGlzLmFsbFRhc2tzKSB7XG4gICAgICBpZiAodGFzay5pZCA9PT0gaWQpIHtcbiAgICAgICAgdGFzay5jb21wbGV0ZWQgPSB0cnVlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBuZXh0IGluY29tcGxldGUgdGFzayBpbiB0aGUgb3JkZXIgb3IgbnVsbCBpZiBhbGwgY29tcGxldGVkXG4gICAqIEByZXR1cm5zIHtUYXNrIHwgbnVsbH1cbiAgICovXG4gIGdldE5leHRUYXNrKCkge1xuICAgIGZvciAoY29uc3QgdGFzayBvZiB0aGlzLmFsbFRhc2tzKSB7XG4gICAgICBpZiAodGFzay5jb21wbGV0ZWQgPT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybiB0YXNrO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICAvKipcbiAgICogSW5jcmVtZW50IHRoZSBwb21vcyB1c2VkIGZvciBhIHRhc2sgYW5kIGluY3JlbWVudCBwb21vc0VsYXBzZWRcbiAgICogQHBhcmFtIHtudW1iZXJ9IGlkIFxuICAgKi9cbiAgaW5jcmVtZW50VGFza1BvbW9zVXNlZChpZCkge1xuICAgIGZvciAoY29uc3QgdGFzayBvZiB0aGlzLmFsbFRhc2tzKSB7XG4gICAgICBpZiAodGFzay5pZCA9PT0gaWQpIHtcbiAgICAgICAgdGFzay5wb21vc1VzZWQgKz0gMTtcbiAgICAgICAgdGhpcy5wb21vc0VsYXBzZWQgKz0gMTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBcbiAgICogQHJldHVybnMgdHJ1ZSBpZiBzZXNzaW9uIGlzIGluIGJyZWFrIG1vZGUgcmlnaHQgbm93LCBmYWxzZSBvdGhlcndpc2VcbiAgICovXG4gIGlzQnJlYWsoKSB7XG4gICAgcmV0dXJuIHRoaXMubW9kZSA9PT0gUE9NT19TRVNTSU9OX01PREVTLkxPTkdfQlJFQUsgfHwgdGhpcy5tb2RlID09PSBQT01PX1NFU1NJT05fTU9ERVMuQlJFQUs7XG4gIH1cblxuICAvKipcbiAgICogVE9ET1xuICAgKi9cbiAgcmVvcmRlclRhc2tzKCkge1xuXG4gIH1cblxuICBnZXRQb21vc0xlZnRJblNlc3Npb24oKSB7XG4gICAgbGV0IGxlZnQgPSAwO1xuICAgIHRoaXMuYWxsVGFza3MuZm9yRWFjaCgodGFzaykgPT4ge1xuICAgICAgbGVmdCArPSBNYXRoLm1heCh0YXNrLnBvbW9zUmVxdWlyZWQgLSB0YXNrLnBvbW9zVXNlZCwgMCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGxlZnQ7XG4gIH1cbiAgcGFyc2VTZXNzaW9uRnJvbU9iaihzZXNzaW9uX29iaikge1xuICAgIHRoaXMuaWQgPSBzZXNzaW9uX29iai5pZDtcbiAgICB0aGlzLm1vZGUgPSBzZXNzaW9uX29iai5tb2RlO1xuICAgIHRoaXMudGltZSA9IHNlc3Npb25fb2JqLnRpbWU7XG4gICAgdGhpcy5wb21vc0VsYXBzZWQgPSBzZXNzaW9uX29iai5wb21vc0VsYXBzZWQ7XG4gICAgdGhpcy5zdGFydERhdGUgPSBuZXcgRGF0ZShzZXNzaW9uX29iai5zdGFydERhdGUpO1xuICAgIHRoaXMuYWxsVGFza3MgPSBzZXNzaW9uX29iai5hbGxUYXNrcy5tYXAoKHRhc2tPYmopID0+IHtcbiAgICAgIGxldCB0ID0gbmV3IFRhc2soKTtcbiAgICAgIHQgPSB0LnBhcnNlVGFza0Zyb21PYmoodGFza09iaik7XG4gICAgICByZXR1cm4gdDtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBzZXJpYWxpemVJbnRvT2JqKCkge1xuICAgIHJldHVybiB7XG4gICAgICBpZDogdGhpcy5pZCwgYWxsVGFza3M6IHRoaXMuYWxsVGFza3MubWFwKCh0YXNrKSA9PiB0YXNrLnNlcmlhbGl6ZUludG9PYmooKSksIG1vZGU6IHRoaXMubW9kZSwgdGltZTogdGhpcy50aW1lLCBwb21vc0VsYXBzZWQ6IHRoaXMucG9tb3NFbGFwc2VkLCBzdGFydERhdGU6IHRoaXMuc3RhcnREYXRlLmdldFRpbWUoKVxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgYSBwb21vIHNlc3Npb24gb2JqZWN0XG4gKiBAcGFyYW0ge251bWJlcn0gaWQgXG4gKiBAcmV0dXJucyB7UG9tb1Nlc3Npb24gfCBudWxsfSB0aGUgc2Vzc2lvbiBmb3IgdGhpcyBpZCBvciBudWxsIGlmIHRoZXJlIGlzIG5vIHNlc3Npb24gYXNzb2NpYXRlZCB3aXRoIHRoaXMgaWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFBvbW9TZXNzaW9uKGlkKSB7XG4gIGNvbnN0IGFsbFNlc3Npb25zID0gZ2V0T2JqZWN0KFBPTU9fU0VTU0lPTl9NQVApO1xuICBsZXQgcCA9IG5ldyBQb21vU2Vzc2lvbigpO1xuICBpZiAoIWFsbFNlc3Npb25zW2lkXSkgcmV0dXJuIG51bGw7XG4gIHJldHVybiBwLnBhcnNlU2Vzc2lvbkZyb21PYmooYWxsU2Vzc2lvbnNbaWRdKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0b3JlUG9tb1Nlc3Npb24oc2Vzc2lvbikge1xuICBjb25zdCBhbGxTZXNzaW9ucyA9IGdldE9iamVjdChQT01PX1NFU1NJT05fTUFQKTtcbiAgYWxsU2Vzc2lvbnNbc2Vzc2lvbi5pZF0gPSBzZXNzaW9uLnNlcmlhbGl6ZUludG9PYmooKTtcbiAgc3RvcmVPYmplY3QoUE9NT19TRVNTSU9OX01BUCwgYWxsU2Vzc2lvbnMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmV3U2Vzc2lvbklEKCkge1xuICBsZXQgcHJldklEID0gcGFyc2VJbnQobG9jYWxTdG9yYWdlLmdldEl0ZW0oUE9NT19TRVNTSU9OX0lEKSk7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFBPTU9fU0VTU0lPTl9JRCwgcHJldklEICsgMSk7XG4gIHJldHVybiBwcmV2SUQ7XG59XG5cbi8qKlxuICogU2V0IHRoZSBjdXJyZW50IHNlc3Npb24ncyBzdGF0dXNcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGF0dXMgLSBjYW4gYmUgXCJjb21wbGV0ZVwiIG9yIFwiaW4tcHJvZ3Jlc3NcIlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0Q3VycmVudFNlc3Npb25TdGF0dXMoc3RhdHVzKSB7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKExBVEVTVF9QT01PX1NFU1NJT05fU1RBVFVTLCBzdGF0dXMpO1xufVxuXG4vKipcbiAqIFdpbGwgcmV0dXJuIHRoZSBzZXNzaW9uIElEIG9mIHRoZSBsYXN0IHNlc3Npb24gaWYgaXQgd2FzIG5vdCBlbmRlZC4gT3RoZXJ3aXNlIGlmIHRoZSBsYXN0IHNlc3Npb24gZG9lcyBub3QgZXhpc3QgXG4gKiBvciB3YXMgZW5kZWQgYWxyZWFkeSwgdGhpcyBmdW5jdGlvbiByZXR1cm5zIG51bGxcbiAqIFxuICogQHJldHVybnMge251bWJlciB8IG51bGx9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRMYXRlc3RTZXNzaW9uSUQoKSB7XG4gIGxldCBzdGF0dXMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShMQVRFU1RfUE9NT19TRVNTSU9OX1NUQVRVUyk7XG4gIGlmIChzdGF0dXMgPT09IFwiY29tcGxldGVcIikge1xuICAgIHJldHVybiBudWxsO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBwYXJzZUludChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShQT01PX1NFU1NJT05fSUQpKSAtIDE7XG4gIH1cbn1cblxuLyoqXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSB0cnVlIGlmIHRoZXJlIGlzIGEgdW5maW5pc2hlZCBzZXNzaW9uIHRoYXQgd2FzIG5vdCBjb21wbGV0ZWQgb3IgcXVpdHRlZC4gZmFsc2Ugb3RoZXJ3aXNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0aGVyZUlzVW5maW5pc2hlZFNlc3Npb24oKSB7XG4gIGxldCBzZXNzaW9uSUQgPSBnZXRMYXRlc3RTZXNzaW9uSUQoKTtcbiAgaWYgKHNlc3Npb25JRCA9PT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICBsZXQgY3VycmVudFBvbW9TZXNzaW9uID0gZ2V0UG9tb1Nlc3Npb24oc2Vzc2lvbklEKTtcbiAgaWYgKGN1cnJlbnRQb21vU2Vzc2lvbiAhPT0gbnVsbCAmJiBjdXJyZW50UG9tb1Nlc3Npb24ubW9kZSAhPT0gUE9NT19TRVNTSU9OX01PREVTLkNPTVBMRVRFICYmIGN1cnJlbnRQb21vU2Vzc2lvbi5tb2RlICE9PSBQT01PX1NFU1NJT05fTU9ERVMuSU5BQ1RJVkUpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb250aW51ZUFjdGl2ZVNlc3Npb24oKSB7XG4gIGlmICh0aGVyZUlzVW5maW5pc2hlZFNlc3Npb24oKSkge1xuICAgIHdpbmRvdy5sb2NhdGlvbiA9IFwiL3RpbWVyLmh0bWw/bG9hZFNhdmVkPXRydWVcIjtcbiAgfVxufSIsImltcG9ydCB7IGdldE9iamVjdCwgc3RvcmVPYmplY3QgfSBmcm9tIFwiLlwiO1xuaW1wb3J0IHsgZ2V0TGF0ZXN0U2Vzc2lvbklELCBnZXRQb21vU2Vzc2lvbiB9IGZyb20gXCIuL3Nlc3Npb25cIjtcblxuZXhwb3J0IGNsYXNzIFRhc2sge1xuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzZXNzaW9uSUQgXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRpdGxlIFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkZXNjcmlwdGlvbiBcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcG9tb3NSZXF1aXJlZCBcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzZXNzaW9uSUQsIHRpdGxlLCBkZXNjcmlwdGlvbiwgcG9tb3NSZXF1aXJlZCkge1xuICAgICAgICB0aGlzLnNlc3Npb25JRCA9IHNlc3Npb25JRDtcbiAgICAgICAgdGhpcy5pZCA9IC0xO1xuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgdGhpcy5wb21vc1JlcXVpcmVkID0gcG9tb3NSZXF1aXJlZDtcbiAgICAgICAgdGhpcy5jb21wbGV0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wb21vc1VzZWQgPSAwO1xuICAgIH1cbiAgICBwYXJzZVRhc2tGcm9tT2JqKHRhc2tfb2JqKSB7XG4gICAgICAgIGxldCB0YXNrID0gbmV3IFRhc2sodGFza19vYmouc2Vzc2lvbklELCB0YXNrX29iai50aXRsZSwgdGFza19vYmouZGVzY3JpcHRpb24sIHRhc2tfb2JqLnBvbW9zUmVxdWlyZWQpO1xuICAgICAgICB0YXNrLmNvbXBsZXRlZCA9IHRhc2tfb2JqLmNvbXBsZXRlZDtcbiAgICAgICAgdGFzay5pZCA9IHRhc2tfb2JqLmlkO1xuICAgICAgICB0YXNrLnBvbW9zVXNlZCA9IHRhc2tfb2JqLnBvbW9zVXNlZDtcbiAgICAgICAgcmV0dXJuIHRhc2s7XG4gICAgfVxuICAgIHNlcmlhbGl6ZUludG9PYmooKSB7XG4gICAgICAgIHJldHVybiB7IHRpdGxlOiB0aGlzLnRpdGxlLCBkZXNjcmlwdGlvbjogdGhpcy5kZXNjcmlwdGlvbiwgcG9tb3NSZXF1aXJlZDogdGhpcy5wb21vc1JlcXVpcmVkLCBjb21wbGV0ZWQ6IHRoaXMuY29tcGxldGVkLCBwb21vc1VzZWQ6IHRoaXMucG9tb3NVc2VkLCBpZDogdGhpcy5pZCwgc2Vzc2lvbklEOiB0aGlzLnNlc3Npb25JRCB9O1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IFBPTU9fVEFTS19NQVAgPSBcInBvbW9fdGFza19tYXBcIjtcbmV4cG9ydCBjb25zdCBQT01PX1RBU0tfSU5ERVggPSBcInBvbW9fdGFza19pbmRleFwiO1xuXG4vKipcbiAqIFdpbGwgc3RvcmUgYSBuZXcgb3IgdXBkYXRlZCB0YXNrIGludG8gbG9jYWwgc3RvcmFnZVxuICogXG4gKiBIYXMgYSBzaWRlIGVmZmVjdCBvZiBhZGRpbmcgdGhlIGlkIG9mIHRoZSBuZXcgdGFzayBpZiBpdCB3YXNudCBzdG9yZWQgaW4gc3RvcmFnZSBiZWZvcmVcbiAqIFxuICogQHBhcmFtIHtUYXNrfSB0YXNrXG4gKiBAcmV0dXJucyB7bnVtYmVyfSAtIHRoZSBpZCBvZiB0aGUgdGFza1xuICovXG5leHBvcnQgZnVuY3Rpb24gc3RvcmVUYXNrKHRhc2spIHtcbiAgICBsZXQgdGFza19tYXAgPSBnZXRPYmplY3QoUE9NT19UQVNLX01BUCk7XG4gICAgaWYgKCF0YXNrX21hcFt0YXNrLmlkXSkge1xuICAgICAgICAvLyBpZiB0YXNrIG1hcCBkb2VzIG5vdCBoYXZlIHRoaXMgdGFzaywgY3JlYXRlIGEgbmV3IGluZGV4XG4gICAgICAgIGxldCBpZCA9IHBhcnNlSW50KGdldE9iamVjdChQT01PX1RBU0tfSU5ERVgpKTtcbiAgICAgICAgdGFzay5pZCA9IGlkO1xuICAgICAgICAvLyBpbmNyZW1lbnQgZ2xvYmFsIGlkXG4gICAgICAgIHN0b3JlT2JqZWN0KFBPTU9fVEFTS19JTkRFWCwgaWQgKyAxKTtcbiAgICB9XG4gICAgbGV0IG9iaiA9IHRhc2suc2VyaWFsaXplSW50b09iaigpO1xuICAgIHRhc2tfbWFwW3Rhc2suaWRdID0gb2JqO1xuICAgIHN0b3JlT2JqZWN0KFBPTU9fVEFTS19NQVAsIHRhc2tfbWFwKTtcbiAgICByZXR1cm4gdGFzay5pZDtcbn1cblxuLyoqXG4gKiBHZXQgdGhlIHRhc2sgYXNzb2NpYXRlZCB3aXRoIHRoaXMgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBpZCBcbiAqIEByZXR1cm5zIHtUYXNrfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGFzayhpZCkge1xuICAgIGxldCB0YXNrX21hcCA9IGdldE9iamVjdChQT01PX1RBU0tfTUFQKTtcbiAgICBsZXQgdGFza19vYmogPSB0YXNrX21hcFtpZF07XG4gICAgbGV0IHQgPSBuZXcgVGFzaygpO1xuICAgIHQgPSB0LnBhcnNlVGFza0Zyb21PYmoodGFza19vYmopO1xuICAgIHJldHVybiB0O1xuXG59XG4vKipcbiAqIEdldCBhbGwgdGFza3NcbiAqIFxuICogQHJldHVybnMge01hcDxudW1iZXIsIFRhc2s+fSAtIGEgbWFwIGZyb20gdGFzayBpZCB0byB0YXNrXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBbGxUYXNrcygpIHtcbiAgICBsZXQgdGFza19tYXAgPSBnZXRPYmplY3QoUE9NT19UQVNLX01BUCk7XG4gICAgbGV0IHBhcnNlZF90YXNrX21hcCA9IHt9O1xuICAgIGZvciAobGV0IGlkIGluIHRhc2tfbWFwKSB7XG4gICAgICAgIGxldCB0YXNrX29iaiA9IHRhc2tfbWFwW2lkXTtcbiAgICAgICAgbGV0IHQgPSBuZXcgVGFzaygpO1xuICAgICAgICB0ID0gdC5wYXJzZVRhc2tGcm9tT2JqKHRhc2tfb2JqKTtcbiAgICAgICAgcGFyc2VkX3Rhc2tfbWFwW2lkXSA9IHQ7XG4gICAgfVxuICAgIHJldHVybiBwYXJzZWRfdGFza19tYXA7XG59XG5cbi8qKlxuICogRGVsZXRlIGEgc3BlY2lmaWMgdGFzayBmcm9tIGRhdGFiYXNlIGJ5IHRoZSB1bmlxdWUgdGFzayBJRFxuICogXG4gKiBAcGFyYW0ge251bWJlcn0gaWQgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWxldGVUYXNrQnlUYXNrSUQoaWQpIHtcbiAgICBsZXQgdGFza19tYXAgPSBnZXRPYmplY3QoUE9NT19UQVNLX01BUCk7XG4gICAgZGVsZXRlIHRhc2tfbWFwW2lkXTtcbiAgICBzdG9yZU9iamVjdChQT01PX1RBU0tfTUFQLCB0YXNrX21hcCk7XG59XG5cblxuLyoqXG4gKiBDaGVja3MgaWYgdGhlcmUgYXJlIGFueSB1bmZpbmlzaGVkIHRhc2tzIGZyb20gdGhlIHByZXZpb3VzIHNlc3Npb25cbiAqIEByZXR1cm5zIHtib29sZWFufSAtIHRydWUgaWYgdW5pZmluaXNoZWQgdGFza3MgZXhpc3QsIGZhbHNlIG90aGVyd2lzZVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXJlVGhlcmVVbmZpbmlzaGVkVGFza3NGcm9tTGFzdFNlc3Npb24oKSB7XG4gICAgbGV0IG9sZFNlc3Npb25JRCA9IGdldExhdGVzdFNlc3Npb25JRCgpO1xuICAgIGlmIChvbGRTZXNzaW9uSUQgPT09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgICBsZXQgc2Vzc2lvbiA9IGdldFBvbW9TZXNzaW9uKG9sZFNlc3Npb25JRCk7XG4gICAgaWYgKHNlc3Npb24gPT09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgICBpZiAoc2Vzc2lvbi5jdXJyZW50VGFzaygpID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHRpZihfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdKSB7XG5cdFx0cmV0dXJuIF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0uZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCJpbXBvcnQgeyBnZXRPYmplY3QgfSBmcm9tIFwiLlwiO1xuaW1wb3J0IHsgZ2V0TGF0ZXN0U2Vzc2lvbklELCBnZXROZXdTZXNzaW9uSUQsIGdldFBvbW9TZXNzaW9uLCBQb21vU2Vzc2lvbiwgc2V0Q3VycmVudFNlc3Npb25TdGF0dXMsIHN0b3JlUG9tb1Nlc3Npb24sIFBPTU9fU0VTU0lPTl9NQVAgfSBmcm9tIFwiLi4vZGF0YWJhc2Uvc2Vzc2lvblwiO1xuXG5leHBvcnQgY2xhc3MgUG9tb1N0YXRzIHtcbiAgICBjb25zdHJ1Y3RvcihkYXRlKSB7XG4gICAgICAgIHRoaXMuZGF0ZSA9IGRhdGU7XG4gICAgICAgIHRoaXMudGFza3MgPSB7fTtcblxuICAgICAgICB0aGlzLmdyZWVuVGFza3MgPSAwO1xuICAgICAgICB0aGlzLnllbGxvd1Rhc2tzID0gMDtcbiAgICAgICAgdGhpcy5yZWRUYXNrcyA9IDA7XG5cbiAgICAgICAgbGV0IGlkID0gZ2V0TGF0ZXN0U2Vzc2lvbklEKCk7XG4gICAgICAgIGxldCBjb3VudGVyID0gMDtcbiAgICAgICAgd2hpbGUoaWQgIT0gLTEpIHtcbiAgICAgICAgICAgIGxldCBzZXNzaW9uX29iamVjdF9kYXRlID0gbmV3IERhdGUoZ2V0T2JqZWN0KFBPTU9fU0VTU0lPTl9NQVApW2lkXVtcInN0YXJ0RGF0ZVwiXSk7XG4gICAgICAgICAgICBpZih0aGlzLmRhdGUuZ2V0TW9udGgoKSA9PT0gc2Vzc2lvbl9vYmplY3RfZGF0ZS5nZXRNb250aCgpICYmIHRoaXMuZGF0ZS5nZXREYXRlKCkgPT09IHNlc3Npb25fb2JqZWN0X2RhdGUuZ2V0RGF0ZSgpICYmIHRoaXMuZGF0ZS5nZXRZZWFyKCkgPT09IHNlc3Npb25fb2JqZWN0X2RhdGUuZ2V0WWVhcigpKXtcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhnZXRPYmplY3QoUE9NT19TRVNTSU9OX01BUClbaWRdW1wiYWxsVGFza3NcIl0pXG4gICAgICAgICAgICAgICAgICAgIC5mb3JFYWNoKGtleSA9PiB0aGlzLnRhc2tzW2NvdW50ZXIrK10gPSBnZXRPYmplY3QoUE9NT19TRVNTSU9OX01BUClbaWRdW1wiYWxsVGFza3NcIl1ba2V5XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKHRoaXMuZGF0ZS5nZXRNb250aCgpID4gc2Vzc2lvbl9vYmplY3RfZGF0ZS5nZXRNb250aCgpIHx8IHRoaXMuZGF0ZS5nZXREYXRlKCkgPiBzZXNzaW9uX29iamVjdF9kYXRlLmdldERhdGUoKSB8fCB0aGlzLmRhdGUuZ2V0WWVhcigpID4gc2Vzc2lvbl9vYmplY3RfZGF0ZS5nZXRZZWFyKCkpe1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIGlkIC09IDE7XG4gICAgICAgIH1cbiAgICAgICAgZm9yKGxldCB0YXNrSUQgaW4gdGhpcy50YXNrcykge1xuICAgICAgICAgICAgaWYodGhpcy50YXNrc1t0YXNrSURdLmNvbXBsZXRlZCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRhc2tzW3Rhc2tJRF0ucG9tb3NVc2VkIDw9IHRoaXMudGFza3NbdGFza0lEXS5wb21vc1JlcXVpcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ3JlZW5UYXNrcys9MTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB0aGlzLnllbGxvd1Rhc2tzKz0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB0aGlzLnJlZFRhc2tzKz0xO1xuICAgICAgICB9XG4gICAgfVxufSIsIi8qKlxuICogV2lsbCByYW5kb21seSBwaWNrIGEgdGhlbWUgYW5kIHVuaXF1ZSBiYWNrZ3JvdW5kIGRlcGVuZGluZyBvbiB3aGF0IGRheSBpdCBpcyBhbmQgd2hhdCB0aW1lIGl0IGlzIGFuZCBzZXQgaXQgb24gdGhlIHBhZ2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNlbGVjdEFuZFNldFRoZW1lKHRvZGF5ID0gbmV3IERhdGUoKSkge1xuICBsZXQgaWQgPSAwO1xuICBsZXQgbnVtQkdzID0gNjtcblxuICBsZXQgZCA9IHRvZGF5LmdldERheSgpO1xuXG4gIGxldCBzZWVkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJiZy1zZWVkXCIpO1xuXG4gIGlmIChzZWVkID09PSBudWxsIHx8IHNlZWRbMF0gIT0gZCkge1xuICAgIHNlZWQgPSBkICsgXCItXCIgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBudW1CR3MpO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYmctc2VlZFwiLCBzZWVkKTtcbiAgfVxuICBsZXQgdGltZVBlcmlvZCA9IGdldFRoZW1lTW9kZSh0b2RheSk7XG4gIGlkID0gcGFyc2VJbnQoc2VlZFsyXSk7XG5cbiAgbGV0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJhY2tkcm9wXCIpO1xuICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoXCIuLi9hc3NldHMvaW1hZ2VzL2JhY2tncm91bmRzLyR7dGltZVBlcmlvZH0vYmcke2lkfS5qcGdcIilgO1xufTtcblxuZXhwb3J0IGNvbnN0IFRIRU1FX01PREVTID0ge1xuICBEQVk6IFwiZGF5XCIsXG4gIE5JR0hUOiBcIm5pZ2h0XCIsXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGhlbWVNb2RlKHRvZGF5ID0gbmV3IERhdGUoKSkge1xuICBsZXQgdGltZVBlcmlvZCA9IFRIRU1FX01PREVTLkRBWTtcbiAgaWYgKHRvZGF5LmdldEhvdXJzKCkgPCA0KSB7XG4gICAgdGltZVBlcmlvZCA9IFRIRU1FX01PREVTLk5JR0hUO1xuICB9XG4gIGVsc2UgaWYgKHRvZGF5LmdldEhvdXJzKCkgPCAxOCkge1xuICAgIHRpbWVQZXJpb2QgPSBUSEVNRV9NT0RFUy5EQVk7XG4gIH0gZWxzZSBpZiAodG9kYXkuZ2V0SG91cnMoKSA8IDI0KSB7XG4gICAgdGltZVBlcmlvZCA9IFRIRU1FX01PREVTLk5JR0hUO1xuICB9XG4gIHJldHVybiB0aW1lUGVyaW9kO1xufSIsImltcG9ydCB7IGluaXRpYWxpemVEYXRhYmFzZSB9IGZyb20gXCIuL2RhdGFiYXNlXCI7XG5pbXBvcnQgeyBnZXRMYXRlc3RTZXNzaW9uSUQgfSBmcm9tIFwiLi9kYXRhYmFzZS9zZXNzaW9uXCI7XG5pbXBvcnQgeyBQb21vU3RhdHMgfSBmcm9tIFwiLi9kYXRhYmFzZS9zdGF0c1wiO1xuaW1wb3J0IHsgcmVuZGVyRWZmaWNpZW5jeVdlZWtseURhdGEsIHJlbmRlckVmZmljaWVuY3lEYXRhIH0gZnJvbSBcIi4vaGlzdG9yeS1ncmFwaFwiO1xuaW1wb3J0IHsgc2VsZWN0QW5kU2V0VGhlbWUgfSBmcm9tIFwiLi91dGlscy90aGVtZVwiO1xud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcbiAgICBzZWxlY3RBbmRTZXRUaGVtZSgpO1xuICAgIC8vIFRPRE86IGxvYWQgZGF0YSBmcm9tIGxvY2FsIHN0b3JhZ2VcbiAgICBpbml0aWFsaXplRGF0YWJhc2UoKTtcbiAgICBsZXQgc3RhdHMgPSBuZXcgUG9tb1N0YXRzKG5ldyBEYXRlKCkpO1xuICAgIGxldCB0YXNrTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGFza0xpc3RcIik7XG4gICAgZm9yKGxldCB0YXNrSUQgaW4gc3RhdHMudGFza3MpIHtcbiAgICAgICAgbGV0IHRhc2sgPSBzdGF0cy50YXNrc1t0YXNrSURdO1xuICAgICAgICBjb25zdCBjdXJyZW50VGFza0VsZW1lbnQgPSBgPHBvbW8tdGFzayBkZXNjcmlwdGlvbiA9XCIke3Rhc2suZGVzY3JpcHRpb259XCIgcG9tb3NVc2VkPVwiJHt0YXNrLnBvbW9zVXNlZH1cIiwgcG9tb3NSZXF1aXJlZCA9XCIke3Rhc2sucG9tb3NSZXF1aXJlZH1cIj4ke3Rhc2sudGl0bGV9PC9wb21vLXRhc2s+YDtcbiAgICAgICAgdGFza0xpc3QuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIGN1cnJlbnRUYXNrRWxlbWVudCk7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0YXNrTGlzdC5jaGlsZE5vZGVzW3Rhc2tMaXN0LmNoaWxkTm9kZXMubGVuZ3RoIC0gMV07XG4gICAgICAgIGVsZW1lbnQudGFzayA9IHRhc2s7XG4gICAgICAgIGVsZW1lbnQuc2hhZG93Um9vdC5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMF0uY2hpbGROb2Rlc1szXS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIGVsZW1lbnQuc2hhZG93Um9vdC5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMF0uY2hpbGROb2Rlc1syXS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIGlmKHRhc2suY29tcGxldGVkKSB7XG4gICAgICAgICAgICBpZih0YXNrLnBvbW9zVXNlZCA8PSB0YXNrLnBvbW9zUmVxdWlyZWQpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnNoYWRvd1Jvb3QuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMV0uY2hpbGROb2Rlc1swXS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImdvb2RUaW1pbmdUYXNrXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBlbGVtZW50LnNoYWRvd1Jvb3QuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMV0uY2hpbGROb2Rlc1swXS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImJhZFRpbWluZ1Rhc2tcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBlbGVtZW50LnNoYWRvd1Jvb3QuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMV0uY2hpbGROb2Rlc1swXS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImluY29tcGxldGVUYXNrXCIpO1xuICAgIH1cbiAgICBsZXQgZGF0YSA9IHtcbiAgICAgICAgY29tcGxldGU6IHN0YXRzLmdyZWVuVGFza3MsXG4gICAgICAgIG92ZXJ0aW1lOiBzdGF0cy55ZWxsb3dUYXNrcyxcbiAgICAgICAgaW5jb21wbGV0ZTogc3RhdHMucmVkVGFza3MsXG4gICAgfTtcbiAgICBsZXQgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZmZpY2llbmN5LWNoYXJ0XCIpO1xuICAgIHJlbmRlckVmZmljaWVuY3lEYXRhKGNhbnZhcywgZGF0YSk7XG4gICAgbGV0IGNhbnZhczIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVmZmljaWVuY3ktd2Vla2x5LWNoYXJ0XCIpO1xuXG4gICAgbGV0IHNldmVuRGF0ZXMgPSBkYXRlc0ZvclNldmVuRGF5cygpO1xuICAgIHNldmVuRGF0ZXMucmV2ZXJzZSgpO1xuICAgIGxldCBkYXRlc0ZvckdyYXBoID0gW107XG4gICAgbGV0IHdlZWtTdGF0cyA9IFtdO1xuICAgIGZvcihsZXQgZGF0ZUlEIGluIHNldmVuRGF0ZXMpIHtcbiAgICAgICAgZGF0ZXNGb3JHcmFwaC5wdXNoKG5ldyBEYXRlKHNldmVuRGF0ZXNbZGF0ZUlEXSkuZ2V0TW9udGgoKSArIFwiL1wiICsgbmV3IERhdGUoc2V2ZW5EYXRlc1tkYXRlSURdKS5nZXREYXRlKCkpO1xuICAgICAgICB3ZWVrU3RhdHMucHVzaChuZXcgUG9tb1N0YXRzKG5ldyBEYXRlKHNldmVuRGF0ZXNbZGF0ZUlEXSkpKTtcbiAgICB9XG4gICAgbGV0IGNvbXBsZXRlV2VlayA9IFtdO1xuICAgIGxldCBvdmVyVGltZVdlZWsgPSBbXTtcbiAgICBsZXQgaW5jb21wbGV0ZVdlZWsgPSBbXTtcbiAgICBmb3IobGV0IHN0YXRJRCBpbiB3ZWVrU3RhdHMpIHtcbiAgICAgICAgY29tcGxldGVXZWVrLnB1c2god2Vla1N0YXRzW3N0YXRJRF0uZ3JlZW5UYXNrcyk7XG4gICAgICAgIG92ZXJUaW1lV2Vlay5wdXNoKHdlZWtTdGF0c1tzdGF0SURdLnllbGxvd1Rhc2tzKTtcbiAgICAgICAgaW5jb21wbGV0ZVdlZWsucHVzaCh3ZWVrU3RhdHNbc3RhdElEXS5yZWRUYXNrcyk7XG4gICAgfVxuICAgIGxldCB3ZWVrbHlEYXRhID0ge1xuICAgICAgICBjb21wbGV0ZTogY29tcGxldGVXZWVrLFxuICAgICAgICBvdmVydGltZTogb3ZlclRpbWVXZWVrLFxuICAgICAgICBpbmNvbXBsZXRlOiBpbmNvbXBsZXRlV2VlayxcbiAgICB9O1xuICAgIHJlbmRlckVmZmljaWVuY3lXZWVrbHlEYXRhKGNhbnZhczIsIHdlZWtseURhdGEsIGRhdGVzRm9yR3JhcGgpO1xufSk7XG5cbmZ1bmN0aW9uIGRhdGVzRm9yU2V2ZW5EYXlzKCkge1xuICAgIGxldCBkYXRlcyA9IFtdO1xuICAgIGZvciAobGV0IGk9MDsgaTw3OyBpKyspIHtcbiAgICAgICAgbGV0IGQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBkLnNldERhdGUoZC5nZXREYXRlKCkgLSBpKTtcbiAgICAgICAgZGF0ZXMucHVzaChkKTtcbiAgICB9XG4gICAgcmV0dXJuIGRhdGVzO1xufSIsIi8qKlxuICogUmVuZGVycyBhIGJhciBjaGFydCBvbnRvIHRoZSBnaXZlbiBjaGFydCBlbGVtZW50IHNob3dpbmcgdGhlIGRhaWx5IGRhdGFcbiAqIFxuICogQHBhcmFtIHtIVE1MQ2FudmFzRWxlbWVudH0gY2hhcnRlbGVtZW50IC0gdGhlIGVsZW1lbnQgdG8gcmVuZGVyIGNoYXJ0IGRhdGEgb25cbiAqIEBwYXJhbSB7e2NvbXBsZXRlOiBudW1iZXIsIG92ZXJ0aW1lOiBudW1iZXIsIGluY29tcGxldGU6IG51bWJlcn19IGRhdGFcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlckVmZmljaWVuY3lEYXRhKGNoYXJ0ZWxlbWVudCwgZGF0YSkge1xuICAgIGxldCBjdHggPSBjaGFydGVsZW1lbnQuZ2V0Q29udGV4dChcIjJkXCIpO1xuICAgIGxldCBsYWJlbHMgPSBbXCJUYXNrcyBDb21wbGV0ZWQgb24gVGltZVwiLCBcIlRhc2tzIENvbXBsZXRlZCBvdmVyIFRpbWVcIiwgXCJUYXNrcyBJbmNvbXBsZXRlXCJdO1xuICAgIGxldCBjb2xvcnMgPSBbXCIjMjJERDlBXCIsIFwiI0Y5QzY0NFwiLCBcIiNGQTdGN0ZcIl07XG4gICAgbGV0IG15Q2hhcnQgPSBuZXcgQ2hhcnQoY3R4LCB7XG4gICAgICAgIHR5cGU6IFwiYmFyXCIsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGxhYmVsczogbGFiZWxzLFxuICAgICAgICAgICAgZGF0YXNldHM6IFt7XG4gICAgICAgICAgICAgICAgbGFiZWw6IFwiIyBvZiBUYXNrc1wiLFxuICAgICAgICAgICAgICAgIGRhdGE6IFtkYXRhLmNvbXBsZXRlLCBkYXRhLm92ZXJ0aW1lLCBkYXRhLmluY29tcGxldGVdLFxuICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogY29sb3JzLFxuICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yOiBjb2xvcnMsXG4gICAgICAgICAgICAgICAgYm9yZGVyV2lkdGg6IDFcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH0sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgIGxlZ2VuZDogZmFsc2UsXG4gICAgICAgICAgICBzY2FsZXM6IHtcbiAgICAgICAgICAgICAgICB5QXhlczogW3tcbiAgICAgICAgICAgICAgICAgICAgdGlja3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJlZ2luQXRaZXJvOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG5cbi8qKlxuICogUmVuZGVycyBhIGxpbmUgY2hhcnQgb250byB0aGUgY2hhcnQgZWxlbWVudCBvZiB3ZWVrbHkgZGF0YVxuICogXG4gKiBAcGFyYW0ge0hUTUxDYW52YXNFbGVtZW50fSBjaGFydGVsZW1lbnQgLSB0aGUgZWxlbWVudCB0byByZW5kZXIgY2hhcnQgZGF0YSBvblxuICogQHBhcmFtIHt7Y29tcGxldGU6IG51bWJlcltdLCBvdmVydGltZTogbnVtYmVyW10sIGluY29tcGxldGU6IG51bWJlcltdfX0gd2Vla2x5RGF0YVxuICogQHBhcmFtIHtzdHJpbmdbXX0gZGF0ZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlckVmZmljaWVuY3lXZWVrbHlEYXRhKGNoYXJ0ZWxlbWVudCwgd2Vla2x5RGF0YSwgZGF0ZXMpIHtcbiAgICBsZXQgY3R4ID0gY2hhcnRlbGVtZW50LmdldENvbnRleHQoXCIyZFwiKTtcbiAgICBsZXQgbGFiZWxzID0gW1wiVGFza3MgQ29tcGxldGVkIG9uIFRpbWVcIiwgXCJUYXNrcyBDb21wbGV0ZWQgb3ZlciBUaW1lXCIsIFwiVGFza3MgSW5jb21wbGV0ZVwiXTtcbiAgICBsZXQgY29sb3JzID0gW1wiIzIyREQ5QVwiLCBcIiNGOUM2NDRcIiwgXCIjRkE3RjdGXCJdO1xuICAgIGxldCBteUNoYXJ0ID0gbmV3IENoYXJ0KGN0eCwge1xuICAgICAgICB0eXBlOiBcImxpbmVcIixcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgbGFiZWxzOiBkYXRlcyxcbiAgICAgICAgICAgIGRhdGFzZXRzOiBbe1xuICAgICAgICAgICAgICAgIGxhYmVsOiBsYWJlbHNbMF0sXG4gICAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6IFwiIzIyREQ5QVwiLFxuICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogXCJ0cmFuc3BhcmVudFwiLFxuICAgICAgICAgICAgICAgIGRhdGE6IHdlZWtseURhdGEuY29tcGxldGVcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogbGFiZWxzWzFdLFxuICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yOiBcIiNGOUM2NDRcIixcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwidHJhbnNwYXJlbnRcIixcbiAgICAgICAgICAgICAgICBkYXRhOiB3ZWVrbHlEYXRhLm92ZXJ0aW1lLFxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGxhYmVsOiBsYWJlbHNbMl0sXG4gICAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6IFwiI0ZBN0Y3RlwiLFxuICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogXCJ0cmFuc3BhcmVudFwiLFxuICAgICAgICAgICAgICAgIGRhdGE6IHdlZWtseURhdGEuaW5jb21wbGV0ZVxuICAgICAgICAgICAgfV1cbiAgICAgICAgfSxcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgc2NhbGVzOiB7XG4gICAgICAgICAgICAgICAgeUF4ZXM6IFt7XG4gICAgICAgICAgICAgICAgICAgIHRpY2tzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBiZWdpbkF0WmVybzogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufSJdLCJzb3VyY2VSb290IjoiIn0=